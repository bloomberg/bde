

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>bsl::chrono Integration with bsl and bdl &mdash; BDE Documentation  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/bde.css" type="text/css" />

  
  

  
  

  
    <link rel="canonical" href="https://bloomberg.github.io/articles/bde_4.0_chrono.html" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Concurrent Queue Evaluation" href="concurrent_queue_evaluation/paper.html" />
    <link rel="prev" title="Selecting wyhash as the Default Hash Algorithm" href="wyhash.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> BDE Documentation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Library Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../library_information/documentation.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../library_information/build.html">Build Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../library_information/source_code.html">Source Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../library_information/supported_platforms.html">Supported Platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes/release_notes.html">Release Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Knowledge Base</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../knowledge_base/coding_standards.html">BDE C++ Coding Standards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../knowledge_base/resources_by_topic.html">Resources By Topic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../white_papers/index.html">White Papers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Articles</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting_started_with_aa.html">Getting Started Writing Allocator Aware Software (May 30, 2024)</a></li>
<li class="toctree-l2"><a class="reference internal" href="bsl_variant.html">bsl::variant: An Allocator-Aware Sum Type (December 25, 2023)</a></li>
<li class="toctree-l2"><a class="reference internal" href="cpp20_project.html">BSL Support for C++20 (August 28, 2023)</a></li>
<li class="toctree-l2"><a class="reference internal" href="fuzz_testing.html">Fuzz Testing (Feb 21, 2023)</a></li>
<li class="toctree-l2"><a class="reference internal" href="bdljsn.html">Introducing bdljsn::Json (January 18, 2023)</a></li>
<li class="toctree-l2"><a class="reference internal" href="wyhash.html">Selecting wyhash as the Default Hash Algorithm (June 30, 2022)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">bsl::chrono Integration with bsl and bdl (November 30, 2021)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bsl-chrono-duration-and-bsls-timeinterval">bsl::chrono::duration and bsls::TimeInterval</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#potentially-lossy-conversions">Potentially Lossy Conversions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#using-bsls-timeinterval-with-literals">Using bsls::TimeInterval with Literals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-bsls-timeinterval-with-helper-types">Using bsls::TimeInterval with Helper Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bsls-systemclocktype-versus-bsl-chrono-clocks">bsls::SystemClockType versus bsl::chrono Clocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bslmt-chronoutil">bslmt::ChronoUtil</a></li>
<li class="toctree-l3"><a class="reference internal" href="#converting-a-floating-point-bsl-chrono-duration">Converting a Floating Point bsl::chrono::duration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enhancements-to-bslmt-components-to-support-bsl-chrono">Enhancements to bslmt Components to Support bsl::chrono</a></li>
<li class="toctree-l3"><a class="reference internal" href="#miscelaneous-interface-enhancements">Miscelaneous Interface Enhancements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bdlmt-eventscheduler">bdlmt::EventScheduler</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bslmt-threadutil">bslmt::ThreadUtil</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bdlmt-throttle">bdlmt::Throttle</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="concurrent_queue_evaluation/paper.html">Concurrent Queue Evaluation (March 31, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="binary_decimal_conversion.html">Binary to Decimal and Back Again. (March 30, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="bsl_optional.html">bsl::optional: An Allocator-Aware Optional Type. (February 1, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ball_scoped_attributes.html">Adding Context to your Application Log. (January 6, 2021)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ber_format.html">BER Date and Time Format Specification. (January 9, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpcheck.html">Avoiding Common Problems with Smart Pointers. (December 17, 2019)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://bloomberg.github.io/bde-resources/pdfs/BDETypeTaxonomy.pdf">Taxonomy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../knowledge_base/faq.html">BDE FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="fuzz_testing.html">Fuzz Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../knowledge_base/contributing.html">Contributing to BDE</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://bloomberg.github.io/bde-tools">BBS Build System</a></li>
<li class="toctree-l1"><a class="reference external" href="https://bloomberg.github.io/bde-tools/misc/sim_cpp11_features.html">Simulating Variadic Templates</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BDE Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Articles</a> &raquo;</li>
        
      <li>bsl::chrono Integration with bsl and bdl</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="concurrent_queue_evaluation/paper.html" class="btn btn-neutral float-right" title="Concurrent Queue Evaluation" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="wyhash.html" class="btn btn-neutral float-left" title="Selecting wyhash as the Default Hash Algorithm" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p><em>Nov 30, 2021</em></p>
<div class="section" id="bsl-chrono-integration-with-bsl-and-bdl">
<h1><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono</a> Integration with <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsl.html">bsl</a> and <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bdl.html">bdl</a><a class="headerlink" href="#bsl-chrono-integration-with-bsl-and-bdl" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>In BDE 3.86 support for <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::duration</a> and <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::time_point</a>
was added to <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslmt.html">bslmt</a> and <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bdlmt.html">bdlmt</a>.   This enables users who prefer using
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::duration</a> and <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::time_point</a> to better integrate
with the BDE libraries.  Specifically, conversions between
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::duration</a> and <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a> were added, and support for
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::time_point</a> was added to the synchronization primitives in
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslmt.html">bslmt</a>, as well as the classes <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslmt__threadutil.html">bslmt::ThreadUtil</a>, <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bdlmt__eventscheduler.html">bdlmt::EventScheduler</a>,
and <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bdlmt__throttle.html">bdlmt::Throttle</a>.</p>
</div>
<div class="section" id="bsl-chrono-duration-and-bsls-timeinterval">
<h2><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::duration</a> and <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a><a class="headerlink" href="#bsl-chrono-duration-and-bsls-timeinterval" title="Permalink to this headline">¶</a></h2>
<p>The BDE types <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a> and <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::duration</a> are both
representations of a time interval, but <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a> is a concrete
type (representing an interval in seconds and nanoseconds), while
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::duration</a> is a template whose representation, precision, and
range are determined by its template parameters.  BDE now provides a set of
operations to convert between <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a> and
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::duration</a>.  These include:</p>
<ul class="simple">
<li><p>conversion from <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::duration</a> to <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a>,</p></li>
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/classbsls_1_1TimeInterval.html#a6511c406a95f0e76e16dcf5490a13d15">bsls::TimeInterval::addDuration</a> - adds a <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::duration</a> to this interval, and</p></li>
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/classbsls_1_1TimeInterval.html#ac195951a65f01df1fc172aab51c6ff19">bsls::TimeInterval::asDuration</a> - returns this interval as a <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::duration</a>.</p></li>
</ul>
<p>Restrictions:</p>
<ul class="simple">
<li><p>the behavior is undefined if the value being converted is outside of the representatable range of the result type, and</p></li>
<li><p>no conversions where the storage type is a floating point value are provided (use a <code class="docutils literal notranslate"><span class="pre">duration_cast</span></code> to cast to an integral representation, or <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/structbslmt_1_1ChronoUtil.html#a80ce3b5be4f61262ae8c1d0b40d57632">bslmt::ChronoUtil::durationToTimeInterval</a>),</p></li>
<li><p>the conversion from <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::duration</a> to <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a> is explicit when the conversion is <a class="reference internal" href="#lossy"><span class="std std-ref">potentially lossy</span></a>.</p></li>
</ul>
<p>For example, to create a <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a> interval, add a second, and then
convert the <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a> interval to a duration holding an integer
of seconds:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">bsls</span><span class="o">::</span><span class="n">TimeInterval</span><span class="w"> </span><span class="n">interval</span><span class="p">;</span><span class="w"></span>
<span class="n">interval</span><span class="p">.</span><span class="n">addDuration</span><span class="p">(</span><span class="n">bsl</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">seconds</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
<span class="n">bsl</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">seconds</span><span class="w"> </span><span class="n">duration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">interval</span><span class="p">.</span><span class="n">asDuration</span><span class="o">&lt;</span><span class="n">bsl</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">seconds</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
<div class="section" id="potentially-lossy-conversions">
<span id="lossy"></span><h3>Potentially Lossy Conversions<a class="headerlink" href="#potentially-lossy-conversions" title="Permalink to this headline">¶</a></h3>
<p>The conversion from <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::duration</a> to <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a> is
implicit if the conversion can be done without loss of precision, whereas it
must be explicit if the conversion is potentially lossy.    For example, if we
define a duration in picoseconds, this requires a potentially lossy conversion
when converted to a <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a> (defined in terms of nanoseconds).
Hence, the following code does not compile (the attempted conversion would
require use of the implicit <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a> user-defined conversion):</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="n">bsl</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">duration</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">,</span><span class="w"> </span><span class="n">bsl</span><span class="o">::</span><span class="n">ratio</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1000000000000</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">Picoseconds</span><span class="p">;</span><span class="w"></span>
<span class="n">Picoseconds</span><span class="w"> </span><span class="nf">d</span><span class="p">(</span><span class="mi">5001</span><span class="p">);</span><span class="w"></span>
<span class="n">bsls</span><span class="o">::</span><span class="n">TimeInterval</span><span class="w"> </span><span class="n">ti</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">;</span><span class="w">  </span><span class="c1">// does not compile: implicit conversion unavailable</span>
</pre></div>
</div>
<p>The following example will compile because the conversion to
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a> is explicit:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Picoseconds</span><span class="w"> </span><span class="nf">d</span><span class="p">(</span><span class="mi">5001</span><span class="p">);</span><span class="w"></span>
<span class="n">bsls</span><span class="o">::</span><span class="n">TimeInterval</span><span class="w"> </span><span class="n">ti</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bsls</span><span class="o">::</span><span class="n">TimeInterval</span><span class="p">(</span><span class="n">d</span><span class="p">);</span><span class="w">  </span><span class="c1">// does compile: initial explicit conversion</span>
</pre></div>
</div>
<p>In contrast, a duration defined in milliseconds can be converted to a
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a> without a loss of precision,  so the following
example will compile:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">bsl</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">milliseconds</span><span class="w"> </span><span class="nf">d</span><span class="p">(</span><span class="mi">5001</span><span class="p">);</span><span class="w">  </span><span class="c1">// does compile (non-lossy conversion)</span>
<span class="n">bsls</span><span class="o">::</span><span class="n">TimeInterval</span><span class="w"> </span><span class="n">ti</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>Note that just because a <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::duration</a> type can be converted to
a <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a> without loss of precision (meaning an implicit
conversion is available) does not guarantee that the value for that
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::duration</a> is in the range that can be represented by
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Converting a <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::duration</a> value that is outside of the
representable range of <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a> results in undefined behavior
(see <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/classbsls_1_1TimeInterval.html#afa0339f80ac5f9daae1aeef1aa4f37bb">bsls::TimeInterval::isValid</a>).</p>
</div>
</div>
</div>
<div class="section" id="using-bsls-timeinterval-with-literals">
<h2>Using <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a> with Literals<a class="headerlink" href="#using-bsls-timeinterval-with-literals" title="Permalink to this headline">¶</a></h2>
<p>A set of user-defined literals (UDL) has been provided to form
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::duration</a> objects with various duration periods such as hours,
minutes, seconds, milliseconds, microseconds and nanoseconds.  The
ud-suffixes are preceded with the ‘_’ symbol to distinguish between the
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono</a> UDLs and the <a class="reference external" href="https://en.cppreference.com/w/cpp/chrono">std::chrono</a> UDLs introduced in the C++14
standard and implemented in the standard library.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">bsl</span><span class="o">::</span><span class="nn">chrono_literals</span><span class="p">;</span><span class="w"></span>
<span class="n">bsls</span><span class="o">::</span><span class="n">TimeInterval</span><span class="w"> </span><span class="n">elapsedTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="n">_s</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="using-bsls-timeinterval-with-helper-types">
<h2>Using <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a> with Helper Types<a class="headerlink" href="#using-bsls-timeinterval-with-helper-types" title="Permalink to this headline">¶</a></h2>
<p>The standard helper types for time units are available in the <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsl.html">bsl</a> namespace.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">bsls</span><span class="o">::</span><span class="n">TimeInterval</span><span class="w"> </span><span class="nf">elapsedTime</span><span class="p">(</span><span class="n">bsl</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">microseconds</span><span class="p">(</span><span class="mi">500</span><span class="p">));</span><span class="w"></span>
<span class="n">bsl</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">microseconds</span><span class="w"> </span><span class="n">duration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">elapsedTime</span><span class="p">.</span><span class="n">asDuration</span><span class="o">&lt;</span><span class="n">bsl</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">microseconds</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="bsls-systemclocktype-versus-bsl-chrono-clocks">
<h2><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__systemclocktype.html">bsls::SystemClockType</a> versus <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono</a> Clocks<a class="headerlink" href="#bsls-systemclocktype-versus-bsl-chrono-clocks" title="Permalink to this headline">¶</a></h2>
<p>On all production (and tested) platforms, <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/structbsls_1_1SystemClockType.html#a6e75b1e793b629b48e21b6cee448d56b">bsls::SystemClockType::e_REALTIME</a>
is equivalent to <a class="reference external" href="https://en.cppreference.com/w/cpp/chrono/system_clock">std::chrono::system_clock</a> and
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/structbsls_1_1SystemClockType.html#a6e75b1e793b629b48e21b6cee448d56b">bsls::SystemClockType::e_MONOTONIC</a> is equivalent to
<a class="reference external" href="https://en.cppreference.com/w/cpp/chrono/steady_clock">std::chrono::steady_clock</a> (meaning the BDE clock-type and the matching
standard library clock can be used interchangeably).  If a platform is found
where this is not the case, <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::system_clock</a> and
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::steady_clock</a> will be modified to match the ones indicated by
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__systemclocktype.html">bsls::SystemClockType</a>.  As such, we strongly recommend using  <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono</a>
when working with BDE types.</p>
</div>
<div class="section" id="bslmt-chronoutil">
<h2><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslmt__chronoutil.html">bslmt::ChronoUtil</a><a class="headerlink" href="#bslmt-chronoutil" title="Permalink to this headline">¶</a></h2>
<p>This struct provides a namespace for utility functions that operate on
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono</a> facilities.  Presently, it contains four methods:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/structbslmt_1_1ChronoUtil.html#a80ce3b5be4f61262ae8c1d0b40d57632">bslmt::ChronoUtil::durationToTimeInterval</a>,</p></li>
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/structbslmt_1_1ChronoUtil.html#abf7feacaf71ddd686db994fff540442e">bslmt::ChronoUtil::isMatchingClock</a>,</p></li>
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/structbslmt_1_1ChronoUtil.html#af61cb5563d8c925633b86a5d1d9a7b1d">bslmt::ChronoUtil::timedWait</a>, and</p></li>
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/structbslmt_1_1ChronoUtil.html#af61cb5563d8c925633b86a5d1d9a7b1d">bslmt::ChronoUtil::timedWait</a> with an additional argument.</p></li>
</ul>
<p>The method <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/structbslmt_1_1ChronoUtil.html#a80ce3b5be4f61262ae8c1d0b40d57632">bslmt::ChronoUtil::durationToTimeInterval</a> returns a
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a> for the provided duration, and allows durations with
floating-point representations.  The method
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/structbslmt_1_1ChronoUtil.html#abf7feacaf71ddd686db994fff540442e">bslmt::ChronoUtil::isMatchingClock</a> returns true if the specified (template
parameter) clock matches the clock indicated by a <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__systemclocktype.html">bsls::SystemClockType</a>
value.  The two <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/structbslmt_1_1ChronoUtil.html#af61cb5563d8c925633b86a5d1d9a7b1d">bslmt::ChronoUtil::timedWait</a> methods are helpers for
implementing higher-level <code class="docutils literal notranslate"><span class="pre">timedWait</span></code> operations (e.g.,
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/classbslmt_1_1TimedSemaphore.html#a18f722fb54c9ee047c1654560a9a557c">bslmt::TimedSemaphore::timedWait</a>) using the logic explained in
<a class="reference internal" href="#enhancements"><span class="std std-ref">Enhancements to bslmt Components to Support bsl::chrono</span></a>.</p>
</div>
<div class="section" id="converting-a-floating-point-bsl-chrono-duration">
<h2>Converting a Floating Point <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::duration</a><a class="headerlink" href="#converting-a-floating-point-bsl-chrono-duration" title="Permalink to this headline">¶</a></h2>
<p>The method <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/structbslmt_1_1ChronoUtil.html#a80ce3b5be4f61262ae8c1d0b40d57632">bslmt::ChronoUtil::durationToTimeInterval</a> make a best effort
conversion to a <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__timeinterval.html">bsls::TimeInterval</a> from any <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::duration</a>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">bsls</span><span class="o">::</span><span class="n">TimeInterval</span><span class="w"> </span><span class="n">fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bslmt</span><span class="o">::</span><span class="n">ChronoUtil</span><span class="o">::</span><span class="n">durationToTimeInterval</span><span class="p">(</span><span class="w"></span>
<span class="w">                                         </span><span class="n">bsl</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">duration</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">6.5</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="enhancements-to-bslmt-components-to-support-bsl-chrono">
<span id="enhancements"></span><h2>Enhancements to bslmt Components to Support bsl::chrono<a class="headerlink" href="#enhancements-to-bslmt-components-to-support-bsl-chrono" title="Permalink to this headline">¶</a></h2>
<p>The classes in <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslmt.html">bslmt</a> that accept a <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bsls__systemclocktype.html">bsls::SystemClockType</a> in their
constructor were augmented to accept <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::system_clock</a> and
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::steady_clock</a> (user defined clocks are not accepted in the
constructor).  Additionally, the <code class="docutils literal notranslate"><span class="pre">timeWait</span></code> methods were augmented to accept a
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::time_point</a>, with an arbitrary clock.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is strongly recommended to supply <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::time_point</a> objects that
use the same clock as the one used to construct the <code class="docutils literal notranslate"><span class="pre">bslmt</span></code> object.</p>
</div>
<p>If the clock of the <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::time_point</a> does not match the clock
provided to the
constructor, the timed-wait method must make an addition comparison against
<code class="docutils literal notranslate"><span class="pre">time_point::clock::now()</span></code> (and potentially, do this repeatedly) to ensure
the contract of the
method is guaranteed (the function does not time out before the specified
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::time_point</a> has occurred).  If the clock of the <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::time_point</a>
matches the clock provided to the constructor, the timed-wait method does not
need an additional comparison against <code class="docutils literal notranslate"><span class="pre">time_point::clock::now()</span></code> (potentially
multiple comparisons) and hence is more efficient.</p>
<p>The following classes were augmented:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslmt__barrier.html">bslmt::Barrier</a>,</p></li>
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslmt__condition.html">bslmt::Condition</a>,</p></li>
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslmt__fastpostsemaphore.html">bslmt::FastPostSemaphore</a>,</p></li>
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslmt__latch.html">bslmt::Latch</a>,</p></li>
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslmt__sluice.html">bslmt::Sluice</a>, and</p></li>
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslmt__timedsemaphore.html">bslmt::TimedSemaphore</a>.</p></li>
</ul>
<p>For example, to use a <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::time_point</a> with <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslmt__condition.html">bslmt::Condition</a>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">bsl</span><span class="o">::</span><span class="nn">chrono_literals</span><span class="p">;</span><span class="w"></span>

<span class="c1">// Using the same clock as the time_points supplied to timedWait is</span>
<span class="c1">// highly recommended.</span>
<span class="n">bslmt</span><span class="o">::</span><span class="n">Condition</span><span class="w"> </span><span class="nf">condition</span><span class="p">((</span><span class="n">bsl</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">steady_clock</span><span class="p">()));</span><span class="w"></span>
<span class="n">bslmt</span><span class="o">::</span><span class="n">Mutex</span><span class="w">     </span><span class="n">mutex</span><span class="p">;</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="n">rc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">condition</span><span class="p">.</span><span class="n">timedWait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex</span><span class="p">,</span><span class="w"> </span><span class="n">bsl</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">steady_clock</span><span class="o">::</span><span class="n">now</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="n">_s</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">rc</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// condition signalled, do something</span>
<span class="p">}</span><span class="w"></span>
<span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bslmt</span><span class="o">::</span><span class="n">Condition</span><span class="o">::</span><span class="n">e_TIMED_OUT</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">rc</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// timeout</span>
<span class="p">}</span><span class="w"></span>
<span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// error</span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="miscelaneous-interface-enhancements">
<h2>Miscelaneous Interface Enhancements<a class="headerlink" href="#miscelaneous-interface-enhancements" title="Permalink to this headline">¶</a></h2>
<div class="section" id="bdlmt-eventscheduler">
<h3><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bdlmt__eventscheduler.html">bdlmt::EventScheduler</a><a class="headerlink" href="#bdlmt-eventscheduler" title="Permalink to this headline">¶</a></h3>
<p>The class <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bdlmt__eventscheduler.html">bdlmt::EventScheduler</a> was augmented similarly to <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslmt.html">bslmt</a>, but
instead of timed-wait methods being added, all the scheduling and rescheduling
methods were augmented to accept a <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::time_point</a>.  Overloads
accepting a <code class="docutils literal notranslate"><span class="pre">time_point</span></code> were added to the following methods:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/classbdlmt_1_1EventScheduler.html#a561885ddbafd6351b6edf2b65d3213de">bdlmt::EventScheduler::rescheduleEvent</a>,</p></li>
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/classbdlmt_1_1EventScheduler.html#a1bbb3c6ad8fdfaef899b623a4923f48f">bdlmt::EventScheduler::rescheduleEventAndWait</a>,</p></li>
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/classbdlmt_1_1EventScheduler.html#a31b6c731d6fb8dffbdc8832d80b9b1a5">bdlmt::EventScheduler::scheduleEvent</a>,</p></li>
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/classbdlmt_1_1EventScheduler.html#a8fa59d5efdb76ea76f447be5bfe852ae">bdlmt::EventScheduler::scheduleEventRaw</a>,</p></li>
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/classbdlmt_1_1EventScheduler.html#a98f01b7b453fbc33f8a17864ee6f5b21">bdlmt::EventScheduler::scheduleRecurringEvent</a>, and</p></li>
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/classbdlmt_1_1EventScheduler.html#ab65c8c256c2e6d2fdd5ed0f7c384f288">bdlmt::EventScheduler::scheduleRecurringEventRaw</a>.</p></li>
</ul>
</div>
<div class="section" id="bslmt-threadutil">
<h3><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslmt__threadutil.html">bslmt::ThreadUtil</a><a class="headerlink" href="#bslmt-threadutil" title="Permalink to this headline">¶</a></h3>
<p>The following methods were added:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/structbslmt_1_1ThreadUtil.html#aa492529c530682030765ab9da7906876">bslmt::ThreadUtil::sleep(const bsl::chrono::duration&amp; sleepTime)</a>, and</p></li>
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/structbslmt_1_1ThreadUtil.html#ac1a7d0c1f34d6ca9d4fbc8f25d4385e4">bslmt::ThreadUtil::sleepUntil(const bsl::chrono::time_point&amp; absoluteTime)</a>.</p></li>
</ul>
</div>
<div class="section" id="bdlmt-throttle">
<h3><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bdlmt__throttle.html">bdlmt::Throttle</a><a class="headerlink" href="#bdlmt-throttle" title="Permalink to this headline">¶</a></h3>
<p>The class <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bdlmt__throttle.html">bdlmt::Throttle</a> had its initialization methods augmented to accept
<a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::system_clock</a> and <a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/group__bslstl__chrono.html">bsl::chrono::steady_clock</a>:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://bloomberg.github.io/bde-resources/doxygen/bde_api_prod/classbdlmt_1_1Throttle.html#a27eaa428122c5a528c3ecd797bfe24b3">bdlmt::Throttle::initialize</a></p></li>
</ul>
<p>No other changes were made (please see this component’s documentation for an
explanation).</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2024, Bloomberg LP.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>