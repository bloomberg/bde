<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>BDE 3.0: btlso_inetstreamsocket Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <style>
      div.hanging {
        padding-left: 0.75in;
        text-indent: -0.50in;
      }
      div.unhanging {
        text-indent:     0in;
      }
      a.glossary {
        font-weight: bold;
        font-style: italic;
      }
    </style>
</head>
<!--
<body onload='searchBox.OnSelectItem(0);'>
-->
<body>

<table border=2 cellspacing=0 cellpadding=0 align=center>
<tr>
 <td valign=top align=center>
 <p align=center><b><i>Quick Links:</i></b></p>
 </td>
 <td valign=top align=center>
 <p align=center>
<a class="qindex" href="group__bal.html" target="_blank">bal</a> | <a class="qindex" href="group__bbl.html" target="_blank">bbl</a> | <a class="qindex" href="group__bdl.html" target="_blank">bdl</a> | <a class="qindex" href="group__bsl.html" target="_blank">bsl</a> | <a class="qindex" href="group__btl.html" target="_blank">btl</a>
 </td>
 </tr>
 </table>

  </div>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="components.html"><span>Components</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<h1>Component btlso_inetstreamsocket<br/>
<small>
[<a class="el" href="group__btlso.html">Package btlso</a>]</small>
</h1>  </div>
</div>
<div class="contents">

<p>Implementation for TCP based stream sockets.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebtlso.html">btlso</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="user"><dt><b>Outline</b></dt><dd><ul>
<li>
<a href="#1">Purpose</a> </li>
<li>
<a href="#2">Classes</a> </li>
<li>
<a href="#3">Description</a> <ul>
<li>
<a href="#3.1">Thread Safety</a> </li>
<li>
<a href="#3.2">Usage</a> <ul>
<li>
<a href="#3.2.1">Example 1: Exchanging Data Using a Stream Socket</a> </li>
</ul>
</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="purpose"></a> <a class="anchor" id="1"></a> </dd></dl>
<dl class="user"><dt><b>Purpose: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Implementation for TCP based stream sockets. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="classes"></a> <a class="anchor" id="2"></a> </dd></dl>
<dl class="user"><dt><b>Classes: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><table class="doxtable">
<tr>
<td><a class="el" href="classbtlso_1_1InetStreamSocket.html">btlso::InetStreamSocket</a> </td><td>implementation of TCP-based stream-sockets  </td></tr>
<tr>
<td><a class="el" href="classbtlso_1_1InetStreamSocketCloseGuard.html">btlso::InetStreamSocketCloseGuard</a> </td><td>proctor for managing stream-sockets  </td></tr>
</table>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__btlso__streamsocket.html" title="Define a protocol for stream-based socket communications.">Component btlso_streamsocket</a>, <a class="el" href="group__btlso__ipv4address.html" title="Provide a representation of an IPv4 address.">Component btlso_ipv4address</a>, <a class="el" href="group__btlsos__tcpconnector.html" title="Provide a synchronous connector to TCP-based servers.">Component btlsos_tcpconnector</a> </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="description"></a> <a class="anchor" id="3"></a> </dd></dl>
<dl class="user"><dt><b>Description: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This component implements TCP-based stream sockets of type <code><a class="el" href="classbtlso_1_1InetStreamSocket.html">btlso::InetStreamSocket</a>&lt;ADDRESS&gt;</code> conforming to the <code><a class="el" href="classbtlso_1_1StreamSocket.html">btlso::StreamSocket</a>&lt;ADDRESS&gt;</code> protocol. The classes are templatized to provide type-safe address class specialization. The only address type currently supported is IPv4 (as provided by <code>btlso_ipv4address</code> component). Therefore, the template parameter will always be <code><a class="el" href="classbtlso_1_1IPv4Address.html">btlso::IPv4Address</a></code>. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="thread_safety"></a> <a class="anchor" id="description.thread_safety"></a> <a class="anchor" id="3.1"></a> </dd></dl>
<dl class="user"><dt><b>Thread Safety: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The classes provided by this component depend on a <code><a class="el" href="classbslma_1_1Allocator.html">bslma::Allocator</a></code> instance to supply memory. If the allocator is not thread enabled then the instances of this component that use the same allocator instance will consequently not be thread safe. Otherwise, this component provides the following guarantees: </dd></dl>
<dl class="user"><dt><b></b></dt><dd>The <code><a class="el" href="classbtlso_1_1InetStreamSocket.html">btlso::InetStreamSocket</a></code> is not <em>thread-enabled</em> (it is not safe to invoke methods from different threads on the same instance). <code><a class="el" href="classbtlso_1_1InetStreamSocket.html">btlso::InetStreamSocket</a></code> is <em>thread-safe</em>, meaning that distinct threads can access distinct instances simultaneously without any side-effects (which usually means that there is no <code>static</code> data). The classes provided by this component are not <em>async-safe</em>, meaning that one or more functions cannot be invoked safely from a signal handler. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="usage"></a> <a class="anchor" id="description.usage"></a> <a class="anchor" id="3.2"></a> </dd></dl>
<dl class="user"><dt><b>Usage: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>In this section we show intended usage of this component. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="example_1~3A_exchanging_data_using_a_stream_socket"></a> <a class="anchor" id="usage.example_1~3A_exchanging_data_using_a_stream_socket"></a> <a class="anchor" id="description.usage.example_1~3A_exchanging_data_using_a_stream_socket"></a> <a class="anchor" id="example_1"></a> <a class="anchor" id="usage.example_1"></a> <a class="anchor" id="description.usage.example_1"></a> <a class="anchor" id="3.2.1"></a> </dd></dl>
<dl class="user"><dt><b>Example 1: Exchanging Data Using a Stream Socket: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>In this example we will show how to create two stream sockets, establish a connection, and then exchange data between them. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>First, we will open a pair of socket handles. <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="structbtlso_1_1SocketHandle.html#a92cfe6067b84ee5301cc25d0f1a80a11">btlso::SocketHandle::Handle</a> clientHandle, serverHandle;

  <span class="keywordtype">int</span> rc = btlso::SocketImpUtil::open&lt;btlso::IPv4Address&gt;(
                                      &amp;clientHandle,
                                      btlso::SocketImpUtil::k_SOCKET_STREAM);
  assert(0 == rc);

  rc = btlso::SocketImpUtil::open&lt;btlso::IPv4Address&gt;(
                                      &amp;serverHandle,
                                      btlso::SocketImpUtil::k_SOCKET_STREAM);
  assert(0 == rc);
</pre></div><br/>
<br/>
 Then, we will construct the server and client stream socket objects, <code>serverSocket</code> and <code>clientSocket</code> respectively. <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbtlso_1_1InetStreamSocket.html">btlso::InetStreamSocket&lt;btlso::IPv4Address&gt;</a> serverSocket(serverHandle);
  <a class="code" href="classbtlso_1_1InetStreamSocket.html">btlso::InetStreamSocket&lt;btlso::IPv4Address&gt;</a> clientSocket(clientHandle);
</pre></div><br/>
<br/>
 Next, we will bind <code>serverSocket</code> to a local address and start listening on it. <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbtlso_1_1IPv4Address.html">btlso::IPv4Address</a> localAddress;
  localAddress.<a class="code" href="classbtlso_1_1IPv4Address.html#aec63c02ca653889ddf2edbd3b0a74062">setIpAddress</a>(<span class="stringliteral">&quot;127.0.0.1&quot;</span>);
  localAddress.<a class="code" href="classbtlso_1_1IPv4Address.html#a0db9b6717cd8bd435caeeb46a9bbd818">setPortNumber</a>(0);

  rc = serverSocket.bind(localAddress);
  assert(0 == rc);

  <a class="code" href="classbtlso_1_1IPv4Address.html">btlso::IPv4Address</a> serverAddress;
  rc = serverSocket.localAddress(&amp;serverAddress);
  assert(0 == rc);

  rc = serverSocket.listen(10);
  assert(0 == rc);
</pre></div><br/>
<br/>
 Then, we will connect <code>clientSocket</code> to <code>localAddress</code>. <br/>
<br/>
<div class="fragment"><pre class="fragment">  rc = clientSocket.connect(serverAddress);
  assert(0 == rc);
</pre></div><br/>
<br/>
 Next, we will create a new stream socket, <code>acceptSocket</code>, after accepting the new connection. <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbtlso_1_1StreamSocket.html">btlso::StreamSocket&lt;btlso::IPv4Address&gt;</a> *acceptSocket;
  <a class="code" href="classbtlso_1_1IPv4Address.html">btlso::IPv4Address</a> clientAddress;

  rc = serverSocket.accept(&amp;acceptSocket);
  assert(0 == rc);
</pre></div><br/>
<br/>
 Then, we will confirm that both sockets are connected. <br/>
<br/>
<div class="fragment"><pre class="fragment">  rc = clientSocket.connectionStatus();
  assert(0 == rc);

  rc = acceptSocket-&gt;<a class="code" href="classbtlso_1_1StreamSocket.html#a7d1d22e0609c240f1851e77b96646043">connectionStatus</a>();
  assert(0 == rc);
</pre></div><br/>
<br/>
 Next, we will write a message through <code>clientSocket</code>. <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">char</span>      *writeBuffer    = <span class="stringliteral">&quot;Hello World!&quot;</span>;
  <span class="keyword">const</span> <span class="keywordtype">int</span>  writeBufferLen = bsl::strlen(writeBuffer);

  rc = clientSocket.write(writeBuffer, writeBufferLen);
  assert(rc == writeBufferLen);
</pre></div><br/>
<br/>
 Now, we will read the written message through <code>acceptSocket</code>. <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keyword">const</span> <span class="keywordtype">int</span>  BUFSIZE = 64;
  <span class="keywordtype">char</span>       readBuffer[BUFSIZE];

  rc = acceptSocket-&gt;<a class="code" href="classbtlso_1_1StreamSocket.html#aded1055cfd215bd6ae9cfd1723559a4a">read</a>(readBuffer, BUFSIZE);
  assert(rc == writeBufferLen);
</pre></div><br/>
<br/>
 Finally, we will close all the sockets. <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="structbtlso_1_1SocketImpUtil.html#a7325d5370d7aca579a1db09f81e56475">btlso::SocketImpUtil::close</a>(clientHandle);
  <a class="code" href="structbtlso_1_1SocketImpUtil.html#a7325d5370d7aca579a1db09f81e56475">btlso::SocketImpUtil::close</a>(acceptSocket-&gt;<a class="code" href="classbtlso_1_1StreamSocket.html#ae81e54f647121c797201d61067c785bf">handle</a>());
  <a class="code" href="structbtlso_1_1SocketImpUtil.html#a7325d5370d7aca579a1db09f81e56475">btlso::SocketImpUtil::close</a>(serverHandle);
</pre></div><br/>
<br/>
 </dd></dl>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Apr 1 2016 16:49:15 for BDE Release 3.0 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
