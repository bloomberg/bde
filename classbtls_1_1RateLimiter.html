<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>BDE 3.0: Class btls::RateLimiter</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <style>
      div.hanging {
        padding-left: 0.75in;
        text-indent: -0.50in;
      }
      div.unhanging {
        text-indent:     0in;
      }
      a.glossary {
        font-weight: bold;
        font-style: italic;
      }
    </style>
</head>
<!--
<body onload='searchBox.OnSelectItem(0);'>
-->
<body>

<table border=2 cellspacing=0 cellpadding=0 align=center>
<tr>
 <td valign=top align=center>
 <p align=center><b><i>Quick Links:</i></b></p>
 </td>
 <td valign=top align=center>
 <p align=center>
<a class="qindex" href="group__bal.html" target="_blank">bal</a> | <a class="qindex" href="group__bbl.html" target="_blank">bbl</a> | <a class="qindex" href="group__bdl.html" target="_blank">bdl</a> | <a class="qindex" href="group__bsl.html" target="_blank">bsl</a> | <a class="qindex" href="group__btl.html" target="_blank">btl</a>
 </td>
 </tr>
 </table>

  </div>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="components.html"><span>Components</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="namespacebtls.html">btls</a>      </li>
      <li><a class="el" href="classbtls_1_1RateLimiter.html">btls::RateLimiter</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<h1>btls::RateLimiter Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="btls::RateLimiter" -->
<p><code>#include &lt;<a class="el" href="btls__ratelimiter_8h_source.html">btls_ratelimiter.h</a>&gt;</code></p>

<p><a href="classbtls_1_1RateLimiter-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#a0696a4419a5d3c6b4804b248f1d48ff6">RateLimiter</a> (<a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a> sustainedRateLimit, const <a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> &amp;sustainedRateWindow, <a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a> peakRateLimit, const <a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> &amp;peakRateWindow, const <a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> &amp;currentTime)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#a9b1cb8f99043059835fcf68bec5b7f7d">~RateLimiter</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#a166be11a5b22baa8a6dc57ec1cfcbd55">updateState</a> (const <a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> &amp;currentTime)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#a655ee53dc0e1722dabf4eeeca7c27c4b">resetStatistics</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#af4fcdea53a0cc0fbdedb53958f8dae1d">setRateLimits</a> (<a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a> sustainedRateLimit, const <a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> &amp;sustainedRateWindow, <a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a> peakRateLimit, const <a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> &amp;peakRateWindow)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#a0e552262b2e94fda78b550ab8cb0630b">submit</a> (<a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a> numUnits)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#a9b35559696d3e53401018ac20adf99f8">reserve</a> (<a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a> numUnits)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#a60504ca0429e13511b7131d07945efb9">cancelReserved</a> (<a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a> numUnits)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#ab7906ab3970f28b589f4a948d8278231">submitReserved</a> (<a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a> numUnits)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#a7abfc0076012006764b7985c498486d8">wouldExceedBandwidth</a> (const <a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> &amp;currentTime)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#a63bba2aff1d9751ac6398394bcf5ce50">calculateTimeToSubmit</a> (const <a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> &amp;currentTime)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#a3d3fcf2858bd3c1b0c0e71de52fb3c53">reset</a> (const <a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> &amp;currentTime)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#a11fb14a7e208464c96669802374ec0e3">peakRateLimit</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#a56e5d575b27f7e30bbf176203c5947b7">peakRateWindow</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#ade3fe7d01faf25d07ed1e388b4689eb0">sustainedRateLimit</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#a4dd3c94f1a34f0a575fbda4d9311fbd3">sustainedRateWindow</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#a17c6c102539fea72e1ce36535c62d59b">unitsReserved</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#affb01af842fb52bf113da429ee30c837">lastUpdateTime</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#abecd71fbfafd3f3f10f24f08bc302b7e">getStatistics</a> (<a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a> *submittedUnits, <a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a> *unusedUnits) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbtls_1_1RateLimiter.html#aefbd30c95f152fb1c53313ef3edaf96a">statisticsCollectionStartTime</a> () const </td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This mechanism implements a rate limiter that allows clients to monitor and control the usage of a resource such that the rate of consumption stays within configured limits. The behavior of a rate limiter is determined by four properties: the sustained rate (in units/s), the sustained-rate time-window (in seconds), the peak rate (in units/s), and the peak-rate time-window (in seconds). All of these properties can be specified at construction or using the <code>setRateLimits</code> method.</p>
<p>Units can be indicated to a rate limiter as consumed by either submitting them using the <code>submit</code> method. Units can be marked as reserved, which effectively shorten the sustained-rate time-window and the peak-rate time-window, by using the <code>reserve</code> method.</p>
<p>Whether submitting 1 more unit would exceed the configured limits can be determined using the <code>wouldExceedBandwidth</code> method. The estimated amount of time to wait before 1 more unit will be allowed to be submitted can be determined using the <code>calculateTimeToSubmit</code> method.</p>
<p>The state of a rate limiter must be updated manually using the <code>updateState</code> method supplying the current time interval. The time intervals supplied should all refer to the same time origin.</p>
<p>A rate limiter keeps some statistics, including the number of submitted units, that can be accessed using the <code>getStatistics</code> and reset using the <code>resetStatistics</code> method.</p>
<p>This class: </p>
<ul>
<li>
is <em>exception</em> <em>neutral</em> (agnostic)  </li>
<li>
is <em>const</em> <em>thread-safe</em>  </li>
</ul>
<p>For terminology see <code>bsldoc_glossary</code>. </p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a0696a4419a5d3c6b4804b248f1d48ff6"></a><!-- doxytag: member="btls::RateLimiter::RateLimiter" ref="a0696a4419a5d3c6b4804b248f1d48ff6" args="(bsls::Types::Uint64 sustainedRateLimit, const bsls::TimeInterval &amp;sustainedRateWindow, bsls::Types::Uint64 peakRateLimit, const bsls::TimeInterval &amp;peakRateWindow, const bsls::TimeInterval &amp;currentTime)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">btls::RateLimiter::RateLimiter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a>&nbsp;</td>
          <td class="paramname"> <em>sustainedRateLimit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>sustainedRateWindow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a>&nbsp;</td>
          <td class="paramname"> <em>peakRateLimit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>peakRateWindow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>currentTime</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create a <a class="el" href="classbtls_1_1RateLimiter.html">RateLimiter</a> object, having the specified <code>sustainedRateLimit</code>, the specified <code>sustainedRateWindow</code>, the specified <code>peakRateLimit</code>, the specified <code>peakRateWindow</code>, and using the specified <code>currentTime</code> as the initial <code>lastUpdateTime</code>. The behavior is undefined unless <code>0 &lt; sustainedRateLimit</code>, <code>0 &lt; sustainedRateWindow</code>, <code>0 &lt; peakRateLimit</code>, <code>0 &lt; peakRateWindow</code>, the product of <code>sustainedRateLimit</code> and <code>sustainedRateWindow</code> can be represented by 64-bit unsigned integral type, and the product of <code>peakRateLimit</code> and <code>peakRateWindow</code> can be represented by 64-bit unsigned integral type. </p>

</div>
</div>
<a class="anchor" id="a9b1cb8f99043059835fcf68bec5b7f7d"></a><!-- doxytag: member="btls::RateLimiter::~RateLimiter" ref="a9b1cb8f99043059835fcf68bec5b7f7d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">btls::RateLimiter::~RateLimiter </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Destroy this object. </p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a166be11a5b22baa8a6dc57ec1cfcbd55"></a><!-- doxytag: member="btls::RateLimiter::updateState" ref="a166be11a5b22baa8a6dc57ec1cfcbd55" args="(const bsls::TimeInterval &amp;currentTime)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void btls::RateLimiter::updateState </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>currentTime</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the <code>lastUpdateTime</code> of this rate limiter to the specified <code>currentTime</code>. If <code>currentTime</code> is after <code>lastUpdateTime</code>, then recalculate number of units available for consumption based on the <code>peakRate</code>, <code>sustainedRate</code> and the time interval between <code>lastUpdateTime</code> and <code>currentTime</code>. If <code>currentTime</code> is before <code>statisticsCollectionStartTime</code>, set it' to <code>currentTime</code>. </p>

</div>
</div>
<a class="anchor" id="a655ee53dc0e1722dabf4eeeca7c27c4b"></a><!-- doxytag: member="btls::RateLimiter::resetStatistics" ref="a655ee53dc0e1722dabf4eeeca7c27c4b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void btls::RateLimiter::resetStatistics </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Reset the statics collected for this rate limiter by setting the number of units used and the number of units submitted to 0, and set the <code>statisticsCollectionStartTime</code> to the <code>lastUpdateTime</code> of this leaky bucket. </p>

</div>
</div>
<a class="anchor" id="af4fcdea53a0cc0fbdedb53958f8dae1d"></a><!-- doxytag: member="btls::RateLimiter::setRateLimits" ref="af4fcdea53a0cc0fbdedb53958f8dae1d" args="(bsls::Types::Uint64 sustainedRateLimit, const bsls::TimeInterval &amp;sustainedRateWindow, bsls::Types::Uint64 peakRateLimit, const bsls::TimeInterval &amp;peakRateWindow)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void btls::RateLimiter::setRateLimits </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a>&nbsp;</td>
          <td class="paramname"> <em>sustainedRateLimit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>sustainedRateWindow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a>&nbsp;</td>
          <td class="paramname"> <em>peakRateLimit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>peakRateWindow</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the sustained rate of this rate limiter to the specified <code>sustainedRateLimit</code>, the sustained-rate time-window to the specified <code>sustainedRateWindow</code>, the peak rate to the specified <code>peakRateLimit</code> and the peak-rate time-window to the specified <code>peakRateWindow</code>. The behavior is undefined unless <code>0 &lt; sustainedRateLimit</code>, <code>0 &lt; sustainedRateWindow</code>, <code>0 &lt; peakRateLimit</code>, <code>0 &lt; peakRateWindow</code>, the product of <code>sustainedRateLimit</code> and <code>sustainedRateWindow</code> can be represented by 64-bit unsigned integral type, and the product of <code>peakRateLimit</code> and <code>peakRateWindow</code> can be represented by 64-bit unsigned integral type. </p>

</div>
</div>
<a class="anchor" id="a0e552262b2e94fda78b550ab8cb0630b"></a><!-- doxytag: member="btls::RateLimiter::submit" ref="a0e552262b2e94fda78b550ab8cb0630b" args="(bsls::Types::Uint64 numUnits)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void btls::RateLimiter::submit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a>&nbsp;</td>
          <td class="paramname"> <em>numUnits</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Submit the specified <code>numUnits</code> to this rate limiter. The behavior is undefined unless the sum of <code>numUnits</code>, unused units previously submitted to this rate limiter, and <code>unitsReserved</code> can be represented by a 64-bit unsigned integral type. </p>

</div>
</div>
<a class="anchor" id="a9b35559696d3e53401018ac20adf99f8"></a><!-- doxytag: member="btls::RateLimiter::reserve" ref="a9b35559696d3e53401018ac20adf99f8" args="(bsls::Types::Uint64 numUnits)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void btls::RateLimiter::reserve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a>&nbsp;</td>
          <td class="paramname"> <em>numUnits</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Reserve the specified <code>numUnits</code> for future use by this rate limiter. The behavior is undefined unless the sum of <code>numUnits</code>, unused units previously submitted to this rate limiter, and <code>unitsReserved</code> can be represented by a 64-bit unsigned integral type. </p>

</div>
</div>
<a class="anchor" id="a60504ca0429e13511b7131d07945efb9"></a><!-- doxytag: member="btls::RateLimiter::cancelReserved" ref="a60504ca0429e13511b7131d07945efb9" args="(bsls::Types::Uint64 numUnits)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void btls::RateLimiter::cancelReserved </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a>&nbsp;</td>
          <td class="paramname"> <em>numUnits</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Cancel the specified <code>numUnits</code> that were previously reserved. The behavior is undefined unless <code>numUnits &lt;= <a class="el" href="classbtls_1_1RateLimiter.html#a17c6c102539fea72e1ce36535c62d59b">unitsReserved()</a></code>. </p>

</div>
</div>
<a class="anchor" id="ab7906ab3970f28b589f4a948d8278231"></a><!-- doxytag: member="btls::RateLimiter::submitReserved" ref="ab7906ab3970f28b589f4a948d8278231" args="(bsls::Types::Uint64 numUnits)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void btls::RateLimiter::submitReserved </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a>&nbsp;</td>
          <td class="paramname"> <em>numUnits</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Submit the specified <code>numUnits</code> that were previously reserved. The behavior is undefined unless <code>numUnits &lt;= <a class="el" href="classbtls_1_1RateLimiter.html#a17c6c102539fea72e1ce36535c62d59b">unitsReserved()</a></code>. </p>

</div>
</div>
<a class="anchor" id="a7abfc0076012006764b7985c498486d8"></a><!-- doxytag: member="btls::RateLimiter::wouldExceedBandwidth" ref="a7abfc0076012006764b7985c498486d8" args="(const bsls::TimeInterval &amp;currentTime)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool btls::RateLimiter::wouldExceedBandwidth </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>currentTime</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Update the state of this rate limiter to the specified <code>currentTime</code>. Return <code>true</code> if submitting 1 unit at the <code>currentTime</code> would exceed the configured limits, and false otherwise. </p>

</div>
</div>
<a class="anchor" id="a63bba2aff1d9751ac6398394bcf5ce50"></a><!-- doxytag: member="btls::RateLimiter::calculateTimeToSubmit" ref="a63bba2aff1d9751ac6398394bcf5ce50" args="(const bsls::TimeInterval &amp;currentTime)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> btls::RateLimiter::calculateTimeToSubmit </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>currentTime</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Update the state of this rate limiter to the specified <code>currentTime</code>. Return the estimated time interval that should pass from <code>currentTime</code> until 1 more unit can be submitted to this rate limiter without exceeding its configured limits. The number of nanoseconds in the returned time interval is rounded up. Note that a time interval of 0 is returned if 1 or more units can be submitted at <code>currentTime</code>. Also note that after waiting for the returned time interval, clients should typically check again using this method, because additional units may have been submitted in the interim. </p>

</div>
</div>
<a class="anchor" id="a3d3fcf2858bd3c1b0c0e71de52fb3c53"></a><!-- doxytag: member="btls::RateLimiter::reset" ref="a3d3fcf2858bd3c1b0c0e71de52fb3c53" args="(const bsls::TimeInterval &amp;currentTime)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void btls::RateLimiter::reset </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>currentTime</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Reset the statistics counter for this rate limiter to 0, and set the <code>lastUpdateTime</code> of this rate limiter to the specified <code>currentTime</code>. </p>

</div>
</div>
<a class="anchor" id="a11fb14a7e208464c96669802374ec0e3"></a><!-- doxytag: member="btls::RateLimiter::peakRateLimit" ref="a11fb14a7e208464c96669802374ec0e3" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a> btls::RateLimiter::peakRateLimit </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return the peak rate of this rate limiter. </p>

</div>
</div>
<a class="anchor" id="a56e5d575b27f7e30bbf176203c5947b7"></a><!-- doxytag: member="btls::RateLimiter::peakRateWindow" ref="a56e5d575b27f7e30bbf176203c5947b7" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> btls::RateLimiter::peakRateWindow </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return the peak-rate time-period of this rate limiter. Note that this period is generally significantly shorter than <code>sustainedRateWindow</code>. </p>

</div>
</div>
<a class="anchor" id="ade3fe7d01faf25d07ed1e388b4689eb0"></a><!-- doxytag: member="btls::RateLimiter::sustainedRateLimit" ref="ade3fe7d01faf25d07ed1e388b4689eb0" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a> btls::RateLimiter::sustainedRateLimit </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return the sustained rate of this rate limiter. </p>

</div>
</div>
<a class="anchor" id="a4dd3c94f1a34f0a575fbda4d9311fbd3"></a><!-- doxytag: member="btls::RateLimiter::sustainedRateWindow" ref="a4dd3c94f1a34f0a575fbda4d9311fbd3" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> btls::RateLimiter::sustainedRateWindow </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return the sustained-rate time-period of this rate limiter. Note that this period is generally significantly longer than the <code>peakRateWindow</code>. </p>

</div>
</div>
<a class="anchor" id="a17c6c102539fea72e1ce36535c62d59b"></a><!-- doxytag: member="btls::RateLimiter::unitsReserved" ref="a17c6c102539fea72e1ce36535c62d59b" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a> btls::RateLimiter::unitsReserved </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return the number of reserved units for this rate limiter. </p>

</div>
</div>
<a class="anchor" id="affb01af842fb52bf113da429ee30c837"></a><!-- doxytag: member="btls::RateLimiter::lastUpdateTime" ref="affb01af842fb52bf113da429ee30c837" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> btls::RateLimiter::lastUpdateTime </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return the time when this rate limiter was last updated. </p>

</div>
</div>
<a class="anchor" id="abecd71fbfafd3f3f10f24f08bc302b7e"></a><!-- doxytag: member="btls::RateLimiter::getStatistics" ref="abecd71fbfafd3f3f10f24f08bc302b7e" args="(bsls::Types::Uint64 *submittedUnits, bsls::Types::Uint64 *unusedUnits) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void btls::RateLimiter::getStatistics </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a> *&nbsp;</td>
          <td class="paramname"> <em>submittedUnits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structbsls_1_1Types.html#a62cdf73ffc20667bc9de36b07c9c25f0">bsls::Types::Uint64</a> *&nbsp;</td>
          <td class="paramname"> <em>unusedUnits</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Load, into the specified <code>submittedUnits</code> and the specified <code>unusedUnits</code> respectively, the numbers of submitted units and the number of unused units for this rate limiter from the <code>statisticsCollectionStartTime</code> to the <code>lastUpdateTime</code>. The number of unused units is the difference between the number of units that could have been consumed at the sustained rate and the number of units actually submitted for the time period. </p>

</div>
</div>
<a class="anchor" id="aefbd30c95f152fb1c53313ef3edaf96a"></a><!-- doxytag: member="btls::RateLimiter::statisticsCollectionStartTime" ref="aefbd30c95f152fb1c53313ef3edaf96a" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbsls_1_1TimeInterval.html">bsls::TimeInterval</a> btls::RateLimiter::statisticsCollectionStartTime </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return the time interval when the collection of the statistics (as returned by <code>getStatistics</code>) started. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="btls__ratelimiter_8h_source.html">btls_ratelimiter.h</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Apr 1 2016 16:51:14 for BDE Release 3.0 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
