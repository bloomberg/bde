<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>BDE 3.0: bdlat_typecategory Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <style>
      div.hanging {
        padding-left: 0.75in;
        text-indent: -0.50in;
      }
      div.unhanging {
        text-indent:     0in;
      }
      a.glossary {
        font-weight: bold;
        font-style: italic;
      }
    </style>
</head>
<!--
<body onload='searchBox.OnSelectItem(0);'>
-->
<body>

<table border=2 cellspacing=0 cellpadding=0 align=center>
<tr>
 <td valign=top align=center>
 <p align=center><b><i>Quick Links:</i></b></p>
 </td>
 <td valign=top align=center>
 <p align=center>
<a class="qindex" href="group__bal.html" target="_blank">bal</a> | <a class="qindex" href="group__bbl.html" target="_blank">bbl</a> | <a class="qindex" href="group__bdl.html" target="_blank">bdl</a> | <a class="qindex" href="group__bsl.html" target="_blank">bsl</a> | <a class="qindex" href="group__btl.html" target="_blank">btl</a>
 </td>
 </tr>
 </table>

  </div>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="components.html"><span>Components</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<h1>Component bdlat_typecategory<br/>
<small>
[<a class="el" href="group__bdlat.html">Package bdlat</a>]</small>
</h1>  </div>
</div>
<div class="contents">

<p>Provide type category tags and a tag selection meta-function.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbdlat__TypeCategoryDeclareDynamic.html">bdlat_TypeCategoryDeclareDynamic&lt; TYPE &gt;</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbdlat__TypeCategory.html">bdlat_TypeCategory</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbdlat__TypeCategoryUtil.html">bdlat_TypeCategoryUtil</a></td></tr>
<tr><td colspan="2"><h2><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebdlat__TypeCategoryFunctions.html">bdlat_TypeCategoryFunctions</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="user"><dt><b>Outline</b></dt><dd><ul>
<li>
<a href="#1">Purpose</a> </li>
<li>
<a href="#2">Classes</a> </li>
<li>
<a href="#3">Description</a> <ul>
<li>
<a href="#3.1">Dynamic Types</a> </li>
<li>
<a href="#3.2">Usage</a> <ul>
<li>
<a href="#3.2.1">Example 1: Function Compile-Time Parameterized by <code>TYPE</code></a> </li>
<li>
<a href="#3.2.2">Example 2: Dynamic (Run-Time) Typing</a> </li>
</ul>
</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="purpose"></a> <a class="anchor" id="1"></a> </dd></dl>
<dl class="user"><dt><b>Purpose: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Provide type category tags and a tag selection meta-function. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="classes"></a> <a class="anchor" id="2"></a> </dd></dl>
<dl class="user"><dt><b>Classes: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><table class="doxtable">
<tr>
<td><a class="el" href="structbdlat__TypeCategory_1_1Array.html">bdlat_TypeCategory::Array</a>  </td><td>tag for array types  </td></tr>
<tr>
<td><a class="el" href="structbdlat__TypeCategory_1_1Choice.html">bdlat_TypeCategory::Choice</a>  </td><td>tag for choice types  </td></tr>
<tr>
<td><a class="el" href="structbdlat__TypeCategory_1_1CustomizedType.html">bdlat_TypeCategory::CustomizedType</a>  </td><td>tag for customized types  </td></tr>
<tr>
<td><a class="el" href="structbdlat__TypeCategory_1_1Enumeration.html">bdlat_TypeCategory::Enumeration</a>  </td><td>tag for enumeration types  </td></tr>
<tr>
<td><a class="el" href="structbdlat__TypeCategory_1_1NullableValue.html">bdlat_TypeCategory::NullableValue</a>  </td><td>tag for nullable types  </td></tr>
<tr>
<td><a class="el" href="structbdlat__TypeCategory_1_1Sequence.html">bdlat_TypeCategory::Sequence</a>  </td><td>tag for sequence types  </td></tr>
<tr>
<td><a class="el" href="structbdlat__TypeCategory_1_1Simple.html">bdlat_TypeCategory::Simple</a>  </td><td>tag for simple types  </td></tr>
<tr>
<td><a class="el" href="structbdlat__TypeCategory_1_1Select.html">bdlat_TypeCategory::Select</a>  </td><td>meta-function for selecting tag  </td></tr>
<tr>
<td><a class="el" href="structbdlat__TypeCategoryDeclareDynamic.html">bdlat_TypeCategoryDeclareDynamic</a>  </td><td>meta-function to declare dynamic type  </td></tr>
<tr>
<td><a class="el" href="namespacebdlat__TypeCategoryFunctions.html">bdlat_TypeCategoryFunctions</a>  </td><td>overloadable type category functions  </td></tr>
<tr>
<td><a class="el" href="structbdlat__TypeCategoryUtil.html">bdlat_TypeCategoryUtil</a>  </td><td>type category utility  </td></tr>
</table>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__bdlat__arrayfunctions.html" title="Provide a namespace defining array functions.">Component bdlat_arrayfunctions</a>, <a class="el" href="group__bdlat__choicefunctions.html" title="Provide a namespace defining choice functions.">Component bdlat_choicefunctions</a>, <a class="el" href="group__bdlat__customizedtypefunctions.html" title="Provide a namespace defining customized type functions.">Component bdlat_customizedtypefunctions</a>, <a class="el" href="group__bdlat__enumfunctions.html" title="Provide a namespace defining enumeration functions.">Component bdlat_enumfunctions</a>, <a class="el" href="group__bdlat__nullablevaluefunctions.html" title="Provide a namespace defining nullable value functions.">Component bdlat_nullablevaluefunctions</a>, <a class="el" href="group__bdlat__sequencefunctions.html" title="Provide a namespace defining sequence functions.">Component bdlat_sequencefunctions</a> </dd></dl>
<dl class="user"><dt><b></b></dt><dd>TBD: update this documentation to reflect the new overloaded functions </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="description"></a> <a class="anchor" id="3"></a> </dd></dl>
<dl class="user"><dt><b>Description: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The tag selection meta-function (<code><a class="el" href="structbdlat__TypeCategory_1_1Select.html">bdlat_TypeCategory::Select</a></code>) provided in this component can be used to categorize a parameterized <code>TYPE</code> into one of the following categories: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classCategory.html">Category</a> Tag     Assigned To
  ------------     -----------

  Array            types that expose <span class="stringliteral">&quot;array&quot;</span> behavior through the
                   <span class="stringliteral">&#39;bdlat_ArrayFunctions&#39;</span> <span class="stringliteral">&#39;namespace&#39;</span>.

  Choice           types that expose <span class="stringliteral">&quot;choice&quot;</span> behavior through the
                   <span class="stringliteral">&#39;bdlat_ChoiceFunctions&#39;</span> <span class="stringliteral">&#39;namespace&#39;</span>.

  CustomizedType   types that expose <span class="stringliteral">&quot;customized type&quot;</span> behavior through the
                   <span class="stringliteral">&#39;bdlat_CustomizedTypeFunctions&#39;</span> <span class="stringliteral">&#39;namespace&#39;</span>.

  DynamicType      types that can <a class="code" href="namespacebdlat__TypeCategoryFunctions.html#a89ed08d780f2b22d61ca225f73f8dda5">select</a> a category at runtime

  Enumeration      types that expose <span class="stringliteral">&quot;enumeration&quot;</span> behavior through the
                   <span class="stringliteral">&#39;bdlat_EnumFunctions&#39;</span> <span class="stringliteral">&#39;namespace&#39;</span>.

  NullableValue    types that expose <span class="stringliteral">&quot;nullable&quot;</span> behavior through the
                   <span class="stringliteral">&#39;bdlat_NullableValueFunctions&#39;</span> <span class="stringliteral">&#39;namespace&#39;</span>.

  Sequence         types that expose <span class="stringliteral">&quot;sequence&quot;</span> behavior through the
                   <span class="stringliteral">&#39;bdlat_SequenceFunctions&#39;</span> <span class="stringliteral">&#39;namespace&#39;</span>.

  Simple           all other types.
</pre></div><br/>
<br/>
 A type may only belong to one of these categories at compile time. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="dynamic_types"></a> <a class="anchor" id="description.dynamic_types"></a> <a class="anchor" id="3.1"></a> </dd></dl>
<dl class="user"><dt><b>Dynamic Types: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>There are two ways that a type can be categorized as a dynamic type: <br/>
<br/>
<div class="fragment"><pre class="fragment">  o by specializing the <span class="stringliteral">&#39;bdlat_TypeCategoryDeclareDynamic&#39;</span> meta-function
    and providing a <span class="stringliteral">&#39;VALUE&#39;</span> of 1
  o by implementing more than one of the <span class="stringliteral">&#39;bdlat&#39;</span> category functions (i.e.,
    more than one of <span class="stringliteral">&#39;bdlat_ArrayFunctions&#39;</span>, <span class="stringliteral">&#39;bdlat_ChoiceFunctions&#39;</span>,
    <span class="stringliteral">&#39;bdlat_CustomizedTypeFunctions&#39;</span>, <span class="stringliteral">&#39;bdlat_EnumFunctions&#39;</span>,
    <span class="stringliteral">&#39;bdlat_NullableValueFunctions&#39;</span>, or <span class="stringliteral">&#39;bdlat_SequenceFunctions&#39;</span>).
</pre></div><br/>
<br/>
 Note that AIX and GCC compilers require that the first way be used. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>When a type is categorized as a dynamic type, it <em>must</em> overload the <code><a class="el" href="namespacebdlat__TypeCategoryFunctions.html#a89ed08d780f2b22d61ca225f73f8dda5">bdlat_TypeCategoryFunctions::select</a></code> function to provide the necessary runtime logic that determines its runtime category. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="usage"></a> <a class="anchor" id="description.usage"></a> <a class="anchor" id="3.2"></a> </dd></dl>
<dl class="user"><dt><b>Usage: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This section illustrates intended use of this component. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="example_1~3A_function_compile-time_parameterized_by_type"></a> <a class="anchor" id="usage.example_1~3A_function_compile-time_parameterized_by_type"></a> <a class="anchor" id="description.usage.example_1~3A_function_compile-time_parameterized_by_type"></a> <a class="anchor" id="example_1"></a> <a class="anchor" id="usage.example_1"></a> <a class="anchor" id="description.usage.example_1"></a> <a class="anchor" id="3.2.1"></a> </dd></dl>
<dl class="user"><dt><b>Example 1: Function Compile-Time Parameterized by TYPE: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The following snippets of code illustrate the usage of this component. We will create a <code>printCategoryAndValue</code> function that is parameterized by <code>TYPE</code>: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TYPE&gt;
  <span class="keywordtype">void</span> printCategoryAndValue(bsl::ostream&amp; stream, <span class="keyword">const</span> TYPE&amp; <span class="keywordtype">object</span>);
      <span class="comment">// Print the category of the specified &#39;object&#39; followed by the value</span>
      <span class="comment">// of &#39;object&#39; to the specified output &#39;stream&#39;.</span>
</pre></div><br/>
<br/>
 In order to implement this function, we will use a set of helper functions that are overloaded based on the category tag: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">void</span> printCategory(bsl::ostream&amp; stream, <a class="code" href="structbdlat__TypeCategory_1_1Array.html">bdlat_TypeCategory::Array</a>)
  {
      stream &lt;&lt; <span class="stringliteral">&quot;Array&quot;</span>;
  }

  <span class="keywordtype">void</span> printCategory(bsl::ostream&amp; stream, <a class="code" href="structbdlat__TypeCategory_1_1Choice.html">bdlat_TypeCategory::Choice</a>)
  {
      stream &lt;&lt; <span class="stringliteral">&quot;Choice&quot;</span>;
  }

  <span class="keywordtype">void</span> printCategory(bsl::ostream&amp; stream,
                     <a class="code" href="structbdlat__TypeCategory_1_1CustomizedType.html">bdlat_TypeCategory::CustomizedType</a>)
  {
      stream &lt;&lt; <span class="stringliteral">&quot;CustomizedType&quot;</span>;
  }

  <span class="keywordtype">void</span> printCategory(bsl::ostream&amp; stream, <a class="code" href="structbdlat__TypeCategory_1_1DynamicType.html">bdlat_TypeCategory::DynamicType</a>)
  {
      stream &lt;&lt; <span class="stringliteral">&quot;DynamicType&quot;</span>;
  }

  <span class="keywordtype">void</span> printCategory(bsl::ostream&amp; stream, <a class="code" href="structbdlat__TypeCategory_1_1Enumeration.html">bdlat_TypeCategory::Enumeration</a>)
  {
      stream &lt;&lt; <span class="stringliteral">&quot;Enumeration&quot;</span>;
  }

  <span class="keywordtype">void</span> printCategory(bsl::ostream&amp; stream, <a class="code" href="structbdlat__TypeCategory_1_1NullableValue.html">bdlat_TypeCategory::NullableValue</a>)
  {
      stream &lt;&lt; <span class="stringliteral">&quot;NullableValue&quot;</span>;
  }

  <span class="keywordtype">void</span> printCategory(bsl::ostream&amp; stream, <a class="code" href="structbdlat__TypeCategory_1_1Sequence.html">bdlat_TypeCategory::Sequence</a>)
  {
      stream &lt;&lt; <span class="stringliteral">&quot;Sequence&quot;</span>;
  }

  <span class="keywordtype">void</span> printCategory(bsl::ostream&amp; stream, <a class="code" href="structbdlat__TypeCategory_1_1Simple.html">bdlat_TypeCategory::Simple</a>)
  {
      stream &lt;&lt; <span class="stringliteral">&quot;Simple&quot;</span>;
  }
</pre></div><br/>
<br/>
 Now we can implement the <code>printCategoryAndValue</code> function in terms of the <code>printCategory</code> helper functions: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TYPE&gt;
  <span class="keywordtype">void</span> printCategoryAndValue(bsl::ostream&amp; stream, <span class="keyword">const</span> TYPE&amp; <span class="keywordtype">object</span>)
  {
      <span class="keyword">typedef</span> <span class="keyword">typename</span>
      <a class="code" href="structbslmf_1_1Nil.html">bdlat_TypeCategory::Select&lt;TYPE&gt;::Type</a> TypeCategory;

      printCategory(stream, TypeCategory());

      stream &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;

      <a class="code" href="namespacebdlb_1_1PrintMethods.html#a26513ec0b5c4fa7a532923b7bc41ce0b">bdlb::PrintMethods::print</a>(stream, <span class="keywordtype">object</span>, 0, -1);
  }
</pre></div><br/>
<br/>
 The following function demonstrates the output from this function: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">void</span> runUsageExample1()
  {
      <a class="code" href="classbsl_1_1basic__ostringstream.html">bsl::ostringstream</a> oss;

      <span class="keywordtype">int</span> intVal = 123;

      printCategoryAndValue(oss, intVal);
      assert(<span class="stringliteral">&quot;Simple: 123&quot;</span> == oss.<a class="code" href="group__bslstl__ostringstream.html#ga23ddb310164dea8c696231517b0e1f5e">str</a>());
      oss.<a class="code" href="group__bslstl__ostringstream.html#ga23ddb310164dea8c696231517b0e1f5e">str</a>(<span class="stringliteral">&quot;&quot;</span>);

      <a class="code" href="classbdlb_1_1NullableValue.html">bdlb::NullableValue&lt;int&gt;</a> nullableInt;

      printCategoryAndValue(oss, nullableInt);
      assert(<span class="stringliteral">&quot;NullableValue: NULL&quot;</span> == oss.<a class="code" href="group__bslstl__ostringstream.html#ga23ddb310164dea8c696231517b0e1f5e">str</a>());
      oss.<a class="code" href="group__bslstl__ostringstream.html#ga23ddb310164dea8c696231517b0e1f5e">str</a>(<span class="stringliteral">&quot;&quot;</span>);

      nullableInt = 321;

      printCategoryAndValue(oss, nullableInt);
      assert(<span class="stringliteral">&quot;NullableValue: 321&quot;</span> == oss.<a class="code" href="group__bslstl__ostringstream.html#ga23ddb310164dea8c696231517b0e1f5e">str</a>());
      oss.<a class="code" href="group__bslstl__ostringstream.html#ga23ddb310164dea8c696231517b0e1f5e">str</a>(<span class="stringliteral">&quot;&quot;</span>);

      <a class="code" href="classbsl_1_1vector.html">bsl::vector&lt;int&gt;</a> vec;

      vec.<a class="code" href="group__bslstl__vector.html#gaa1d6a35af66d87307ee9a48be96644a5">push_back</a>(123);
      vec.<a class="code" href="group__bslstl__vector.html#gaa1d6a35af66d87307ee9a48be96644a5">push_back</a>(345);
      vec.<a class="code" href="group__bslstl__vector.html#gaa1d6a35af66d87307ee9a48be96644a5">push_back</a>(987);

      printCategoryAndValue(oss, vec);
      assert(<span class="stringliteral">&quot;Array: [ 123 345 987 ]&quot;</span> == oss.<a class="code" href="group__bslstl__ostringstream.html#ga23ddb310164dea8c696231517b0e1f5e">str</a>());
  }
</pre></div><br/>
<br/>
 </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="example_2~3A_dynamic_(run-time)_typing"></a> <a class="anchor" id="usage.example_2~3A_dynamic_(run-time)_typing"></a> <a class="anchor" id="description.usage.example_2~3A_dynamic_(run-time)_typing"></a> <a class="anchor" id="example_2"></a> <a class="anchor" id="usage.example_2"></a> <a class="anchor" id="description.usage.example_2"></a> <a class="anchor" id="3.2.2"></a> </dd></dl>
<dl class="user"><dt><b>Example 2: Dynamic (Run-Time) Typing: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The following snippets of code illustrate the usage of dynamic types. Suppose we have a type that can, at runtime, be either a <code><a class="el" href="classbsl_1_1vector.html">bsl::vector</a>&lt;char&gt;</code> or a <code>bsl::string</code>: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keyword">class </span>VectorCharOrString {

      <span class="comment">// PRIVATE DATA MEMBERS</span>
      <a class="code" href="classbsl_1_1vector.html">bsl::vector&lt;char&gt;</a> d_vectorChar;  <span class="comment">// Note: Production code should use a</span>
      <a class="code" href="classbsl_1_1basic__string.html">bsl::string</a>       d_string;      <span class="comment">//       union of object buffers.</span>
      <span class="keywordtype">int</span>               d_selector;    <span class="comment">// 0 = vectorChar, 1 = string</span>

    <span class="keyword">public</span>:
      <span class="comment">// MANIPULATORS</span>
      <span class="keywordtype">void</span> makeVectorChar() { d_selector = 0; }
      <span class="keywordtype">void</span> makeString()     { d_selector = 1; }

      <a class="code" href="classbsl_1_1vector.html">bsl::vector&lt;char&gt;</a>&amp; theVectorChar()
                             { assert(isVectorChar()); <span class="keywordflow">return</span> d_vectorChar; }
      <a class="code" href="classbsl_1_1basic__string.html">bsl::string</a>&amp; theString()
                             { assert(isString()); <span class="keywordflow">return</span> d_string; }

      <span class="comment">// ACCESSORS</span>
      <span class="keywordtype">bool</span> isVectorChar()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0 == d_selector; }
      <span class="keywordtype">bool</span> isString()<span class="keyword"> const     </span>{ <span class="keywordflow">return</span> 1 == d_selector; }

      <span class="keyword">const</span> <a class="code" href="classbsl_1_1vector.html">bsl::vector&lt;char&gt;</a>&amp; theVectorChar()<span class="keyword"> const</span>
<span class="keyword">                             </span>{ assert(isVectorChar()); <span class="keywordflow">return</span> d_vectorChar; }
      <span class="keyword">const</span> <a class="code" href="classbsl_1_1basic__string.html">bsl::string</a>&amp; theString()<span class="keyword"> const</span>
<span class="keyword">                             </span>{ assert(isString()); <span class="keywordflow">return</span> d_string; }

  };
</pre></div><br/>
<br/>
 To make this type dynamic, we will specialize the <code><a class="el" href="structbdlat__TypeCategoryDeclareDynamic.html">bdlat_TypeCategoryDeclareDynamic</a></code> meta-function in the <code><a class="el" href="namespaceBloombergLP.html">BloombergLP</a></code> namespace: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keyword">namespace </span>BloombergLP {

      <span class="keyword">template</span> &lt;&gt;
      <span class="keyword">struct </span><a class="code" href="structbdlat__TypeCategoryDeclareDynamic.html">bdlat_TypeCategoryDeclareDynamic</a>&lt;VectorCharOrString&gt; {
          <span class="keyword">enum</span> { VALUE = 1 };
      };

  }  <span class="comment">// close namespace BloombergLP</span>
</pre></div><br/>
<br/>
 Next, we define bdlat_typeCategorySelect', and a suite of four function, <code>bdlat_typeCategory(Manipulate|Access)(Array|Simple)</code>, each overloaded for our type, <code>VectorCharOrString</code>. <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="structbdlat__TypeCategory.html#aa88b4b41871d022d3308f8bcb7aad86b">bdlat_TypeCategory::Value</a>
  <a class="code" href="namespacebdlat__TypeCategoryFunctions.html#a3ae14654d284d7165dabcda434aa7b8f">bdlat_typeCategorySelect</a>(<span class="keyword">const</span> VectorCharOrString&amp; <span class="keywordtype">object</span>)
  {
      <span class="keywordflow">if</span> (<span class="keywordtype">object</span>.isVectorChar()) {
          <span class="keywordflow">return</span> bdlat_TypeCategory::e_ARRAY_CATEGORY;              <span class="comment">// RETURN</span>
      }
      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keywordtype">object</span>.isString()) {
          <span class="keywordflow">return</span> bdlat_TypeCategory::e_SIMPLE_CATEGORY;             <span class="comment">// RETURN</span>
      }

      assert(0);
      <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="structbdlat__TypeCategory.html#aa88b4b41871d022d3308f8bcb7aad86b">bdlat_TypeCategory::Value</a><span class="keyword">&gt;</span>(-1);
  }

  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> MANIPULATOR&gt;
  <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__TypeCategoryFunctions.html#a2ca07a05b50c39b67dd7effc39d441cb">bdlat_typeCategoryManipulateArray</a>(VectorCharOrString *<span class="keywordtype">object</span>,
                                        MANIPULATOR&amp;        manipulator)
  {
      <span class="keywordflow">if</span> (object-&gt;isVectorChar()) {
          <span class="keywordflow">return</span> manipulator(&amp;object-&gt;theVectorChar(),
                             <a class="code" href="structbdlat__TypeCategory_1_1Array.html">bdlat_TypeCategory::Array</a>());          <span class="comment">// RETURN</span>
      }

      <span class="keywordflow">return</span> manipulator(<span class="keywordtype">object</span>, <a class="code" href="structbslmf_1_1Nil.html">bslmf::Nil</a>());
  }

  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> MANIPULATOR&gt;
  <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__TypeCategoryFunctions.html#a38c38a7d2f426c50f5eec4e509d6c721">bdlat_typeCategoryManipulateSimple</a>(VectorCharOrString *<span class="keywordtype">object</span>,
                                         MANIPULATOR&amp;        manipulator)
  {
      <span class="keywordflow">if</span> (object-&gt;isString()) {
          <span class="keywordflow">return</span> manipulator(&amp;object-&gt;theString(),
                             <a class="code" href="structbdlat__TypeCategory_1_1Simple.html">bdlat_TypeCategory::Simple</a>());         <span class="comment">// RETURN</span>
      }

      <span class="keywordflow">return</span> manipulator(<span class="keywordtype">object</span>, <a class="code" href="structbslmf_1_1Nil.html">bslmf::Nil</a>());
  }

  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ACCESSOR&gt;
  <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__TypeCategoryFunctions.html#a8202dee0ee3cc125b437bea5c282e957">bdlat_typeCategoryAccessArray</a>(<span class="keyword">const</span> VectorCharOrString&amp; <span class="keywordtype">object</span>,
                                    ACCESSOR&amp;                 accessor)
  {
      <span class="keywordflow">if</span> (<span class="keywordtype">object</span>.isVectorChar()) {
          <span class="keywordflow">return</span> accessor(<span class="keywordtype">object</span>.theVectorChar(),
                          <a class="code" href="structbdlat__TypeCategory_1_1Array.html">bdlat_TypeCategory::Array</a>());             <span class="comment">// RETURN</span>
      }

      <span class="keywordflow">return</span> accessor(<span class="keywordtype">object</span>, <a class="code" href="structbslmf_1_1Nil.html">bslmf::Nil</a>());
  }

  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ACCESSOR&gt;
  <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__TypeCategoryFunctions.html#afc7fcde9609f04230cad9893dde7d164">bdlat_typeCategoryAccessSimple</a>(<span class="keyword">const</span> VectorCharOrString&amp; <span class="keywordtype">object</span>,
                                     ACCESSOR&amp;                 accessor)
  {
      <span class="keywordflow">if</span> (<span class="keywordtype">object</span>.isString()) {
          <span class="keywordflow">return</span> accessor(<span class="keywordtype">object</span>.theString(),
                          <a class="code" href="structbdlat__TypeCategory_1_1Simple.html">bdlat_TypeCategory::Simple</a>());            <span class="comment">// RETURN</span>
      }

      <span class="keywordflow">return</span> accessor(<span class="keywordtype">object</span>, <a class="code" href="structbslmf_1_1Nil.html">bslmf::Nil</a>());
  }
</pre></div><br/>
<br/>
 Now we will create an accessor that dumps the contents of the visited object into an associated stream: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keyword">struct </span>DumpObject {
      bsl::ostream *d_stream_p;

      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TYPE&gt;
      <span class="keywordtype">int</span> operator()(<span class="keyword">const</span> TYPE&amp; <span class="keywordtype">object</span>, <a class="code" href="structbslmf_1_1Nil.html">bslmf::Nil</a>)
      {
          assert(0);  <span class="comment">// received invalid object</span>
          <span class="keywordflow">return</span> -1;
      }

      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TYPE&gt;
      <span class="keywordtype">int</span> operator()(<span class="keyword">const</span> TYPE&amp; <span class="keywordtype">object</span>, <a class="code" href="structbdlat__TypeCategory_1_1Array.html">bdlat_TypeCategory::Array</a>)
      {
          (*d_stream_p) &lt;&lt; <span class="stringliteral">&quot;Array = &quot;</span>;
          <a class="code" href="namespacebdlb_1_1PrintMethods.html#a26513ec0b5c4fa7a532923b7bc41ce0b">bdlb::PrintMethods::print</a>(*d_stream_p, <span class="keywordtype">object</span>, 0, -1);
          <span class="keywordflow">return</span> 0;
      }

      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TYPE&gt;
      <span class="keywordtype">int</span> operator()(<span class="keyword">const</span> TYPE&amp; <span class="keywordtype">object</span>, <a class="code" href="structbdlat__TypeCategory_1_1Simple.html">bdlat_TypeCategory::Simple</a>)
      {
          (*d_stream_p) &lt;&lt; <span class="stringliteral">&quot;Simple = &quot;</span>;
          <a class="code" href="namespacebdlb_1_1PrintMethods.html#a26513ec0b5c4fa7a532923b7bc41ce0b">bdlb::PrintMethods::print</a>(*d_stream_p, <span class="keywordtype">object</span>, 0, -1);
          <span class="keywordflow">return</span> 0;
      }
  };
</pre></div><br/>
<br/>
 Now we will use the <code>accessByCategory</code> utility function to invoke the accessor and pick the correct method to invoke based on the runtime state of the <code>VectorCharOrString</code> object: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">void</span> runUsageExample2()
  {
      <a class="code" href="classbsl_1_1basic__ostringstream.html">bsl::ostringstream</a> oss;
      DumpObject         accessor = { &amp;oss };

      VectorCharOrString object;
      <span class="keywordtype">int</span>                ret;

      <span class="keywordtype">object</span>.makeVectorChar();
      <span class="keywordtype">object</span>.theVectorChar().push_back(<span class="charliteral">&#39;H&#39;</span>);
      <span class="keywordtype">object</span>.theVectorChar().push_back(<span class="charliteral">&#39;e&#39;</span>);
      <span class="keywordtype">object</span>.theVectorChar().push_back(<span class="charliteral">&#39;l&#39;</span>);
      <span class="keywordtype">object</span>.theVectorChar().push_back(<span class="charliteral">&#39;l&#39;</span>);
      <span class="keywordtype">object</span>.theVectorChar().push_back(<span class="charliteral">&#39;o&#39;</span>);

      ret = <a class="code" href="structbdlat__TypeCategoryUtil.html#a4d718f66833fde5c5bcb51bf2ad8d06a">bdlat_TypeCategoryUtil::accessByCategory</a>(<span class="keywordtype">object</span>, accessor);
      assert(<span class="stringliteral">&quot;Array = \&quot;Hello\&quot;&quot;</span> == oss.<a class="code" href="group__bslstl__ostringstream.html#ga23ddb310164dea8c696231517b0e1f5e">str</a>());
      oss.<a class="code" href="group__bslstl__ostringstream.html#ga23ddb310164dea8c696231517b0e1f5e">str</a>(<span class="stringliteral">&quot;&quot;</span>);

      <span class="keywordtype">object</span>.makeString();
      <span class="keywordtype">object</span>.theString() = <span class="stringliteral">&quot;World&quot;</span>;

      ret = <a class="code" href="structbdlat__TypeCategoryUtil.html#a4d718f66833fde5c5bcb51bf2ad8d06a">bdlat_TypeCategoryUtil::accessByCategory</a>(<span class="keywordtype">object</span>, accessor);
      assert(<span class="stringliteral">&quot;Simple = World&quot;</span> == oss.<a class="code" href="group__bslstl__ostringstream.html#ga23ddb310164dea8c696231517b0e1f5e">str</a>());
  }
</pre></div><br/>
<br/>
 </dd></dl>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Thu Oct 15 2015 14:33:37 for BDE Release 3.0 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
