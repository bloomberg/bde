<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>BDE 2.23.1 OSS: bslma_testallocator Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <style>
      div.hanging {
        padding-left: 0.75in;
        text-indent: -0.50in;
      }
      div.unhanging {
        text-indent:     0in;
      }
      a.glossary {
        font-weight: bold;
        font-style: italic;
      }
    </style>
</head>
<!--
<body onload='searchBox.OnSelectItem(0);'>
-->
<body>

<table border=2 cellspacing=0 cellpadding=0 align=center>
<tr>
 <td valign=top align=center>
 <p align=center><b><i>Quick Links:</i></b></p>
 </td>
 <td valign=top align=center>
 <p align=center>
<a class="qindex" href="group__bdl.html" target="_blank">bdl</a> | <a class="qindex" href="group__bsl.html" target="_blank">bsl</a>
 </td>
 </tr>
 </table>

  </div>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="components.html"><span>Components</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#define-members">Defines</a>  </div>
  <div class="headertitle">
<h1>Component bslma_testallocator<br/>
<small>
[<a class="el" href="group__bslma.html">Package bslma</a>]</small>
</h1>  </div>
</div>
<div class="contents">

<p>Provide instrumented malloc/free allocator to track memory usage.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebslma.html">bslma</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bslma__testallocator.html#ga9eaafce464ba91b898a703ad6d15cffe">BSLMA_EXCEPTION_TEST_WORKAROUND</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bslma__testallocator.html#ga54aebaa251b957630708f5f491fcadd3">BSLMA_TESTALLOCATOR_EXCEPTION_TEST_BEGIN</a>(BSLMA_TESTALLOCATOR)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bslma__testallocator.html#ga59220055a07373b5ed62d98ec6206523">BSLMA_TESTALLOCATOR_EXCEPTION_TEST_END</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="user"><dt><b>Outline</b></dt><dd><ul>
<li>
<a href="#1">Purpose</a> </li>
<li>
<a href="#2">Classes</a> </li>
<li>
<a href="#3">Macros</a> </li>
<li>
<a href="#4">Description</a> <ul>
<li>
<a href="#4.1">Modes</a> </li>
<li>
<a href="#4.2">Allocation Limit</a> </li>
<li>
<a href="#4.3">Exception Test Macros</a> </li>
<li>
<a href="#4.4">Thread Safety</a> </li>
<li>
<a href="#4.5">Usage</a> </li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="purpose"></a> <a class="anchor" id="1"></a> </dd></dl>
<dl class="user"><dt><b>Purpose: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Provide instrumented malloc/free allocator to track memory usage. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="classes"></a> <a class="anchor" id="2"></a> </dd></dl>
<dl class="user"><dt><b>Classes: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><table class="doxtable">
<tr>
<td><a class="el" href="classbslma_1_1TestAllocator.html">bslma::TestAllocator</a> </td><td>instrumented <code>malloc</code>/<code>free</code> memory allocator  </td></tr>
</table>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="macros"></a> <a class="anchor" id="3"></a> </dd></dl>
<dl class="user"><dt><b>Macros: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><table class="doxtable">
<tr>
<td>BSLMA_TESTALLOCATOR_EXCEPTION_TEST_BEGIN </td><td>macro to begin testing exceptions  </td></tr>
<tr>
<td>BSLMA_TESTALLOCATOR_EXCEPTION_TEST_END </td><td>macro to end testing exceptions  </td></tr>
</table>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__bslma__newdeleteallocator.html" title="Provide singleton new/delete adaptor to bslma::Allocator protocol.">Component bslma_newdeleteallocator</a>, <a class="el" href="group__bslma__mallocfreeallocator.html" title="Provide malloc/free adaptor to bslma::Allocator protocol.">Component bslma_mallocfreeallocator</a> </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="description"></a> <a class="anchor" id="4"></a> </dd></dl>
<dl class="user"><dt><b>Description: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This component provides an instrumented allocator, <code><a class="el" href="classbslma_1_1TestAllocator.html">bslma::TestAllocator</a></code>, that implements the <code><a class="el" href="classbslma_1_1Allocator.html">bslma::Allocator</a></code> protocol and can be used to track various aspects of memory allocated from it. Available statistics include the number of outstanding blocks (and bytes) that are currently in use, the cumulative number of blocks (and bytes) that have been allocated, and the maximum number of blocks (and bytes) that have been in use at any one time. A <code>print</code> function formats these values to <code>stdout</code>: <br/>
<br/>
<div class="fragment"><pre class="fragment">   ,--------------------.
  ( <a class="code" href="classbslma_1_1TestAllocator.html">bslma::TestAllocator</a> )
   `--------------------<span class="stringliteral">&#39;</span>
<span class="stringliteral">             |         ctor/dtor</span>
<span class="stringliteral">             |         lastAllocatedAddress/lastDeallocatedAddress</span>
<span class="stringliteral">             |         lastAllocatedNumBytes/lastDeallocatedNumBytes</span>
<span class="stringliteral">             |         numAllocations/numDeallocations</span>
<span class="stringliteral">             |         numBlocksInUse/numBlocksMax/numBlocksTotal</span>
<span class="stringliteral">             |         numBytesInUse/numBytesMax/numBytesTotal</span>
<span class="stringliteral">             |         numMismatches/numBoundsErrors</span>
<span class="stringliteral">             |         print/name</span>
<span class="stringliteral">             |         setAllocationLimit/allocationLimit</span>
<span class="stringliteral">             |         setNoAbort/isNoAbort</span>
<span class="stringliteral">             |         setQuiet/isQuiet</span>
<span class="stringliteral">             |         setVerbose/isVerbose</span>
<span class="stringliteral">             |         status</span>
<span class="stringliteral">             V</span>
<span class="stringliteral">     ,----------------.</span>
<span class="stringliteral">    ( bslma::Allocator )</span>
<span class="stringliteral">     `----------------&#39;</span>
                       allocate
                       deallocate
</pre></div><br/>
<br/>
 If exceptions are enabled, this allocator can be configured to throw an exception after the number of allocation requests exceeds some specified limit (see the subsection on "Allocation Limit" below). The level of verbosity can also be adjusted. Each allocator object also maintains a current status. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>By default this allocator gets its memory from the C Standard Library functions <code>malloc</code> and <code>free</code>, but can be overridden to take memory from any thread-safe allocator (supplied at construction) that implements the <code><a class="el" href="classbslma_1_1Allocator.html">bslma::Allocator</a></code> protocol. Note that allocation and deallocation using a <code><a class="el" href="classbslma_1_1TestAllocator.html">bslma::TestAllocator</a></code> object is explicitly incompatible with <code>malloc</code> and <code>free</code> (or any other allocation mechanism). Attempting to use <code>free</code> to deallocate memory allocated from a <code><a class="el" href="classbslma_1_1TestAllocator.html">bslma::TestAllocator</a></code> -- even when <code>malloc</code> and <code>free</code> are used by default -- will result in undefined behavior, almost certainly corrupting the C Standard Library's runtime memory manager. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Memory dispensed from a <code><a class="el" href="classbslma_1_1TestAllocator.html">bslma::TestAllocator</a></code> is marked such that attempting to deallocate previously unallocated (or already deallocated) memory will (with high probability) be flagged as an error (unless quiet mode is set for the purpose of testing the test allocator itself). A <code><a class="el" href="classbslma_1_1TestAllocator.html">bslma::TestAllocator</a></code> also supports a buffer overrun / underrun feature -- each allocation has "pads", areas of extra memory before and after the segment which are initialized to a particular value and checked upon deallocation to see if they have been modified. If they have, a message is printed and the allocator aborts, unless it is in quiet mode. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="modes"></a> <a class="anchor" id="description.modes"></a> <a class="anchor" id="4.1"></a> </dd></dl>
<dl class="user"><dt><b>Modes: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The test allocator's behavior is controlled by three basic <em>mode</em> flags: </dd></dl>
<dl class="user"><dt><b></b></dt><dd>VERBOSE MODE: (Default 0) Specifies that each allocation and deallocation should be printed to standard output. In verbose mode all state variables will be displayed at destruction. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>QUIET MODE: (Default 0) Specifies that mismatched memory and memory leaks should <em>not</em> be reported, and should not cause the process to terminate when detected. Note that this mode is used primarily for testing the test allocator itself; behavior that would otherwise abort now quietly increments the <code>numMismatches</code> and <code>numBoundsErrors</code> counter. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>NO-ABORT MODE: (Default 0) Specifies that the test allocator should not invoke <code>abort</code> under any circumstances without suppressing diagnostics. Although the internal state values are independent, quiet mode implies the behavior of no-abort mode in all cases. Note that this mode is used primarily for visual inspection of unusual error diagnostics in this component's test driver (in non-quiet mode only). </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Taking the default mode settings, memory allocation/deallocation will not be displayed individually. However, in the event of a mismatched deallocation or a memory leak, the problem will be announced, any relevant state of the object will be displayed, and the program will abort. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>The three modes are independently set using the <code>setVerbose</code>, <code>setQuiet</code>, and <code>setNoAbort</code> manipulators. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="allocation_limit"></a> <a class="anchor" id="description.allocation_limit"></a> <a class="anchor" id="4.2"></a> </dd></dl>
<dl class="user"><dt><b>Allocation Limit: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>If exceptions are enabled at compile time, the test allocator can be configured to throw a <code><a class="el" href="classbslma_1_1TestAllocatorException.html">bslma::TestAllocatorException</a></code> after a specified number of allocation requests is exceeded. If the allocation limit is less than 0 (default), then the allocator won't throw a <code>TestAllocatorException</code> exception. Note that a non-negative allocation limit is decremented after each allocation attempt, and an exception is thrown only when the current allocation limit transitions from 0 to -1; no additional exceptions will be thrown until the allocation limit is again reset to a non-negative value. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>The allocation limit is set using the <code>setAllocationLimit</code> manipulator. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="exception_test_macros"></a> <a class="anchor" id="description.exception_test_macros"></a> <a class="anchor" id="4.3"></a> </dd></dl>
<dl class="user"><dt><b>Exception Test Macros: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This component also provides a pair of macros: <br/>
<br/>
<div class="fragment"><pre class="fragment"> &lt;ul&gt;
 &lt;li&gt;
 <a class="code" href="group__bslma__testallocator.html#ga54aebaa251b957630708f5f491fcadd3">BSLMA_TESTALLOCATOR_EXCEPTION_TEST_BEGIN</a>(BSLMA_TESTALLOCATOR)
 &lt;/li&gt;
 &lt;li&gt;
 <a class="code" href="group__bslma__testallocator.html#ga59220055a07373b5ed62d98ec6206523">BSLMA_TESTALLOCATOR_EXCEPTION_TEST_END</a>
 &lt;/li&gt;
 &lt;/ul&gt;
</pre></div><br/>
<br/>
 These macros can be used for testing exception-safety of classes and their methods when memory allocation is needed. A reference to an object of type <code><a class="el" href="classbslma_1_1TestAllocator.html">bslma::TestAllocator</a></code> must be supplied as an argument to the <code>_BEGIN</code> macro. Note that if exception-handling is disabled (i.e., if <code>BDE_BUILD_TARGET_EXC</code> is not defined when building the code under test), then the macros simply print the following: <br/>
<br/>
<div class="fragment"><pre class="fragment">  BSLMA EXCEPTION TEST -- (NOT ENABLED) --
</pre></div><br/>
<br/>
 When exception-handling is enabled, the <code>_BEGIN</code> macro will set the allocation limit of the supplied allocator to 0, <code>try</code> the code being tested, <code>catch</code> any <code>TestAllocatorException</code>s that are thrown, and keep increasing the allocation limit until the code being tested completes successfully. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="thread_safety"></a> <a class="anchor" id="description.thread_safety"></a> <a class="anchor" id="4.4"></a> </dd></dl>
<dl class="user"><dt><b>Thread Safety: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The <code><a class="el" href="classbslma_1_1TestAllocator.html">bslma::TestAllocator</a></code> class is fully thread-safe (see <code>bsldoc_glossary</code>) provided that the allocator supplied at construction (if any) is fully thread-safe. Note that the <code><a class="el" href="classbslma_1_1MallocFreeAllocator.html">bslma::MallocFreeAllocator</a></code> singleton (the allocator used by the test allocator if none is supplied at construction) is fully thread-safe. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="usage"></a> <a class="anchor" id="description.usage"></a> <a class="anchor" id="4.5"></a> </dd></dl>
<dl class="user"><dt><b>Usage: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The <code><a class="el" href="classbslma_1_1TestAllocator.html">bslma::TestAllocator</a></code> defined in this component can be used in conjunction with the <code>BSLMA_TESTALLOCATOR_EXCEPTION_TEST_BEGIN</code> and <code>BSLMA_TESTALLOCATOR_EXCEPTION_TEST_END</code> macros to test the memory usage patterns of an object that uses the <code><a class="el" href="classbslma_1_1Allocator.html">bslma::Allocator</a></code> protocol in its interface. In this example, we illustrate how we might test that an object under test is exception-neutral. For illustration purposes, we will assume the existence of a <code>my_shortarray</code> component implementing an <code>std::vector</code>-like array type, <code>myShortArray</code>: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="comment">// my_shortarray.t.cpp</span>
<span class="preprocessor">  #include &lt;my_shortarray.h&gt;</span>

<span class="preprocessor">  #include &lt;<a class="code" href="bslma__testallocator_8h.html" title="Provide instrumented malloc/free allocator to track memory usage.">bslma_testallocator.h</a>&gt;</span>
<span class="preprocessor">  #include &lt;<a class="code" href="bslma__testallocatorexception_8h.html" title="Provide an exception class for memory allocation operations.">bslma_testallocatorexception.h</a>&gt;</span>

  <span class="comment">// ...</span>
</pre></div><br/>
<br/>
 Below we provide a <code>static</code> function, <code>areEqual</code>, that will allow us to compare two short arrays: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keyword">static</span>
  <span class="keywordtype">bool</span> areEqual(<span class="keyword">const</span> <span class="keywordtype">short</span> *array1, <span class="keyword">const</span> <span class="keywordtype">short</span> *array2, <span class="keywordtype">int</span> numElements)
      <span class="comment">// Return &#39;true&#39; if the specified initial &#39;numElements&#39; in the</span>
      <span class="comment">// specified &#39;array1&#39; and &#39;array2&#39; have the same values, and &#39;false&#39;</span>
      <span class="comment">// otherwise.</span>
  {
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numElements; ++i) {
          <span class="keywordflow">if</span> (array1[i] != array2[i]) {
              <span class="keywordflow">return</span> <span class="keyword">false</span>;                                         <span class="comment">// RETURN</span>
          }
      }
      <span class="keywordflow">return</span> <span class="keyword">true</span>;
  }

  <span class="comment">// ...</span>
</pre></div><br/>
<br/>
 The following is an abbreviated standard test driver. Note that the number of arguments specify the verbosity level that the test driver uses for printing messages: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])
  {
      <span class="keywordtype">int</span>                 test = argc &gt; 1 ? atoi(argv[1]) : 0;
      <span class="keywordtype">bool</span>             verbose = argc &gt; 2;
      <span class="keywordtype">bool</span>         veryVerbose = argc &gt; 3;
      <span class="keywordtype">bool</span>     veryVeryVerbose = argc &gt; 4;
      <span class="keywordtype">bool</span> veryVeryVeryVerbose = argc &gt; 5;
</pre></div><br/>
<br/>
 We now define a <code><a class="el" href="classbslma_1_1TestAllocator.html">bslma::TestAllocator</a></code>, <code>sa</code>, named "supplied" to indicate that it is the allocator to be supplied to our object under test, as well as to the <code>BSLMA_TESTALLOCATOR_EXCEPTION_TEST_BEGIN</code> macro (below). Note that if <code>veryVeryVeryVerbose</code> is <code>true</code>, then <code>sa</code> prints all allocation and deallocation requests to <code>stdout</code> and also prints the accumulated statistics on destruction: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbslma_1_1TestAllocator.html">bslma::TestAllocator</a> sa(<span class="stringliteral">&quot;supplied&quot;</span>, veryVeryVeryVerbose);

  <span class="keywordflow">switch</span> (test) { <span class="keywordflow">case</span> 0:

    <span class="comment">// ...</span>

    <span class="keywordflow">case</span> 6: {

      <span class="comment">// ...</span>

      <span class="keyword">struct </span>{
          <span class="keywordtype">int</span>   d_line;
          <span class="keywordtype">int</span>   d_numElem;
          <span class="keywordtype">short</span> d_exp[NUM_VALUES];
      } DATA[] = {
          { L_, 0, { } },
          { L_, 1, { V0 } },
          { L_, 5, { V0, V1, V2, V3, V4 } }
      };
      <span class="keyword">const</span> <span class="keywordtype">int</span> NUM_DATA = <span class="keyword">sizeof</span> DATA / <span class="keyword">sizeof</span> *DATA;

      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ti = 0; ti &lt; NUM_DATA; ++ti) {
          <span class="keyword">const</span> <span class="keywordtype">int</span>    LINE     = DATA[ti].d_line;
          <span class="keyword">const</span> <span class="keywordtype">int</span>    NUM_ELEM = DATA[ti].d_numElem;
          <span class="keyword">const</span> <span class="keywordtype">short</span> *EXP      = DATA[ti].d_exp;

          <span class="keywordflow">if</span> (veryVerbose) { T_ P_(ti) P_(NUM_ELEM) }

          <span class="comment">// ...</span>
</pre></div><br/>
<br/>
 All code that we want to test for exception-safety must be enclosed within the <code>BSLMA_TESTALLOCATOR_EXCEPTION_TEST_BEGIN</code> and <code>BSLMA_TESTALLOCATOR_EXCEPTION_TEST_END</code> macros, which internally implement a <code>do</code>-'while' loop. Code provided by the <code>BSLMA_TESTALLOCATOR_EXCEPTION_TEST_BEGIN</code> macro sets the allocation limit of the supplied allocator to 0 causing it to throw an exception on the first allocation. This exception is caught by code provided by the <code>BSLMA_TESTALLOCATOR_EXCEPTION_TEST_END</code> macro, which increments the allocation limit by 1 and re-runs the same code again. Using this scheme we can check that our code does not leak memory for any memory allocation request. Note that the curly braces surrounding these macros, although visually appealing, are not technically required: <br/>
<br/>
<div class="fragment"><pre class="fragment">      <a class="code" href="group__bslma__testallocator.html#ga54aebaa251b957630708f5f491fcadd3">BSLMA_TESTALLOCATOR_EXCEPTION_TEST_BEGIN</a>(sa) {
        my_ShortArray mA(&amp;sa);
        <span class="keyword">const</span> my_ShortArray&amp; A = mA;
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ei = 0; ei &lt; NUM_ELEM; ++ei) {
            mA.append(VALUES[ei]);
        }
        <span class="keywordflow">if</span> (veryVerbose) { T_ T_  P_(NUM_ELEM) P(A) }
        LOOP_ASSERT(LINE, areEqual(EXP, A, NUM_ELEM));
      } <a class="code" href="group__bslma__testallocator.html#ga59220055a07373b5ed62d98ec6206523">BSLMA_TESTALLOCATOR_EXCEPTION_TEST_END</a>
  }
</pre></div><br/>
<br/>
 After the exception-safety test we can ensure that all the memory allocated from <code>sa</code> was successfully deallocated: <br/>
<br/>
<div class="fragment"><pre class="fragment">          <span class="keywordflow">if</span> (veryVerbose) sa.print();

        } <span class="keywordflow">break</span>;

        <span class="comment">// ...</span>

      }

      <span class="comment">// ...</span>
  }
</pre></div><br/>
<br/>
 Note that the <code>BDE_BUILD_TARGET_EXC</code> macro is defined at compile-time to indicate whether or not exceptions are enabled. </dd></dl>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ga9eaafce464ba91b898a703ad6d15cffe"></a><!-- doxytag: member="bslma_testallocator.h::BSLMA_EXCEPTION_TEST_WORKAROUND" ref="ga9eaafce464ba91b898a703ad6d15cffe" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSLMA_EXCEPTION_TEST_WORKAROUND</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ga54aebaa251b957630708f5f491fcadd3"></a><!-- doxytag: member="bslma_testallocator.h::BSLMA_TESTALLOCATOR_EXCEPTION_TEST_BEGIN" ref="ga54aebaa251b957630708f5f491fcadd3" args="(BSLMA_TESTALLOCATOR)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSLMA_TESTALLOCATOR_EXCEPTION_TEST_BEGIN</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">BSLMA_TESTALLOCATOR</td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{                                                                           \
    <span class="keyword">static</span> <span class="keywordtype">int</span> firstTime = 1;                                               \
    <span class="keywordflow">if</span> (verbose &amp;&amp; firstTime) {                                             \
        std::puts(<span class="stringliteral">&quot;\t\tBSLMA EXCEPTION TEST -- (NOT ENABLED) --&quot;</span>);          \
        firstTime = 0;                                                      \
    }                                                                       \
}
</pre></div>
</div>
</div>
<a class="anchor" id="ga59220055a07373b5ed62d98ec6206523"></a><!-- doxytag: member="bslma_testallocator.h::BSLMA_TESTALLOCATOR_EXCEPTION_TEST_END" ref="ga59220055a07373b5ed62d98ec6206523" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSLMA_TESTALLOCATOR_EXCEPTION_TEST_END</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Jun 2 2015 13:40:21 for BDE Release 2.23.1 OSS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
