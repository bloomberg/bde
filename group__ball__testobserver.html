<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>BDE 3.0: ball_testobserver Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <style>
      div.hanging {
        padding-left: 0.75in;
        text-indent: -0.50in;
      }
      div.unhanging {
        text-indent:     0in;
      }
      a.glossary {
        font-weight: bold;
        font-style: italic;
      }
    </style>
</head>
<!--
<body onload='searchBox.OnSelectItem(0);'>
-->
<body>

<table border=2 cellspacing=0 cellpadding=0 align=center>
<tr>
 <td valign=top align=center>
 <p align=center><b><i>Quick Links:</i></b></p>
 </td>
 <td valign=top align=center>
 <p align=center>
<a class="qindex" href="group__bal.html" target="_blank">bal</a> | <a class="qindex" href="group__bbl.html" target="_blank">bbl</a> | <a class="qindex" href="group__bdl.html" target="_blank">bdl</a> | <a class="qindex" href="group__bsl.html" target="_blank">bsl</a> | <a class="qindex" href="group__btl.html" target="_blank">btl</a>
 </td>
 </tr>
 </table>

  </div>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="components.html"><span>Components</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<h1>Component ball_testobserver<br/>
<small>
[<a class="el" href="group__ball.html">Package ball</a>]</small>
</h1>  </div>
</div>
<div class="contents">

<p>Provide an instrumented observer for testing.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceball.html">ball</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="user"><dt><b>Outline</b></dt><dd><ul>
<li>
<a href="#1">Purpose</a> </li>
<li>
<a href="#2">Classes</a> </li>
<li>
<a href="#3">Description</a> <ul>
<li>
<a href="#3.1">Thread Safety</a> </li>
<li>
<a href="#3.2">Verbose Mode</a> </li>
<li>
<a href="#3.3">Usage</a> <ul>
<li>
<a href="#3.3.1">Example 1: Basic Usage</a> </li>
</ul>
</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="purpose"></a> <a class="anchor" id="1"></a> </dd></dl>
<dl class="user"><dt><b>Purpose: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Provide an instrumented observer for testing. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="classes"></a> <a class="anchor" id="2"></a> </dd></dl>
<dl class="user"><dt><b>Classes: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><table class="doxtable">
<tr>
<td><a class="el" href="classball_1_1TestObserver.html">ball::TestObserver</a> </td><td>instrumented observer for testing  </td></tr>
</table>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__ball__record.html" title="Provide a container for all fields of a log record.">Component ball_record</a>, <a class="el" href="group__ball__context.html" title="Provide a container for the context of a transmitted log record.">Component ball_context</a>, <a class="el" href="group__ball__observer.html" title="Define a protocol for receiving and processing log records.">Component ball_observer</a> </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="description"></a> <a class="anchor" id="3"></a> </dd></dl>
<dl class="user"><dt><b>Description: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This component provides a concrete implementation of the <code><a class="el" href="classball_1_1Observer.html">ball::Observer</a></code> protocol, <code><a class="el" href="classball_1_1TestObserver.html">ball::TestObserver</a></code>, that is instrumented for testing systems that use <code><a class="el" href="classball_1_1Observer.html">ball::Observer</a></code> objects. <br/>
<br/>
<div class="fragment"><pre class="fragment">                   ( <a class="code" href="classball_1_1TestObserver.html">ball::TestObserver</a> )
                            |             <span class="keyword">static</span> numInstances
                            |             ctor
                            |             setVerbose
                            |             <span class="keywordtype">id</span>
                            |             numPublishedRecords
                            |             lastPublishedRecord
                            |             lastPublishedContext
                            <a class="code" href="bdlf__bind__test_8h.html#ad98bc55172072c2c874bcdfbace3ad22">V</a>
                    ( <a class="code" href="classball_1_1Observer.html">ball::Observer</a> )
                                          dtor
                                          publish
</pre></div><br/>
<br/>
 <code><a class="el" href="classball_1_1TestObserver.html">ball::TestObserver</a></code> ascribes to each instance (within a process) a unique integer identifier (accessible via the <code>id</code> method), and each instance keeps a count of the total number of records that it has published (accessible via the <code>numPublishedRecords</code> method). In addition, the test observer maintains a copy of the record and context data from the most recent call to <code>publish</code>; that information is available via the accessors <code>lastPublishedRecord</code> and <code>lastPublishedContext</code>. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="thread_safety"></a> <a class="anchor" id="description.thread_safety"></a> <a class="anchor" id="3.1"></a> </dd></dl>
<dl class="user"><dt><b>Thread Safety: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The <code><a class="el" href="classball_1_1TestObserver.html">ball::TestObserver</a></code> provides a <code>publish</code> method that is <em>thread-safe</em>, meaning that the test observer may be used to log records from multiple threads. However, the <code><a class="el" href="classball_1_1TestObserver.html">ball::TestObserver</a></code> accessors <code>lastPublished</code> method and <code>lastPublishedContext</code> provide references to internal data structures (for backwards compatibilty) and are therefore <em>not</em> <em>thread-safe</em>. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="verbose_mode"></a> <a class="anchor" id="description.verbose_mode"></a> <a class="anchor" id="3.2"></a> </dd></dl>
<dl class="user"><dt><b>Verbose Mode: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The <code>publish</code> method, in addition to making a local copy of the published data for future inspection, is capable of printing an appropriate diagnostic message to the <code>ostream</code> held by the test observer instance. By default, this printing is suppressed, but the behavior can be altered by calling the <code>setVerbose</code> method. A call to <code>setVerbose</code> with a non-zero argument (e.g., <code>setVerbose(1)</code>) places the object in verbose mode, which enables diagnostic printing. A subsequent call of <code>setVerbose(0)</code> restores the default "quiet" behavior. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="usage"></a> <a class="anchor" id="description.usage"></a> <a class="anchor" id="3.3"></a> </dd></dl>
<dl class="user"><dt><b>Usage: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This section illustrates intended use of this component. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="example_1~3A_basic_usage"></a> <a class="anchor" id="usage.example_1~3A_basic_usage"></a> <a class="anchor" id="description.usage.example_1~3A_basic_usage"></a> <a class="anchor" id="example_1"></a> <a class="anchor" id="usage.example_1"></a> <a class="anchor" id="description.usage.example_1"></a> <a class="anchor" id="3.3.1"></a> </dd></dl>
<dl class="user"><dt><b>Example 1: Basic Usage: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The following snippets of code illustrate the basic usage of testing observer objects. The example focuses on the individual features that are useful for testing larger systems (not shown) that use observers derived from <code><a class="el" href="classball_1_1Observer.html">ball::Observer</a></code>. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>First create a <code><a class="el" href="classball_1_1Record.html">ball::Record</a></code> object <code>record</code> and a <code><a class="el" href="classball_1_1Context.html">ball::Context</a></code> object <code>context</code>. Note that the default values for these objects (or their contained objects) are perfectly suitable for testing purposes, since the testing observer's purpose is simply to report what has been presented to its <code>publish</code> method. <br/>
<br/>
<div class="fragment"><pre class="fragment">     <a class="code" href="classball_1_1RecordAttributes.html">ball::RecordAttributes</a> attributes;
     <a class="code" href="classball_1_1UserFields.html">ball::UserFields</a>       list;
     <a class="code" href="classball_1_1Record.html">ball::Record</a>           record(attributes, list);
     <a class="code" href="classball_1_1Context.html">ball::Context</a>          context;
</pre></div><br/>
<br/>
 Next, create three test observers <code>to1</code>, to2', and <code>to3</code>, each with <code>bsl::cout</code> as the held stream. Note that each instance will be given a unique integer identifier by the constructor. <br/>
<br/>
<div class="fragment"><pre class="fragment">                                         assert(0 == <a class="code" href="classball_1_1TestObserver.html">ball::TestObserver</a>::
                                                             numInstances());
     <a class="code" href="classball_1_1TestObserver.html">ball::TestObserver</a> to1(bsl::cout);  assert(1 == to1.id());
                                         assert(1 == <a class="code" href="classball_1_1TestObserver.html">ball::TestObserver</a>::
                                                             numInstances());
     <a class="code" href="classball_1_1TestObserver.html">ball::TestObserver</a> to2(bsl::cout);  assert(2 == to2.id());
                                         assert(2 == <a class="code" href="classball_1_1TestObserver.html">ball::TestObserver</a>::
                                                             numInstances());
     <a class="code" href="classball_1_1TestObserver.html">ball::TestObserver</a> to3(bsl::cout);  assert(3 == to3.id());
                                         assert(3 == <a class="code" href="classball_1_1TestObserver.html">ball::TestObserver</a>::
                                                             numInstances());

                                      assert(0 == to1.numPublishedRecords());
                                      assert(0 == to2.numPublishedRecords());
                                      assert(0 == to3.numPublishedRecords());
</pre></div><br/>
<br/>
 Finally, set <code>to1</code> to "verbose mode" and publish <code>record</code> and <code>context</code> to <code>to1</code> and also to <code>to2</code>, but not to <code>to3</code>. <br/>
<br/>
<div class="fragment"><pre class="fragment">     to1.setVerbose(1);
     to1.publish(record, context);  assert(1 == to1.numPublishedRecords());
     to2.publish(record, context);  assert(1 == to2.numPublishedRecords());
                                    assert(0 == to3.numPublishedRecords());
</pre></div><br/>
<br/>
 This will produce the following output on <code>stdout</code>: <br/>
<br/>
<div class="fragment"><pre class="fragment">     Test Observer ID 1 publishing record number 1
     Context: cause = PASSTHROUGH
              count = 1  of an expected 1 total records
</pre></div><br/>
<br/>
 Note that <code>to2</code> produces no output, although its <code>publish</code> method executed (as verified by the <code>numPublishedRecords</code> method); only <code>to1</code> produces a printed output, because it has been set to verbose mode. </dd></dl>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Apr 1 2016 16:48:26 for BDE Release 3.0 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
