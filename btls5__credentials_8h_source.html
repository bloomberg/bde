<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<title>BDE 3.0</title>
<html>
<pre>
// btls5_credentials.h                                                -*-C++-*-

// ----------------------------------------------------------------------------
//                                   NOTICE
//
// This component is not up to date with current BDE coding standards, and
// should not be used as an example for new development.
// ----------------------------------------------------------------------------

#ifndef INCLUDED_BTLS5_CREDENTIALS
#define INCLUDED_BTLS5_CREDENTIALS

#ifndef INCLUDED_BSLS_IDENT
#include &lt;bsls_ident.h&gt;
#endif
BSLS_IDENT(&quot;$Id: $&quot;)

//@PURPOSE: Provide a class for describing SOCKS5 authentication credentials.
//
//@CLASSES:
//  btls5::Credentials: describe SOCKS5 authentication credentials
//
//@SEE_ALSO: btls5_negotiator
//
//@DESCRIPTION: This component provides a single, complex-constrained
// (value-semantic) attribute class, &#39;btls5::Credentials&#39;, that is used to
// describe user credentials used to authenticate a connection with a SOCSK5
// proxy using the &quot;Username/Password&quot; method as defined in RFC 1929.
//
///Attributes
///----------
//..
//  Name                Type         Default  Constraints
//  ------------------  -----------  -------  -----------
//  username            bsl::string  &quot;&quot;       empty or 1-255 characters long
//  password            bsl::string  &quot;&quot;       empty or 1-255 characters long
//..
//: o &#39;username&#39;: username, empty or 1 to 255 octets
//: o &#39;password&#39;: the password associated with &#39;username&#39;, 1 to 255 octets
//
// A &#39;btls5::Credentials&#39; can be either in the default constructed state with
// both &#39;username&#39; and &#39;password&#39; empty, or with both attributes at least 1 and
// at most 255 characters in length.
//
///Usage
///-----
// This section illustrates intended use of this component.
//
///Example 1: Assign Username and Password
///- - - - - - - - - - - - - - - - - - - -
// Suppose that we want to specify username and password for authenticating
// with a SOCKS5 host (see RFC 1929).  We can use a &#39;btls5::Credentials&#39; object
// to represent the credentials.
//
// First, we construct an empty object:
//..
//  btls5::Credentials credentials;
//..
// Now, we set the username and password passing in literals:
//..
//  credentials.set(&quot;john.smith&quot;, &quot;pass1&quot;);
//..
// Finally, we verify that &#39;credentials&#39; is no longer empty, and its username
// and password values have been assigned the expected values:
//..
//  assert(credentials.username() == &quot;john.smith&quot;);
//  assert(credentials.password() == &quot;pass1&quot;);
//..

#ifndef INCLUDED_BTLSCM_VERSION
#include &lt;btlscm_version.h&gt;
#endif

#ifndef INCLUDED_BSLALG_SWAPUTIL
#include &lt;bslalg_swaputil.h&gt;
#endif

#ifndef INCLUDED_BSLMA_ALLOCATOR
#include &lt;bslma_allocator.h&gt;
#endif

#ifndef INCLUDED_BSLMA_USESBSLMAALLOCATOR
#include &lt;bslma_usesbslmaallocator.h&gt;
#endif

#ifndef INCLUDED_BSLS_ASSERT
#include &lt;bsls_assert.h&gt;
#endif

#ifndef INCLUDED_BSL_IOSFWD
#include &lt;bsl_iosfwd.h&gt;
#endif

#ifndef INCLUDED_BSL_STRING
#include &lt;bsl_string.h&gt;
#endif

namespace BloombergLP {

namespace bslma { class Allocator; }

namespace btls5 {
                             // =================
                             // class Credentials
                             // =================

class Credentials {
    // This complex-constrained (value-semantic) type describes the username
    // and password for SOCKS5 authentication per RFC 1929.

    // DATA
    bsl::string d_username;  // authentication username
    bsl::string d_password;  // authentication password

  public:
    // CREATORS
    explicit Credentials(bslma::Allocator *basicAllocator = 0);
        // Create a &#39;Credentials&#39; object having the (default) attribute
        // values:
        //..
        //  username() == &quot;&quot;
        //  password() == &quot;&quot;
        //..
        // Optionally specify a &#39;basicAllocator&#39; used to supply memory.  If
        // &#39;basicAllocator&#39; is 0, the currently installed default allocator is
        // used.

    Credentials(const bslstl::StringRef&amp;  username,
                const bslstl::StringRef&amp;  password,
                bslma::Allocator         *basicAllocator = 0);
        // Create a &#39;Credentials&#39; object having the specified &#39;username&#39; and
        // &#39;password&#39;.  Optionally specify a &#39;basicAllocator&#39; used to supply
        // memory.  If &#39;basicAllocator&#39; is 0, the currently installed default
        // allocator is used.  The behavior is undefined unless both &#39;username&#39;
        // and &#39;password&#39; are empty, or the lengths of both &#39;username&#39; and
        // &#39;password&#39; are between 1 and 255 characters inclusive.

    Credentials(const Credentials&amp;  original,
                bslma::Allocator   *basicAllocator = 0);
        // Create a &#39;Credentials&#39; object having the same value as the specified
        // &#39;original&#39; object.  Optionally specify a &#39;basicAllocator&#39; used to
        // supply memory.  If &#39;basicAllocator&#39; is 0, the currently installed
        // default allocator is used.

    //! ~Credentials() = default;
        // Destroy this object.

    // MANIPULATORS
    //! Credentials&amp; operator=(const Credentials&amp; rhs) = default;
        // Assign to this object the value of the specified &#39;rhs&#39; object, and
        // return a reference providing modifiable access to this object.

    void set(const bslstl::StringRef&amp; username,
             const bslstl::StringRef&amp; password);
        // Set the attributes of this object to the specified &#39;username&#39; and
        // &#39;password&#39;.  The behavior is undefined unless both &#39;username&#39; and
        // &#39;password&#39; are empty, or the lengths of both &#39;username&#39; and
        // &#39;password&#39; are between 1 and 255 characters inclusive.

                                  // Aspects

    void swap(Credentials&amp; other);
        // Efficiently exchange the value of this object with the value of the
        // specified &#39;other&#39; object.  This method provides the no-throw
        // exception-safety guarantee.  The behavior is undefined unless this
        // object was created with the same allocator as &#39;other&#39;.

    // ACCESSORS
    const bsl::string&amp; username() const;
        // Return a reference providing non-modifiable access to the &#39;username&#39;
        // attribute of this object.

    const bsl::string&amp; password() const;
        // Return a reference providing non-modifiable access to the &#39;password&#39;
        // attribute of this object.

                                  // Aspects

    bslma::Allocator *allocator() const;
        // Return the allocator used by this object to supply memory.  Note
        // that if no allocator was supplied at construction the currently
        // installed default allocator is used.

    bsl::ostream&amp; print(bsl::ostream&amp; stream,
                        int           level = 0,
                        int           spacesPerLevel = 4) const;
        // Write the value of this object to the specified output &#39;stream&#39; in a
        // human-readable format, and return a reference to &#39;stream&#39;.
        // Optionally specify an initial indentation &#39;level&#39;, whose absolute
        // value is incremented recursively for nested objects.  If &#39;level&#39; is
        // specified, optionally specify &#39;spacesPerLevel&#39;, whose absolute value
        // indicates the number of spaces per indentation level for this and
        // all of its nested objects.  If &#39;level&#39; is negative, suppress
        // indentation of the first line.  If &#39;spacesPerLevel&#39; is negative,
        // format the entire output on one line, suppressing all but the
        // initial indentation (as governed by &#39;level&#39;).  If &#39;stream&#39; is not
        // valid on entry, this operation has no effect.  Note that the format
        // is not fully specified, and can change without notice.
};

// FREE OPERATORS
bool operator==(const Credentials&amp; lhs, const Credentials&amp; rhs);
    // Return &#39;true&#39; if the specified &#39;lhs&#39; and &#39;rhs&#39; objects have the same
    // value, and &#39;false&#39; otherwise.  Two &#39;Credentials&#39; objects have the same
    // value if both of the corresponding values of their &#39;username&#39; and
    // &#39;password&#39; attributes are the same.

bool operator!=(const Credentials&amp; lhs, const Credentials&amp; rhs);
    // Return &#39;true&#39; if the specified &#39;lhs&#39; and &#39;rhs&#39; objects do not have the
    // same value, and &#39;false&#39; otherwise.  Two &#39;Credentials&#39; objects do not
    // have the same value if either of the corresponding values of their
    // &#39;username&#39; and &#39;password&#39; attributes are not the same.

bsl::ostream&amp; operator&lt;&lt;(bsl::ostream&amp; stream, const Credentials&amp; object);
    // Write the value of the specified &#39;object&#39; to the specified output
    // &#39;stream&#39; in a single-line format, and return a reference providing
    // modifiable access to &#39;stream&#39;.  If &#39;stream&#39; is not valid on entry, this
    // operation has no effect.  Note that this human-readable format is not
    // fully specified and can change without notice.

// FREE FUNCTIONS
void swap(btls5::Credentials&amp; a, btls5::Credentials&amp; b);
    // Efficiently exchange the values of the specified &#39;a&#39; and &#39;b&#39; objects.
    // This function provides the no-throw exception-safety guarantee.  The
    // behavior is undefined unless the two objects were created with the same
    // allocator.

// ============================================================================
//                        INLINE FUNCTION DEFINITIONS
// ============================================================================

                             // -----------------
                             // class Credentials
                             // -----------------

// CREATORS
inline
Credentials::Credentials(bslma::Allocator *basicAllocator)
: d_username(basicAllocator)
, d_password(basicAllocator)
{
}

inline
Credentials::Credentials(const Credentials&amp;  original,
                         bslma::Allocator   *basicAllocator)
: d_username(original.d_username, basicAllocator)
, d_password(original.d_password, basicAllocator)
{
}

inline
Credentials::Credentials(const bslstl::StringRef&amp;  username,
                         const bslstl::StringRef&amp;  password,
                         bslma::Allocator         *basicAllocator)
: d_username(basicAllocator)
, d_password(basicAllocator)
{
    set(username, password);  // assert preconditions and set attributes
}

// MANIPULATORS

                                  // Aspects

inline
void Credentials::swap(Credentials&amp; other)
{
    BSLS_ASSERT_SAFE(allocator() == other.allocator());

    bslalg::SwapUtil::swap(&amp;d_username, &amp;other.d_username);
    bslalg::SwapUtil::swap(&amp;d_password, &amp;other.d_password);
}

// ACCESSORS
inline
const bsl::string&amp; Credentials::username() const
{
    return d_username;
}

inline
const bsl::string&amp; Credentials::password() const
{
    return d_password;
}

                                  // Aspects

inline
bslma::Allocator *Credentials::allocator() const
{
    return d_username.get_allocator().mechanism();
}

}  // close package namespace

// FREE OPERATORS
inline
bool btls5::operator==(const btls5::Credentials&amp; lhs,
                       const btls5::Credentials&amp; rhs)
{
    return lhs.username() == rhs.username()
        &amp;&amp; lhs.password() == rhs.password();
}

inline
bool btls5::operator!=(const btls5::Credentials&amp; lhs,
                       const btls5::Credentials&amp; rhs)
{
    return lhs.username() != rhs.username()
        || lhs.password() != rhs.password();
}

// FREE FUNCTIONS
inline
void btls5::swap(btls5::Credentials&amp; a, btls5::Credentials&amp; b)
{
    a.swap(b);
}

// TRAITS
namespace bslma {

template&lt;&gt;
struct UsesBslmaAllocator&lt;btls5::Credentials&gt; : bsl::true_type {
};

}  // close namespace bslma

}  // close enterprise namespace

#endif

// ----------------------------------------------------------------------------
// Copyright 2015 Bloomberg Finance L.P.
//
// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
// ----------------------------- END-OF-FILE ----------------------------------
</pre>
</body>
</html>
