<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>BDE 3.0: bdlt_datetimetz Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <style>
      div.hanging {
        padding-left: 0.75in;
        text-indent: -0.50in;
      }
      div.unhanging {
        text-indent:     0in;
      }
      a.glossary {
        font-weight: bold;
        font-style: italic;
      }
    </style>
</head>
<!--
<body onload='searchBox.OnSelectItem(0);'>
-->
<body>

<table border=2 cellspacing=0 cellpadding=0 align=center>
<tr>
 <td valign=top align=center>
 <p align=center><b><i>Quick Links:</i></b></p>
 </td>
 <td valign=top align=center>
 <p align=center>
<a class="qindex" href="group__bal.html" target="_blank">bal</a> | <a class="qindex" href="group__bbl.html" target="_blank">bbl</a> | <a class="qindex" href="group__bdl.html" target="_blank">bdl</a> | <a class="qindex" href="group__bsl.html" target="_blank">bsl</a> | <a class="qindex" href="group__btl.html" target="_blank">btl</a>
 </td>
 </tr>
 </table>

  </div>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="components.html"><span>Components</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<h1>Component bdlt_datetimetz<br/>
<small>
[<a class="el" href="group__bdlt.html">Package bdlt</a>]</small>
</h1>  </div>
</div>
<div class="contents">

<p>Provide a representation of a date and time with time zone offset.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebdlt.html">bdlt</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="user"><dt><b>Outline</b></dt><dd><ul>
<li>
<a href="#1">Purpose</a> </li>
<li>
<a href="#2">Classes</a> </li>
<li>
<a href="#3">Description</a> <ul>
<li>
<a href="#3.1">Caveats on Time Zone Support</a> </li>
<li>
<a href="#3.2">Usage</a> <ul>
<li>
<a href="#3.2.1">Example 1: Basic <code>bdlt::DatetimeTz</code> Usage</a> </li>
<li>
<a href="#3.2.2">Example 2: Delivery Estimation System</a> </li>
</ul>
</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="purpose"></a> <a class="anchor" id="1"></a> </dd></dl>
<dl class="user"><dt><b>Purpose: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Provide a representation of a date and time with time zone offset. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="classes"></a> <a class="anchor" id="2"></a> </dd></dl>
<dl class="user"><dt><b>Classes: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><table class="doxtable">
<tr>
<td><a class="el" href="classbdlt_1_1DatetimeTz.html">bdlt::DatetimeTz</a> </td><td>local-datetime value with time zone offset from UTC  </td></tr>
</table>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__bdlt__datetime.html" title="Provide a value-semantic type representing both date and time.">Component bdlt_datetime</a> </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="description"></a> <a class="anchor" id="3"></a> </dd></dl>
<dl class="user"><dt><b>Description: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This component provides a single value-semantic class, <code><a class="el" href="classbdlt_1_1DatetimeTz.html">bdlt::DatetimeTz</a></code>, that represents a datetime value in a particular time zone. Each <code><a class="el" href="classbdlt_1_1DatetimeTz.html">bdlt::DatetimeTz</a></code> object contains a time zone offset from UTC (in minutes) and a <code><a class="el" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a></code> value in that time zone. For logical consistency, the datetime value and offset should correspond to a geographically valid time zone, but such consistency is the user's responsibility. This component does not enforce logical constraints on any values. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="caveats_on_time_zone_support"></a> <a class="anchor" id="description.caveats_on_time_zone_support"></a> <a class="anchor" id="3.1"></a> </dd></dl>
<dl class="user"><dt><b>Caveats on Time Zone Support: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>A <code><a class="el" href="classbdlt_1_1DatetimeTz.html">bdlt::DatetimeTz</a></code> value is intended to be interpreted as a value in a local time zone, along with the offset of that value from UTC. However, there are some problems with this simple interpretation. First of all, the offset value may not correspond to any time zone that has ever existed. For example, the offset value could be set to one minute, or to 1,234 minutes. The meaning of the resulting "local datetime" value is always clear, but the local datetime might not correspond to any geographical or historical time zone. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>The second problem is more subtle. A given offset from UTC might be "valid" in that it corresponds to a real time zone, but the actual datetime value might not exist in that time zone. To make matters worse, a "valid" offset may not (indeed, rarely will) specify one time zone uniquely. Moreover, the datetime value might be valid in one time zone corresponding to a given offset, and not in another time zone. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>For these reasons (and others), this component cannot and does not perform any validation relating to time zones or offsets. The user must take care to honor the "local datetime" contract of this component. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="usage"></a> <a class="anchor" id="description.usage"></a> <a class="anchor" id="3.2"></a> </dd></dl>
<dl class="user"><dt><b>Usage: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This section illustrates intended use of this component. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="example_1~3A_basic_bdlt~3A~3Adatetimetz_usage"></a> <a class="anchor" id="usage.example_1~3A_basic_bdlt~3A~3Adatetimetz_usage"></a> <a class="anchor" id="description.usage.example_1~3A_basic_bdlt~3A~3Adatetimetz_usage"></a> <a class="anchor" id="example_1"></a> <a class="anchor" id="usage.example_1"></a> <a class="anchor" id="description.usage.example_1"></a> <a class="anchor" id="3.2.1"></a> </dd></dl>
<dl class="user"><dt><b>Example 1: Basic bdlt::DatetimeTz Usage: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This example demonstrates how to create and use a <code><a class="el" href="classbdlt_1_1DatetimeTz.html">bdlt::DatetimeTz</a></code> object. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>First, create an object <code>dt1</code> having the default value, and then verify that it contains an offset of 0, implying that the object represents a date and time in the UTC time zone, and the value of the datetime is the same as that of a default constructed <code><a class="el" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a></code> object: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbdlt_1_1DatetimeTz.html">bdlt::DatetimeTz</a> dt1;
  assert(0                == dt1.<a class="code" href="classbdlt_1_1DatetimeTz.html#ae8ef8eb16e1ce5ffba6354f9935c61b4">offset</a>());
  assert(<a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a>() == dt1.<a class="code" href="classbdlt_1_1DatetimeTz.html#a54b9d6329ad4d98edf845a6c5cfe5321">localDatetime</a>());
</pre></div><br/>
<br/>
 Then, set <code>dt1</code> to the value 12:00 noon (12:00:00.000) on 12/31/2005 in the EST time zone (UTC-5): <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a> datetime1(2005, 12, 31, 12, 0, 0, 0);
  <a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a> datetime2(datetime1);
  <span class="keywordtype">int</span>            offset1 = -5 * 60;

  dt1.<a class="code" href="classbdlt_1_1DatetimeTz.html#a311a7b41ad6199d14a4f05fb3e79414a">setDatetimeTz</a>(datetime1, offset1);
  assert(offset1             == dt1.<a class="code" href="classbdlt_1_1DatetimeTz.html#ae8ef8eb16e1ce5ffba6354f9935c61b4">offset</a>());
  assert(dt1.<a class="code" href="classbdlt_1_1DatetimeTz.html#a54b9d6329ad4d98edf845a6c5cfe5321">localDatetime</a>() != dt1.<a class="code" href="classbdlt_1_1DatetimeTz.html#ab899e49044125b091602d3007a70b535">utcDatetime</a>());
  assert(datetime1           == dt1.<a class="code" href="classbdlt_1_1DatetimeTz.html#a54b9d6329ad4d98edf845a6c5cfe5321">localDatetime</a>());
  assert(datetime2           != dt1.<a class="code" href="classbdlt_1_1DatetimeTz.html#ab899e49044125b091602d3007a70b535">utcDatetime</a>());

  datetime2.addMinutes(-offset1);
  assert(datetime2 == dt1.<a class="code" href="classbdlt_1_1DatetimeTz.html#ab899e49044125b091602d3007a70b535">utcDatetime</a>());
</pre></div><br/>
<br/>
 Next, create <code>dt2</code> as a copy of <code>dt1</code>: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbdlt_1_1DatetimeTz.html">bdlt::DatetimeTz</a> dt2(dt1);
  assert(offset1   == dt2.offset());
  assert(datetime1 == dt2.localDatetime());
  assert(datetime2 != dt2.utcDatetime());
</pre></div><br/>
<br/>
 Now, create a third object, <code>dt3</code>, representing the time 10:33:25.000 on 01/01/2001 in the PST time zone (UTC-8): <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a> datetime3(2001, 1, 1, 10, 33, 25, 0);
  <a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a> datetime4(datetime3);
  <span class="keywordtype">int</span>            offset2 = -8 * 60;

  <a class="code" href="classbdlt_1_1DatetimeTz.html">bdlt::DatetimeTz</a> dt3(datetime3, offset2);
  assert(offset2             == dt3.offset());
  assert(dt3.localDatetime() != dt3.utcDatetime());
  assert(datetime3           == dt3.localDatetime());
  assert(datetime4           != dt3.utcDatetime());

  datetime4.addMinutes(-offset2);
  assert(datetime4 == dt3.utcDatetime());
</pre></div><br/>
<br/>
 Finally, stream the values of <code>dt1</code>, <code>dt2</code>, and <code>dt3</code> to <code>stdout</code>: <br/>
<br/>
<div class="fragment"><pre class="fragment">  bsl::cout &lt;&lt; dt1 &lt;&lt; bsl::endl
            &lt;&lt; dt2 &lt;&lt; bsl::endl
            &lt;&lt; dt3 &lt;&lt; bsl::endl;
</pre></div><br/>
<br/>
 The streaming operator produces the following output on <code>stdout</code>: <br/>
<br/>
<div class="fragment"><pre class="fragment">  31DEC2005_12:00:00.000-0500
  31DEC2005_12:00:00.000-0500
  01JAN2001_10:33:25.000-0800
</pre></div><br/>
<br/>
 </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="example_2~3A_delivery_estimation_system"></a> <a class="anchor" id="usage.example_2~3A_delivery_estimation_system"></a> <a class="anchor" id="description.usage.example_2~3A_delivery_estimation_system"></a> <a class="anchor" id="example_2"></a> <a class="anchor" id="usage.example_2"></a> <a class="anchor" id="description.usage.example_2"></a> <a class="anchor" id="3.2.2"></a> </dd></dl>
<dl class="user"><dt><b>Example 2: Delivery Estimation System: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Let us suppose that we are implementing a delivery estimation system for a shipping company. The system provides estimated delivery dates and times of client shipments. This information is provided in the local time zone and is represented as a <code><a class="el" href="classbdlt_1_1DatetimeTz.html">bdlt::DatetimeTz</a></code> object. Below is the definition for a struct that returns the estimated delivery date. <br/>
<br/>
<div class="fragment"><pre class="fragment">                       <span class="comment">// =====================</span>
                       <span class="comment">// struct DeliverySystem</span>
                       <span class="comment">// =====================</span>

  <span class="keyword">struct </span>DeliverySystem {
      <span class="comment">// This struct provides a function that returns the estimated delivery</span>
      <span class="comment">// date and time for a particular shipment.</span>

      <span class="comment">// PRIVATE CLASS METHODS</span>
      <span class="keyword">static</span> <a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a> getCurrentUTCDatetime();
          <span class="comment">// Return the current UTC date and time.</span>

    <span class="keyword">public</span>:
      <span class="comment">// TYPES</span>
      <span class="keyword">enum</span> City {
          <span class="comment">// This enumeration provides an identifier for the various cities.</span>

          e_CHICAGO = 0,
          e_DUBAI,
          e_NEW_YORK,
          e_LONDON,
          e_LOS_ANGELES
      };

      <span class="comment">// CLASS METHODS</span>
      <span class="keyword">static</span> <a class="code" href="classbdlt_1_1DatetimeTz.html">bdlt::DatetimeTz</a> getEstimatedDeliveryDatetime(City city);
          <span class="comment">// Return the estimated delivery date and time, in local time, for</span>
          <span class="comment">// a shipment being sent to the specified &#39;city&#39;.</span>
  };
</pre></div><br/>
<br/>
 All the relevant data used for delivery estimation is stored in a lookup table as shown below: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keyword">const</span> <span class="keywordtype">int</span> k_MINUTES_PER_HOUR = 60;

  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span>{
      <span class="keywordtype">int</span> d_offset;         <span class="comment">// time zone offset from UTC (in minutes)</span>
      <span class="keywordtype">int</span> d_deliveryTime;   <span class="comment">// delivery time (in minutes)</span>
  } DATA[] = {
   <span class="comment">//    Offset                   DeliveryTime</span>
   <span class="comment">//    =======================  =======================</span>
   {     -6 * k_MINUTES_PER_HOUR, 10 * k_MINUTES_PER_HOUR  },  <span class="comment">// Chicago</span>
   {      3 * k_MINUTES_PER_HOUR, 72 * k_MINUTES_PER_HOUR  },  <span class="comment">// Dubai</span>
   {     -5 * k_MINUTES_PER_HOUR,      k_MINUTES_PER_HOUR  },  <span class="comment">// New York</span>
   {          k_MINUTES_PER_HOUR, 36 * k_MINUTES_PER_HOUR  },  <span class="comment">// London</span>
   {     -8 * k_MINUTES_PER_HOUR, 24 * k_MINUTES_PER_HOUR  },  <span class="comment">// Los Angeles</span>
  };
</pre></div><br/>
<br/>
 And here are the function definitions: <br/>
<br/>
<div class="fragment"><pre class="fragment">                       <span class="comment">// ---------------------</span>
                       <span class="comment">// struct DeliverySystem</span>
                       <span class="comment">// ---------------------</span>

  <span class="comment">// PRIVATE CLASS METHODS</span>
  <a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a> DeliverySystem::getCurrentUTCDatetime()
  {
      <span class="comment">// Return a fixed datetime so that output is known a priori.</span>
      <span class="keywordflow">return</span> <a class="code" href="namespacebdet.html#a7cc67ae2240c06a6a70bf001c5a858b5">bdlt::Datetime</a>(2014, 10, 17, 14, 48, 56);
  }

  <span class="comment">// CLASS METHODS</span>
  <a class="code" href="classbdlt_1_1DatetimeTz.html">bdlt::DatetimeTz</a> DeliverySystem::getEstimatedDeliveryDatetime(City city)
  {
      <a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a> localDatetime(getCurrentUTCDatetime());
      localDatetime.addMinutes(DATA[city].d_offset
                             + DATA[city].d_deliveryTime);
      <span class="keywordflow">return</span> <a class="code" href="namespacebdet.html#a256ffa59734fb90452d48f9a3ae1919a">bdlt::DatetimeTz</a>(localDatetime, DATA[city].d_offset);
  }
</pre></div><br/>
<br/>
 When we print out the delivery times: <br/>
<br/>
<div class="fragment"><pre class="fragment">  bsl::cout &lt;&lt; <span class="stringliteral">&quot;Estimated Delivery Time in Chicago:     &quot;</span>
            &lt;&lt; DeliverySystem::getEstimatedDeliveryDatetime(
                                                   DeliverySystem::e_CHICAGO)
            &lt;&lt; bsl::endl;
  bsl::cout &lt;&lt; <span class="stringliteral">&quot;Estimated Delivery Time in Dubai:       &quot;</span>
            &lt;&lt; DeliverySystem::getEstimatedDeliveryDatetime(
                                                     DeliverySystem::e_DUBAI)
            &lt;&lt; bsl::endl;
  bsl::cout &lt;&lt; <span class="stringliteral">&quot;Estimated Delivery Time in New York:    &quot;</span>
            &lt;&lt; DeliverySystem::getEstimatedDeliveryDatetime(
                                                  DeliverySystem::e_NEW_YORK)
            &lt;&lt; bsl::endl;
  bsl::cout &lt;&lt; <span class="stringliteral">&quot;Estimated Delivery Time in London:      &quot;</span>
            &lt;&lt; DeliverySystem::getEstimatedDeliveryDatetime(
                                                    DeliverySystem::e_LONDON)
            &lt;&lt; bsl::endl;
  bsl::cout &lt;&lt; <span class="stringliteral">&quot;Estimated Delivery Time in Los Angeles: &quot;</span>
            &lt;&lt; DeliverySystem::getEstimatedDeliveryDatetime(
                                               DeliverySystem::e_LOS_ANGELES)
            &lt;&lt; bsl::endl;
</pre></div><br/>
<br/>
 We get the following results: <br/>
<br/>
<div class="fragment"><pre class="fragment">  Estimated Delivery <a class="code" href="namespacebdet.html#aac65e816e68f5285b127a9071544c5c1">Time</a> in Chicago:     17OCT2014_18:48:56.000-0600
  Estimated Delivery <a class="code" href="namespacebdet.html#aac65e816e68f5285b127a9071544c5c1">Time</a> in Dubai:       20OCT2014_17:48:56.000+0300
  Estimated Delivery <a class="code" href="namespacebdet.html#aac65e816e68f5285b127a9071544c5c1">Time</a> in New York:    17OCT2014_10:48:56.000-0500
  Estimated Delivery <a class="code" href="namespacebdet.html#aac65e816e68f5285b127a9071544c5c1">Time</a> in London:      19OCT2014_03:48:56.000+0100
  Estimated Delivery <a class="code" href="namespacebdet.html#aac65e816e68f5285b127a9071544c5c1">Time</a> in Los Angeles: 18OCT2014_06:48:56.000-0800
</pre></div><br/>
<br/>
 </dd></dl>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Apr 1 2016 16:48:50 for BDE Release 3.0 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
