<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<title>BDE 2.23.1 OSS</title>
<html>
<pre>
// bsls_byteorder.h                                                   -*-C++-*-
#ifndef INCLUDED_BSLS_BYTEORDER
#define INCLUDED_BSLS_BYTEORDER

#ifndef INCLUDED_BSLS_IDENT
#include &lt;bsls_ident.h&gt;
#endif
BSLS_IDENT(&quot;$Id: $&quot;)

//@PURPOSE: Provide byte-order manipulation macros.
//
//@CLASSES:
//
//@SEE ALSO: bsls_byteorderutil
//
//@MACROS:
//  BSLS_BYTEORDER_HTONS(x):  Convert 16-bit value from host to network order
//  BSLS_BYTEORDER_HTONL(x):  Convert 32-bit value from host to network order
//  BSLS_BYTEORDER_HTONLL(x): Convert 64-bit value from host to network order
//  BSLS_BYTEORDER_NTOHS(x):  Convert 16-bit value from network to host order
//  BSLS_BYTEORDER_NTOHL(x):  Convert 32-bit value from network to host order
//  BSLS_BYTEORDER_NTOHLL(x): Convert 64-bit value from network to host order
//
//  BSLS_BYTEORDER_HTONS_CONSTANT(x):  static 16-bit network to host order
//  BSLS_BYTEORDER_HTONL_CONSTANT(x):  static 32-bit network to host order
//  BSLS_BYTEORDER_HTONLL_CONSTANT(x): static 64-bit network to host order
//  BSLS_BYTEORDER_NTOHS_CONSTANT(x):  static 16-bit network to host order
//  BSLS_BYTEORDER_NTOHL_CONSTANT(x):  static 32-bit network to host order
//  BSLS_BYTEORDER_NTOHLL_CONSTANT(x): static 64-bit network to host order
//
//  BSLS_BYTEORDER_LE_U16_TO_HOST(x): 16-bit little-endian to host-endian
//  BSLS_BYTEORDER_LE_U32_TO_HOST(x): 32-bit little-endian to host-endian
//  BSLS_BYTEORDER_LE_U64_TO_HOST(x): 64-bit little-endian to host-endian
//  BSLS_BYTEORDER_BE_U16_TO_HOST(x): 16-bit    big-endian to host-endian
//  BSLS_BYTEORDER_BE_U32_TO_HOST(x): 32-bit    big-endian to host-endian
//  BSLS_BYTEORDER_BE_U64_TO_HOST(x): 64-bit    big-endian to host-endian
//
//  BSLS_BYTEORDER_HOST_U16_TO_LE(x): 16-bit host-endian to little-endian
//  BSLS_BYTEORDER_HOST_U32_TO_LE(x): 32-bit host-endian to little-endian
//  BSLS_BYTEORDER_HOST_U64_TO_LE(x): 64-bit host-endian to little-endian
//  BSLS_BYTEORDER_HOST_U16_TO_BE(x): 16-bit host-endian to    big-endian
//  BSLS_BYTEORDER_HOST_U32_TO_BE(x): 32-bit host-endian to    big-endian
//  BSLS_BYTEORDER_HOST_U64_TO_BE(x): 64-bit host-endian to    big-endian
//
//@DESCRIPTION: This component provides a set of byte-order manipulation macros
// that replace the standard &#39;htonl&#39;, &#39;htons&#39;, &#39;ntohl&#39;, and &#39;ntohs&#39; functions,
// and which do not require including any system header files:
//..
//  BSLS_BYTEORDER_HTONS(x)
//  BSLS_BYTEORDER_HTONL(x)
//  BSLS_BYTEORDER_HTONLL(x)
//  BSLS_BYTEORDER_NTOHS(x)
//  BSLS_BYTEORDER_NTOHL(x)
//  BSLS_BYTEORDER_NTOHLL(x)
//..
// The &quot;S&quot;, &quot;L&quot;, and &quot;LL&quot; suffices in the names of the above macros indicate
// their applicability to 16-bit (&#39;short&#39;), 32-bit (&#39;int&#39;, *not* &#39;long&#39;), and
// 64-bit (&#39;long long&#39;) values, respectively.
//
// This set of host-to-network and network-to-host conversion macros are very
// efficient, but sacrifices the ability to perform compile-time
// initialization.  To compensate, another set of functionally equivalent
// &quot;CONSTANT&quot; macros are provided.  These macros can be used for compile-time
// initialization, but are less efficient than non-&quot;CONSTANT&quot; versions:
//..
//  BSLS_BYTEORDER_HTONS_CONSTANT(x)
//  BSLS_BYTEORDER_HTONL_CONSTANT(x)
//  BSLS_BYTEORDER_HTONLL_CONSTANT(x)
//  BSLS_BYTEORDER_NTOHS_CONSTANT(x)
//  BSLS_BYTEORDER_NTOHL_CONSTANT(x)
//  BSLS_BYTEORDER_NTOHLL_CONSTANT(x)
//..
// Another set of macros provides conversion from big-endian or little-endian
// byte order to host-endian order.  The macros take 16-, 32- or 64-bit values
// and perform the indicated byte-order conversion on those values:
//..
//  BSLS_BYTEORDER_LE_U16_TO_HOST(x)
//  BSLS_BYTEORDER_LE_U32_TO_HOST(x)
//  BSLS_BYTEORDER_LE_U64_TO_HOST(x)
//  BSLS_BYTEORDER_BE_U16_TO_HOST(x)
//  BSLS_BYTEORDER_BE_U32_TO_HOST(x)
//  BSLS_BYTEORDER_BE_U64_TO_HOST(x)
//..
// The &quot;LE&quot; and &quot;BE&quot; embedded in the above macro names indicate Little-Endian
// and Big-Endian, respectively.
//
// Finally, a complementary set of macros provides conversion from host-endian
// byte order to big-endian or little-endian order:
//..
//  BSLS_BYTEORDER_HOST_U16_TO_LE(x)
//  BSLS_BYTEORDER_HOST_U32_TO_LE(x)
//  BSLS_BYTEORDER_HOST_U64_TO_LE(x)
//  BSLS_BYTEORDER_HOST_U16_TO_BE(x)
//  BSLS_BYTEORDER_HOST_U32_TO_BE(x)
//  BSLS_BYTEORDER_HOST_U64_TO_BE(x)
//..
///Usage
///-----
// To use these macros, simply pass a 16-, 32-, or 64-bit value to the macros.
// To demonstrate the change in byte order effected by the macros, we first
// write a function to print, in hex, a character buffer of a specified size:
//..
//  void printHex(const char *c, int size)
//      // Print the specified character array &#39;c&#39;, having the specified &#39;size&#39;
//      // (in bytes), to &#39;stdout&#39; in hex.
//  {
//      const char *hex = &quot;0123456789abcdef&quot;;
//      for (int i = 0; i &lt; size; ++i) {
//          std::cout &lt;&lt; hex[(c[i] &gt;&gt; 4) &amp; 0xf]
//                    &lt;&lt; hex[ c[i]       &amp; 0xf];
//      }
//  }
//
//  template &lt;class T&gt;
//  void printHex(T x)
//      // Print the specified object &#39;x&#39; of parameterized type &#39;T&#39; in hex.
//  {
//      printHex((const char*)&amp;x, sizeof x);
//  }
//..
// For example, to use the little-endian/big-endian to host-endian macros:
//..
//  short              x = static_cast&lt;short&gt;(0xabcd);
//  int                y = 0xabcdef12;
//  bsls::Types::Int64 z = 0xabcdef1234567890LL;
//
//  // Note the use of macros within the calls to &#39;printHex&#39;.
//
//  printf(&quot;\nLE to Host(x): &quot;);
//  printHex(BSLS_BYTEORDER_LE_U16_TO_HOST(x));
//
//  printf(&quot;\nLE to Host(y): &quot;);
//  printHex(BSLS_BYTEORDER_LE_U32_TO_HOST(y));
//
//  printf(&quot;\nLE to Host(z): &quot;);
//  printHex(BSLS_BYTEORDER_LE_U64_TO_HOST(z));
//
//  printf(&quot;\nBE to Host(x): &quot;);
//  printHex(BSLS_BYTEORDER_BE_U16_TO_HOST(x));
//
//  printf(&quot;\nBE to Host(y): &quot;);
//  printHex(BSLS_BYTEORDER_BE_U32_TO_HOST(y));
//
//  printf(&quot;\nBE to Host(z): &quot;);
//  printHex(BSLS_BYTEORDER_BE_U64_TO_HOST(z));
//..
// On little-endian machines (e.g., x86, IA64), this will print the following
// to &#39;stdout&#39;:
//..
//  LE to Host(x): abcd
//  LE to Host(y): abcdef12
//  LE to Host(z): abcdef1234567890
//  BE to Host(x): cdab
//  BE to Host(y): 12efcdab
//  BE to Host(z): 9078563412efcdab
//..
// On big-endian machines (e.g., sparc, powerpc), the following will be printed
// instead:
//..
//  LE to Host(x): cdab
//  LE to Host(y): 12efcdab
//  LE to Host(z): 9078563412efcdab
//  BE to Host(x): abcd
//  BE to Host(y): abcdef12
//  BE to Host(z): abcdef1234567890
//..
// The other macros can be used in a similar manner.

#ifndef INCLUDED_BSLS_BYTEORDERUTIL
#include &lt;bsls_byteorderutil.h&gt;
#endif

#ifndef INCLUDED_BSLS_PLATFORM
#include &lt;bsls_platform.h&gt;
#endif

// ======
// MACROS
// ======

// STANDARD NETWORK AND HOST CONVERSIONS

#if defined(BSLS_PLATFORM_IS_BIG_ENDIAN)

#define BSLS_BYTEORDER_NTOHS(x)  (x)
#define BSLS_BYTEORDER_NTOHL(x)  (x)
#define BSLS_BYTEORDER_NTOHLL(x) (x)

#define BSLS_BYTEORDER_HTONS(x)  (x)
#define BSLS_BYTEORDER_HTONL(x)  (x)
#define BSLS_BYTEORDER_HTONLL(x) (x)

#define BSLS_BYTEORDER_NTOHS_CONSTANT(x)  (x)
#define BSLS_BYTEORDER_NTOHL_CONSTANT(x)  (x)
#define BSLS_BYTEORDER_NTOHLL_CONSTANT(x) (x)

#define BSLS_BYTEORDER_HTONS_CONSTANT(x)  (x)
#define BSLS_BYTEORDER_HTONL_CONSTANT(x)  (x)
#define BSLS_BYTEORDER_HTONLL_CONSTANT(x) (x)

#else  // BSLS_PLATFORM_IS_LITTLE_ENDIAN

#define BSLS_BYTEORDER_NTOHS(x)                                               \
                               BloombergLP::bsls::ByteOrderUtil::swapBytes16(x)

#define BSLS_BYTEORDER_NTOHL(x)                                               \
                               BloombergLP::bsls::ByteOrderUtil::swapBytes32(x)

#define BSLS_BYTEORDER_NTOHLL(x)                                              \
                               BloombergLP::bsls::ByteOrderUtil::swapBytes64(x)

#define BSLS_BYTEORDER_HTONS(x)  BSLS_BYTEORDER_NTOHS(x)

#define BSLS_BYTEORDER_HTONL(x)  BSLS_BYTEORDER_NTOHL(x)

#define BSLS_BYTEORDER_HTONLL(x) BSLS_BYTEORDER_NTOHLL(x)

#define BSLS_BYTEORDER_NTOHS_CONSTANT(x)                                      \
             static_cast&lt;unsigned short&gt;(                                     \
                            (static_cast&lt;unsigned short&gt;(x) &gt;&gt; 8) | ((x) &lt;&lt; 8))

#define BSLS_BYTEORDER_NTOHL_CONSTANT(x)                                      \
                    ((((x) &gt;&gt; 24) &amp; 0x000000FF) | (((x) &amp; 0x00FF0000) &gt;&gt;  8)  \
                   | (((x) &amp; 0x0000FF00) &lt;&lt;  8) | (((x) &amp; 0x000000FF) &lt;&lt; 24))

#define BSLS_BYTEORDER_NTOHLL_CONSTANT(x)                                     \
                                        ((((x) &amp; 0x00000000000000FFLL) &lt;&lt; 56) \
                                       | (((x) &amp; 0x000000000000FF00LL) &lt;&lt; 40) \
                                       | (((x) &amp; 0x0000000000FF0000LL) &lt;&lt; 24) \
                                       | (((x) &amp; 0x00000000FF000000LL) &lt;&lt;  8) \
                                       | (((x) &amp; 0x000000FF00000000LL) &gt;&gt;  8) \
                                       | (((x) &amp; 0x0000FF0000000000LL) &gt;&gt; 24) \
                                       | (((x) &amp; 0x00FF000000000000LL) &gt;&gt; 40) \
                                       | (((x) &gt;&gt; 56) &amp; 0x00000000000000FFLL))

#define BSLS_BYTEORDER_HTONS_CONSTANT(x)  BSLS_BYTEORDER_NTOHS_CONSTANT(x)

#define BSLS_BYTEORDER_HTONL_CONSTANT(x)  BSLS_BYTEORDER_NTOHL_CONSTANT(x)

#define BSLS_BYTEORDER_HTONLL_CONSTANT(x) BSLS_BYTEORDER_NTOHLL_CONSTANT(x)

#endif  // BSLS_PLATFORM_IS_BIG_ENDIAN

// ---------------------------------------------------------------------------

// ENDIAN CONVERSION MACROS

#if defined(BSLS_PLATFORM_IS_LITTLE_ENDIAN)

#define BSLS_BYTEORDER_LE_U16_TO_HOST(x) (x)
#define BSLS_BYTEORDER_LE_U32_TO_HOST(x) (x)
#define BSLS_BYTEORDER_LE_U64_TO_HOST(x) (x)

#define BSLS_BYTEORDER_HOST_U16_TO_LE(x) (x)
#define BSLS_BYTEORDER_HOST_U32_TO_LE(x) (x)
#define BSLS_BYTEORDER_HOST_U64_TO_LE(x) (x)

#define BSLS_BYTEORDER_BE_U16_TO_HOST(x)                                      \
                               BloombergLP::bsls::ByteOrderUtil::swapBytes16(x)
#define BSLS_BYTEORDER_BE_U32_TO_HOST(x)                                      \
                               BloombergLP::bsls::ByteOrderUtil::swapBytes32(x)
#define BSLS_BYTEORDER_BE_U64_TO_HOST(x)                                      \
                               BloombergLP::bsls::ByteOrderUtil::swapBytes64(x)

#define BSLS_BYTEORDER_HOST_U16_TO_BE(x)                                      \
                               BloombergLP::bsls::ByteOrderUtil::swapBytes16(x)
#define BSLS_BYTEORDER_HOST_U32_TO_BE(x)                                      \
                               BloombergLP::bsls::ByteOrderUtil::swapBytes32(x)
#define BSLS_BYTEORDER_HOST_U64_TO_BE(x)                                      \
                               BloombergLP::bsls::ByteOrderUtil::swapBytes64(x)

#else  // BSLS_PLATFORM_IS_BIG_ENDIAN

#define BSLS_BYTEORDER_LE_U16_TO_HOST(x)                                      \
                               BloombergLP::bsls::ByteOrderUtil::swapBytes16(x)
#define BSLS_BYTEORDER_LE_U32_TO_HOST(x)                                      \
                               BloombergLP::bsls::ByteOrderUtil::swapBytes32(x)
#define BSLS_BYTEORDER_LE_U64_TO_HOST(x)                                      \
                               BloombergLP::bsls::ByteOrderUtil::swapBytes64(x)

#define BSLS_BYTEORDER_HOST_U16_TO_LE(x)                                      \
                               BloombergLP::bsls::ByteOrderUtil::swapBytes16(x)
#define BSLS_BYTEORDER_HOST_U32_TO_LE(x)                                      \
                               BloombergLP::bsls::ByteOrderUtil::swapBytes32(x)
#define BSLS_BYTEORDER_HOST_U64_TO_LE(x)                                      \
                               BloombergLP::bsls::ByteOrderUtil::swapBytes64(x)

#define BSLS_BYTEORDER_BE_U16_TO_HOST(x) (x)
#define BSLS_BYTEORDER_BE_U32_TO_HOST(x) (x)
#define BSLS_BYTEORDER_BE_U64_TO_HOST(x) (x)

#define BSLS_BYTEORDER_HOST_U16_TO_BE(x) (x)
#define BSLS_BYTEORDER_HOST_U32_TO_BE(x) (x)
#define BSLS_BYTEORDER_HOST_U64_TO_BE(x) (x)

#endif  // BSLS_PLATFORM_IS_LITTLE_ENDIAN

#endif

// ----------------------------------------------------------------------------
// Copyright 2013 Bloomberg Finance L.P.
//
// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
// ----------------------------- END-OF-FILE ----------------------------------
</pre>
</body>
</html>
