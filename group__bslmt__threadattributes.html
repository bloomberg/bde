<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>BDE 3.0: bslmt_threadattributes Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <style>
      div.hanging {
        padding-left: 0.75in;
        text-indent: -0.50in;
      }
      div.unhanging {
        text-indent:     0in;
      }
      a.glossary {
        font-weight: bold;
        font-style: italic;
      }
    </style>
</head>
<!--
<body onload='searchBox.OnSelectItem(0);'>
-->
<body>

<table border=2 cellspacing=0 cellpadding=0 align=center>
<tr>
 <td valign=top align=center>
 <p align=center><b><i>Quick Links:</i></b></p>
 </td>
 <td valign=top align=center>
 <p align=center>
<a class="qindex" href="group__bal.html" target="_blank">bal</a> | <a class="qindex" href="group__bbl.html" target="_blank">bbl</a> | <a class="qindex" href="group__bdl.html" target="_blank">bdl</a> | <a class="qindex" href="group__bsl.html" target="_blank">bsl</a> | <a class="qindex" href="group__btl.html" target="_blank">btl</a>
 </td>
 </tr>
 </table>

  </div>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="components.html"><span>Components</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<h1>Component bslmt_threadattributes<br/>
<small>
[<a class="el" href="group__bslmt.html">Package bslmt</a>]</small>
</h1>  </div>
</div>
<div class="contents">

<p>Provide a description of the attributes of a thread.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebslmt.html">bslmt</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="user"><dt><b>Outline</b></dt><dd><ul>
<li>
<a href="#1">Purpose</a> </li>
<li>
<a href="#2">Classes</a> </li>
<li>
<a href="#3">Description</a> <ul>
<li>
&nbsp; <ul>
<li>
<a href="#3.0.1"><code>detachedState</code> Attribute</a> </li>
<li>
<a href="#3.0.2"><code>stackSize</code> Attribute</a> </li>
<li>
<a href="#3.0.3"><code>guardSize</code> Attribute</a> </li>
<li>
<a href="#3.0.4"><code>inheritSchedule</code> Attribute</a> </li>
<li>
<a href="#3.0.5"><code>schedulingPolicy</code> Attribute</a> </li>
<li>
<a href="#3.0.6"><code>schedulingPriority</code> Attribute</a> </li>
</ul>
</li>
<li>
<a href="#3.1">Usage</a> <ul>
<li>
<a href="#3.1.1">Example 1: Creating and Modifying Thread Attributes Objects</a> </li>
</ul>
</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="purpose"></a> <a class="anchor" id="1"></a> </dd></dl>
<dl class="user"><dt><b>Purpose: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Provide a description of the attributes of a thread. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="classes"></a> <a class="anchor" id="2"></a> </dd></dl>
<dl class="user"><dt><b>Classes: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><table class="doxtable">
<tr>
<td><a class="el" href="classbslmt_1_1ThreadAttributes.html">bslmt::ThreadAttributes</a> </td><td>description of the attributes of a thread  </td></tr>
</table>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__bslmt__threadutil.html" title="Provide platform-independent utilities related to threading.">Component bslmt_threadutil</a>, <a class="el" href="group__bslmt__configuration.html" title="Provide utilities to allow configuration of values for BCE.">Component bslmt_configuration</a> </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="description"></a> <a class="anchor" id="3"></a> </dd></dl>
<dl class="user"><dt><b>Description: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This component provides a simply constrained (value-semantic) attribute class, <code><a class="el" href="classbslmt_1_1ThreadAttributes.html">bslmt::ThreadAttributes</a></code>, for describing attributes of a thread in a platform-independent way. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>The default values and constraints for the attributes provided by <code><a class="el" href="classbslmt_1_1ThreadAttributes.html">bslmt::ThreadAttributes</a></code> are listed in the following two tables: <br/>
<br/>
<div class="fragment"><pre class="fragment">  Name                <a class="code" href="classBind__ImplSelector_1_1Type.html">Type</a>                   Default
  ------------------  ---------------------  ----------------------
  detachedState       <span class="keyword">enum</span> DetachedState     e_CREATE_JOINABLE
  stackSize           <span class="keywordtype">int</span>                    e_UNSET_STACK_SIZE
  guardSize           <span class="keywordtype">int</span>                    e_UNSET_GUARD_SIZE
  inheritSchedule     <span class="keywordtype">bool</span>                   <span class="stringliteral">&#39;true&#39;</span>
  schedulingPolicy    <span class="keyword">enum</span> SchedulingPolicy  e_SCHED_DEFAULT
  schedulingPriority  <span class="keywordtype">int</span>                    e_UNSET_PRIORITY

  Name          Constraint
  ---------     ---------------------------------------------------
  stackSize     <span class="stringliteral">&#39;e_UNSET_STACK_SIZE == stackSize || 0 &lt;= stackSize&#39;</span>
  guardSize     <span class="stringliteral">&#39;e_UNSET_GUARD_SIZE == guardSize || 0 &lt;= guardSize&#39;</span>
</pre></div><br/>
<br/>
 </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="detachedstate_attribute"></a> <a class="anchor" id=".detachedstate_attribute"></a> <a class="anchor" id="description..detachedstate_attribute"></a> <a class="anchor" id="3.0.1"></a> </dd></dl>
<dl class="user"><dt><b>detachedState Attribute: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The <code>detachedState</code> attribute indicates whether an associated thread should be created in a joinable or detached state, through the enum values <code>e_CREATE_JOINABLE</code> and <code>e_CREATE_DETACHED</code>, respectively. A thread in the joinable state will have its exit status maintained after thread termination. Any thread can join with a joinable thread (see <code>bslmt_threadutil</code>), in which case the joining thread will block, waiting for the joined thread's execution to complete, after which the joined thread's termination status will be reported back to the joining thread, and its resources reclaimed. A thread in a detached state will have its resources claimed at thread termination, and cannot be joined. Note that a joinable thread can be made detached after it is created, but not vice versa. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="stacksize_attribute"></a> <a class="anchor" id=".stacksize_attribute"></a> <a class="anchor" id="description..stacksize_attribute"></a> <a class="anchor" id="3.0.2"></a> </dd></dl>
<dl class="user"><dt><b>stackSize Attribute: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The <code>stackSize</code> attribute indicates the size, in bytes, of the stack that should be provided to a newly created thread. If the stack size is <code>e_UNSET_STACK_SIZE</code> then a created thread will be provided a default stack size (see <code>bslmt_configuration</code>). The <code>stackSize</code> attribute should be interpreted to mean that a created thread can safely define an automatic variable of the configured <code>stackSize</code> bytes in its thread-entry function. Note that, on some platforms, an adjusted value derived from the <code>stackSize</code> attribute may be supplied to the underlying representation by the thread creation function -- for example, on Itanium (HPUX), the <code>stackSize</code> attribute value must be scaled up to account for the extra stack space devoted to register storage. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="guardsize_attribute"></a> <a class="anchor" id=".guardsize_attribute"></a> <a class="anchor" id="description..guardsize_attribute"></a> <a class="anchor" id="3.0.3"></a> </dd></dl>
<dl class="user"><dt><b>guardSize Attribute: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The <code>guardSize</code> attribute indicates the size of the memory region to provide past the end of a created thread's stack to protect against stack overflows. If a thread's stack pointer overflows into a guard area, the task will receive an error (e.g., a signal). If <code>guardSize</code> is <code>e_UNSET_GUARD_SIZE</code>, then a created thread will be provided with a default native guard size (see <code>bslmt_configuration</code>). Note that the interpretation of <code>guardSize</code> may vary among platforms, and the value may be adjusted up (e.g., by rounding up to a multiple of page size) or ignored entirely (e.g., the Windows platform does not support this attribute). </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="inheritschedule_attribute"></a> <a class="anchor" id=".inheritschedule_attribute"></a> <a class="anchor" id="description..inheritschedule_attribute"></a> <a class="anchor" id="3.0.4"></a> </dd></dl>
<dl class="user"><dt><b>inheritSchedule Attribute: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The <code>inheritSchedule</code> attribute, if <code>true</code>, indicates that a created thread's <code>schedulingPolicy</code> and <code>schedulingPriority</code> attributes should be taken from its parent thread and the configured values of those thread attributes should be ignored. If <code>inheritSchedule</code> is <code>false</code>, then the <code>schedulingPolicy</code> and <code>schedulingPriority</code> attribute values should be used to configure a thread. See <code>bslmt_threadutil</code> for information about support for this attribute. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="schedulingpolicy_attribute"></a> <a class="anchor" id=".schedulingpolicy_attribute"></a> <a class="anchor" id="description..schedulingpolicy_attribute"></a> <a class="anchor" id="3.0.5"></a> </dd></dl>
<dl class="user"><dt><b>schedulingPolicy Attribute: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The <code>schedulingPolicy</code> attribute indicates the policy that should be used to schedule the created thread for execution. Typically clients should use the default platform supplied scheduling policy, which is indicated by the <code>e_SCHED_DEFAULT</code> value. The alternative scheduling policies, <code>e_THREAD_FIFO</code> and <code>e_SCHED_RR</code>, are "real-time" scheduling policies, and may not be available unless the task is run with the appropriate privileges. <code>e_SCHED_FIFO</code> indicates a thread should run until it either yields or is interrupted by a thread of higher priority. <code>e_SCHED_RR</code> is the same as <code>e_SCHED_FIFO</code>, except that the created thread may be interrupted by a ready thread of equal priority after a finite time-slice. This attribute is ignored unless <code>inheritSchedule</code> is <code>false</code>. See <code>bslmt_threadutil</code> for information about support for this attribute. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="schedulingpriority_attribute"></a> <a class="anchor" id=".schedulingpriority_attribute"></a> <a class="anchor" id="description..schedulingpriority_attribute"></a> <a class="anchor" id="3.0.6"></a> </dd></dl>
<dl class="user"><dt><b>schedulingPriority Attribute: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The <code>schedulingPriority</code> attribute is a platform specific value whose valid values range from the minimum to the maximum value for the associated <code>schedulingPolicy</code>, with higher numbers indicating a more urgent priority. Functions to obtain the minimum and maximum values are in this component and <code>bslmt_threadutil</code>. This attribute is ignored unless <code>inheritSchedule</code> is <code>false</code>. See <code>bslmt_threadutil</code> for information about support for this attribute. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="usage"></a> <a class="anchor" id="description.usage"></a> <a class="anchor" id="3.1"></a> </dd></dl>
<dl class="user"><dt><b>Usage: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This section illustrates intended use of this component. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="example_1~3A_creating_and_modifying_thread_attributes_objects"></a> <a class="anchor" id="usage.example_1~3A_creating_and_modifying_thread_attributes_objects"></a> <a class="anchor" id="description.usage.example_1~3A_creating_and_modifying_thread_attributes_objects"></a> <a class="anchor" id="example_1"></a> <a class="anchor" id="usage.example_1"></a> <a class="anchor" id="description.usage.example_1"></a> <a class="anchor" id="3.1.1"></a> </dd></dl>
<dl class="user"><dt><b>Example 1: Creating and Modifying Thread Attributes Objects: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>In this example we will demonstrate creating and configuring a <code><a class="el" href="classbslmt_1_1ThreadAttributes.html">bslmt::ThreadAttributes</a></code> object, then using it with a hypothetical thread-creation function. Finally we show how a thread creation function might interpret those attributes for the underlying operating system. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>First we forward declare a routine that we will use to create a thread: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">void</span> myThreadCreate(<span class="keywordtype">int</span>                             *threadHandle,
                      <span class="keyword">const</span> <a class="code" href="classbslmt_1_1ThreadAttributes.html">bslmt::ThreadAttributes</a>&amp;   attributes,
                      <span class="keywordtype">void</span>                           (*function)());
      <span class="comment">// Spawn a thread having properties described by the specified</span>
      <span class="comment">// &#39;attributes&#39; and that runs the specified &#39;function&#39;, and assign a</span>
      <span class="comment">// handle referring to the spawned thread to the specified</span>
      <span class="comment">// &#39;*threadHandle&#39;.</span>
</pre></div><br/>
<br/>
 Then, we declare two routines that will return the minimum and maximum thread priority given a scheduling policy. Note that similar methods exist in <code>bslmt_threadutil</code>. <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">int</span> myMinPriority(<a class="code" href="classbslmt_1_1ThreadAttributes.html#a236ea307f690b2a13d387cc90e287cf6">bslmt::ThreadAttributes::SchedulingPolicy</a> policy);
  <span class="keywordtype">int</span> myMaxPriority(<a class="code" href="classbslmt_1_1ThreadAttributes.html#a236ea307f690b2a13d387cc90e287cf6">bslmt::ThreadAttributes::SchedulingPolicy</a> policy);
</pre></div><br/>
<br/>
 Next we define a function that we will use as our thread entry point. This function declares a single variable on the stack of predetermined size. <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keyword">enum</span> { k_BUFFER_SIZE = 128 * 1024 };

  <span class="keywordtype">void</span> myThreadFunction()
  {
      <span class="keywordtype">int</span> bufferLocal[k_BUFFER_SIZE];

      <span class="comment">// Perform some calculation that involves no subroutine calls or</span>
      <span class="comment">// additional automatic variables.</span>
  }
</pre></div><br/>
<br/>
 Then, we define our main function, in which we demonstrate configuring a <code><a class="el" href="classbslmt_1_1ThreadAttributes.html">bslmt::ThreadAttributes</a></code> object describing the properties a thread we will create. <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">void</span> testMain()
  {
</pre></div><br/>
<br/>
 Next, we create a thread attributes object, <code>attributes</code>, and set its <code>stackSize</code> attribute to a value large enough to accommodate the <code>BUFFER_SIZE</code> buffer used by <code>myThreadFunction</code>. Note that we use <code>BUFFER_SIZE</code> as an illustration; in practice, it is difficult or impossible to gauge the exact amount of stack size required for a typical thread, and the value supplied should be a reasonable <em>upper</em> bound on the anticipated requirement. <br/>
<br/>
<div class="fragment"><pre class="fragment">      <a class="code" href="classbslmt_1_1ThreadAttributes.html">bslmt::ThreadAttributes</a> attributes;
      attributes.<a class="code" href="classbslmt_1_1ThreadAttributes.html#a968796a660b323e2c72fd365323d50c4">setStackSize</a>(k_BUFFER_SIZE);
</pre></div><br/>
<br/>
 Then, we set the <code>detachedState</code> property to <code>e_CREATE_DETACHED</code>, indicating that the thread will not be joinable, and its resources will be reclaimed upon termination. <br/>
<br/>
<div class="fragment"><pre class="fragment">      attributes.<a class="code" href="classbslmt_1_1ThreadAttributes.html#afb35bfec602df986524a4e5dfd734aaa">setDetachedState</a>(
                             <a class="code" href="classbslmt_1_1ThreadAttributes.html#a660f00e1f7a7a5b30cc05956f5374110ad5c4c452ec52d312ac3c0e7c65510afb" title="create a non-joinable thread">bslmt::ThreadAttributes::e_CREATE_DETACHED</a>);
</pre></div><br/>
<br/>
 Now, we create a thread, using the attributes configured above: <br/>
<br/>
<div class="fragment"><pre class="fragment">      <span class="keywordtype">int</span> handle;
      myThreadCreate(&amp;handle, attributes, &amp;myThreadFunction);
  }
</pre></div><br/>
<br/>
 Finally, we define the thread creation function, and show how a thread attributes object might be interpreted by it: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">void</span> myThreadCreate(<span class="keywordtype">int</span>                             *threadHandle,
                      <span class="keyword">const</span> <a class="code" href="classbslmt_1_1ThreadAttributes.html">bslmt::ThreadAttributes</a>&amp;   attributes,
                      <span class="keywordtype">void</span>                           (*function)())
      <span class="comment">// Spawn a thread with properties described by the specified</span>
      <span class="comment">// &#39;attributes&#39;, running the specified &#39;function&#39;, and assign a handle</span>
      <span class="comment">// referring to the spawned thread to the specified &#39;*threadHandle&#39;.</span>
  {
      <span class="keywordtype">int</span> stackSize = attributes.<a class="code" href="classbslmt_1_1ThreadAttributes.html#aa65f51c0bdf6cfa4729abbc6e37fbba8">stackSize</a>();
      <span class="keywordflow">if</span> (<a class="code" href="classbslmt_1_1ThreadAttributes.html#a21679b30c880e88cefb6e3310b675296aecad9d40a05a294415b8ed8b113d86b4">bslmt::ThreadAttributes::e_UNSET_STACK_SIZE</a> == stackSize) {
          stackSize = <a class="code" href="structbslmt_1_1Configuration.html#a400d7f8cf2497952f91b59246224a18a">bslmt::Configuration::defaultThreadStackSize</a>();
      }

      <span class="comment">// Add a &quot;fudge factor&quot; to &#39;stackSize&#39; to ensure that the client can</span>
      <span class="comment">// declare an object of &#39;stackSize&#39; bytes on the stack safely.</span>

      stackSize += 8192;

<span class="preprocessor">  #ifdef BSLS_PLATFORM_OS_HPUX</span>
<span class="preprocessor"></span>      <span class="comment">// The Itanium divides the stack into two sections: a variable stack</span>
      <span class="comment">// and a control stack.  To make &#39;stackSize&#39; have the same meaning</span>
      <span class="comment">// across platforms, we must double it on this platform.</span>

      stackSize *= 2;
<span class="preprocessor">  #endif</span>
<span class="preprocessor"></span>
      <span class="keywordtype">int</span> guardSize = attributes.<a class="code" href="classbslmt_1_1ThreadAttributes.html#a5e2058643f5b534058ac3406fdb4c55e">guardSize</a>();
      <span class="keywordflow">if</span> (<a class="code" href="classbslmt_1_1ThreadAttributes.html#a21679b30c880e88cefb6e3310b675296a823ce037ba5968f67cf557f420cbcf04">bslmt::ThreadAttributes::e_UNSET_GUARD_SIZE</a> == guardSize) {
          guardSize = <a class="code" href="structbslmt_1_1Configuration.html#ae424b7293376e153b78ae6b024c54dd4">bslmt::Configuration::nativeDefaultThreadGuardSize</a>();
      }

      <span class="keywordtype">int</span> policy = attributes.<a class="code" href="classbslmt_1_1ThreadAttributes.html#a838b613bc750b4aa69a603451881208f">schedulingPolicy</a>();
      <span class="keywordtype">int</span> priority = attributes.<a class="code" href="classbslmt_1_1ThreadAttributes.html#a0c9219b852d1b813372be7eda64d067e">schedulingPriority</a>();

      <span class="comment">// the following is pseudo-code for actually creating the thread</span>
      <span class="comment">/*</span>
<span class="comment">      if (bslmt::ThreadAttributes::e_UNSET_PRIORITY == priority) {</span>
<span class="comment">          priority = operatingSystemDefaultPriority(policy);</span>
<span class="comment">      }</span>
<span class="comment"></span>
<span class="comment">      operatingSystemThreadCreate(threadHandle,</span>
<span class="comment">                                  stackSize,</span>
<span class="comment">                                  guardSize,</span>
<span class="comment">                                  attributes.inheritSchedule(),</span>
<span class="comment">                                  policy,</span>
<span class="comment">                                  priority,</span>
<span class="comment">                                  attributes.detachedState()</span>
<span class="comment">                                  function);</span>
<span class="comment">      */</span>
  }
</pre></div><br/>
<br/>
 Notice that a new value derived from the <code>stackSize</code> attribute is used so that the meaning of the attribute is platform neutral. </dd></dl>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Apr 1 2016 16:49:01 for BDE Release 3.0 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
