<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>BDE 3.0: bdls_filesystemutil Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <style>
      div.hanging {
        padding-left: 0.75in;
        text-indent: -0.50in;
      }
      div.unhanging {
        text-indent:     0in;
      }
      a.glossary {
        font-weight: bold;
        font-style: italic;
      }
    </style>
</head>
<!--
<body onload='searchBox.OnSelectItem(0);'>
-->
<body>

<table border=2 cellspacing=0 cellpadding=0 align=center>
<tr>
 <td valign=top align=center>
 <p align=center><b><i>Quick Links:</i></b></p>
 </td>
 <td valign=top align=center>
 <p align=center>
<a class="qindex" href="group__bal.html" target="_blank">bal</a> | <a class="qindex" href="group__bbl.html" target="_blank">bbl</a> | <a class="qindex" href="group__bdl.html" target="_blank">bdl</a> | <a class="qindex" href="group__bsl.html" target="_blank">bsl</a> | <a class="qindex" href="group__btl.html" target="_blank">btl</a>
 </td>
 </tr>
 </table>

  </div>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="components.html"><span>Components</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<h1>Component bdls_filesystemutil<br/>
<small>
[<a class="el" href="group__bdls.html">Package bdls</a>]</small>
</h1>  </div>
</div>
<div class="contents">

<p>Provide methods for filesystem access with multi-language names.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebdls.html">bdls</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="user"><dt><b>Outline</b></dt><dd><ul>
<li>
<a href="#1">Purpose</a> </li>
<li>
<a href="#2">Classes</a> </li>
<li>
<a href="#3">Description</a> <ul>
<li>
<a href="#3.1">Policies for <code>open</code></a> <ul>
<li>
<a href="#3.1.1">Open/Create Policy: <code>bdls::FilesystemUtil::FileOpenPolicy</code></a> </li>
<li>
<a href="#3.1.2">Input/Output Access Policy: <code>bdls::FilesystemUtil::FileIOPolicy</code></a> </li>
<li>
<a href="#3.1.3">Truncation Policy: <code>bdls::FilesystemUtil::FileTruncatePolicy</code></a> </li>
</ul>
</li>
<li>
<a href="#3.2">Starting Points for <code>seek</code></a> </li>
<li>
<a href="#3.3">Platform-Specific File Locking Caveats</a> </li>
<li>
<a href="#3.4">Platform-Specific Atomicity Caveats</a> </li>
<li>
<a href="#3.5">Platform-Specific File Name Encoding Caveats</a> </li>
<li>
<a href="#3.6">File Truncation Caveats</a> </li>
<li>
<a href="#3.7">Usage</a> <ul>
<li>
<a href="#3.7.1">Example 1: General Usage</a> </li>
<li>
<a href="#3.7.2">Example 2: Using <code>bdls::FilesystemUtil::visitPaths</code></a> </li>
</ul>
</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="purpose"></a> <a class="anchor" id="1"></a> </dd></dl>
<dl class="user"><dt><b>Purpose: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Provide methods for filesystem access with multi-language names. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="classes"></a> <a class="anchor" id="2"></a> </dd></dl>
<dl class="user"><dt><b>Classes: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><table class="doxtable">
<tr>
<td><a class="el" href="structbdls_1_1FilesystemUtil.html">bdls::FilesystemUtil</a> </td><td>namespace for filesystem access methods  </td></tr>
</table>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__bdls__pathutil.html" title="Provide portable file path manipulation.">Component bdls_pathutil</a> </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="description"></a> <a class="anchor" id="3"></a> </dd></dl>
<dl class="user"><dt><b>Description: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This component provides a platform-independent interface to filesystem utility methods, supporting multi-language file and path names. Each method in the <code><a class="el" href="structbdls_1_1FilesystemUtil.html">bdls::FilesystemUtil</a></code> namespace is a thin wrapper on top of the operating system's own filesystem access functions, providing a consistent and unambiguous interface for handling files on all supported platforms. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Methods in this component can be used to manipulate files with any name in any language on all supported platforms. To provide such support, the following restrictions are applied to file names and patterns passed to methods of this component: On Windows, all file names and patterns must be passed as UTF-8-encoded strings; file search results will similarly be encoded as UTF-8. On Posix, file names and patterns may be passed in any encoding, but all processes accessing a given file must encode its name in the same encoding. On modern Posix installations, this effectively means that file names and patterns should be encoded in UTF-8, just as on Windows. See the section "Platform-Specific File Name Encoding Caveats" below. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="policies_for_open"></a> <a class="anchor" id="description.policies_for_open"></a> <a class="anchor" id="3.1"></a> </dd></dl>
<dl class="user"><dt><b>Policies for open: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The behavior of the <code>open</code> method is governed by three sets of enumerations: </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="open~2Fcreate_policy~3A_bdls~3A~3Afilesystemutil~3A~3Afileopenpolicy"></a> <a class="anchor" id="policies_for_open.open~2Fcreate_policy~3A_bdls~3A~3Afilesystemutil~3A~3Afileopenpolicy"></a> <a class="anchor" id="description.policies_for_open.open~2Fcreate_policy~3A_bdls~3A~3Afilesystemutil~3A~3Afileopenpolicy"></a> <a class="anchor" id="open~2Fcreate_policy"></a> <a class="anchor" id="policies_for_open.open~2Fcreate_policy"></a> <a class="anchor" id="description.policies_for_open.open~2Fcreate_policy"></a> <a class="anchor" id="3.1.1"></a> </dd></dl>
<dl class="user"><dt><b>Open/Create Policy: bdls::FilesystemUtil::FileOpenPolicy: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><code><a class="el" href="structbdls_1_1FilesystemUtil.html#aaf288297e2a9b65fdcdd18c2aec66c3b">bdls::FilesystemUtil::FileOpenPolicy</a></code> governs whether <code>open</code> creates a new file or opens an existing one. The following values are possible: </dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> </div></dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> <code>e_OPEN</code>: <br/>
 Open an existing file.</div></dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> <code>e_CREATE</code>: <br/>
 Create a new file.</div></dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> <code>e_CREATE_PRIVATE</code>: <br/>
 Create a new file, with limited permissions where that is supported (e.g. not necessarily Microsoft Windows).</div></dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> <code>e_OPEN_OR_CREATE</code>: <br/>
 Open a file if it exists, and create a new file otherwise.</div></dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> </div> </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="input~2Foutput_access_policy~3A_bdls~3A~3Afilesystemutil~3A~3Afileiopolicy"></a> <a class="anchor" id="policies_for_open.input~2Foutput_access_policy~3A_bdls~3A~3Afilesystemutil~3A~3Afileiopolicy"></a> <a class="anchor" id="description.policies_for_open.input~2Foutput_access_policy~3A_bdls~3A~3Afilesystemutil~3A~3Afileiopolicy"></a> <a class="anchor" id="input~2Foutput_access_policy"></a> <a class="anchor" id="policies_for_open.input~2Foutput_access_policy"></a> <a class="anchor" id="description.policies_for_open.input~2Foutput_access_policy"></a> <a class="anchor" id="3.1.2"></a> </dd></dl>
<dl class="user"><dt><b>Input/Output Access Policy: bdls::FilesystemUtil::FileIOPolicy: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><code><a class="el" href="structbdls_1_1FilesystemUtil.html#ab79b11034df3e25311be375da986b908">bdls::FilesystemUtil::FileIOPolicy</a></code> governs what Input/Output operations are allowed on a file after it is opened. The following values are possible: </dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> </div></dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> <code>e_READ_ONLY</code>: <br/>
 Allow reading only.</div></dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> <code>e_WRITE_ONLY</code>: <br/>
 Allow writing only.</div></dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> <code>e_READ_WRITE</code>: <br/>
 Allow both reading and writing.</div></dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> <code>e_APPEND_ONLY</code>: <br/>
 Allow appending to end-of-file only.</div></dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> <code>e_READ_APPEND</code>: <br/>
 Allow both reading and appending to end-of-file.</div></dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> </div> </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="truncation_policy~3A_bdls~3A~3Afilesystemutil~3A~3Afiletruncatepolicy"></a> <a class="anchor" id="policies_for_open.truncation_policy~3A_bdls~3A~3Afilesystemutil~3A~3Afiletruncatepolicy"></a> <a class="anchor" id="description.policies_for_open.truncation_policy~3A_bdls~3A~3Afilesystemutil~3A~3Afiletruncatepolicy"></a> <a class="anchor" id="truncation_policy"></a> <a class="anchor" id="policies_for_open.truncation_policy"></a> <a class="anchor" id="description.policies_for_open.truncation_policy"></a> <a class="anchor" id="3.1.3"></a> </dd></dl>
<dl class="user"><dt><b>Truncation Policy: bdls::FilesystemUtil::FileTruncatePolicy: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><code><a class="el" href="structbdls_1_1FilesystemUtil.html#a8c2d86c5eb644a39e3a40cc5594b3b27">bdls::FilesystemUtil::FileTruncatePolicy</a></code> governs whether <code>open</code> deletes the existing contents of a file when it is opened. The following values are possible: </dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> </div></dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> <code>e_TRUNCATE</code>: <br/>
 Delete the file's contents.</div></dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> <code>e_KEEP</code>: <br/>
 Keep the file's contents.</div></dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> </div> </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="starting_points_for_seek"></a> <a class="anchor" id="description.starting_points_for_seek"></a> <a class="anchor" id="3.2"></a> </dd></dl>
<dl class="user"><dt><b>Starting Points for seek: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The behavior of the <code>seek</code> method is governed by an enumeration that determines the point from which the seek operation starts: </dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> </div></dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> <code>e_SEEK_FROM_BEGINNING</code>: <br/>
 Seek from the beginning of the file.</div></dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> <code>e_SEEK_FROM_CURRENT</code>: <br/>
 Seek from the current position in the file.</div></dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> <code>e_SEEK_FROM_END</code>: <br/>
 Seek from the end of the file.</div></dd></dl>
<dl class="user"><dt><b></b></dt><dd><div class="hanging"> </div> </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="platform-specific_file_locking_caveats"></a> <a class="anchor" id="description.platform-specific_file_locking_caveats"></a> <a class="anchor" id="3.3"></a> </dd></dl>
<dl class="user"><dt><b>Platform-Specific File Locking Caveats: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Locking has the following caveats for the following operating systems: <ul>
<li>
On Posix, closing a file releases all locks on all file descriptors referring to that file within the current process. [doc 1] [doc 2]  </li>
<li>
On Posix, the child of a fork does not inherit the locks of the parent process. [doc 1] [doc 2]  </li>
<li>
On at least some flavors of Unix, you can't lock a file for writing using a file descriptor opened in read-only mode.  </li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="platform-specific_atomicity_caveats"></a> <a class="anchor" id="description.platform-specific_atomicity_caveats"></a> <a class="anchor" id="3.4"></a> </dd></dl>
<dl class="user"><dt><b>Platform-Specific Atomicity Caveats: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The <code><a class="el" href="structbdls_1_1FilesystemUtil.html#a160d397df5ff5df49fd93a8560acbf99">bdls::FilesystemUtil::read</a></code> and <code><a class="el" href="structbdls_1_1FilesystemUtil.html#abc5fe7e103cd5035f4e2cd2d71f51676">bdls::FilesystemUtil::write</a></code> methods add no atomicity guarantees for reading and writing to those provided (if any) by the underlying platform's methods for reading and writing (see <code><a href="http://lwn.net/articles/180387/">http://lwn.net/articles/180387/</a></code>). </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="platform-specific_file_name_encoding_caveats"></a> <a class="anchor" id="description.platform-specific_file_name_encoding_caveats"></a> <a class="anchor" id="3.5"></a> </dd></dl>
<dl class="user"><dt><b>Platform-Specific File Name Encoding Caveats: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>File-name encodings have the following caveats for the following operating systems: </dd></dl>
<dl class="user"><dt><b></b></dt><dd><ul>
<li>
<p class="startli">On Windows, methods of <code><a class="el" href="structbdls_1_1FilesystemUtil.html">bdls::FilesystemUtil</a></code> that take a file or directory name or pattern as a <code>char*</code> or <code>bsl::string</code> type assume that the name is encoded in UTF-8. The routines attempt to convert the name to a UTF-16 <code>wchar_t</code> string via <code><a class="el" href="structbdlde_1_1CharConvertUtf16.html#af8825cc14b50735cfba6a9e20dc7a3e1">bdlde::CharConvertUtf16::utf8ToUtf16</a></code>, and if the conversion succeeds, call the Windows wide-character <code>W</code> APIs with the UTF-16 name. If the conversion fails, the method fails. Similarly, file searches returning file names call the Windows wide-character <code>W</code> APIs and convert the resulting UTF-16 names to UTF-8.</p>
<ul>
<li>
Narrow-character file names in other encodings, containing characters with values in the range 128 - 255, will likely result in files being created with names that appear garbled if the conversion from UTF-8 to UTF-16 happens to succeed.  </li>
<li>
Neither <code>utf8ToUtf16</code> nor the Windows <code>W</code> APIs do any normalization of the UTF-16 strings resulting from UTF-8 conversion, and it is therefore possible to have sets of file names that have the same visual representation but are treated as different names by the filesystem. </li>
</ul>
<p class="endli"></p>
</li>
<li>
On Posix, a file name or pattern supplied to methods of <code><a class="el" href="structbdls_1_1FilesystemUtil.html">bdls::FilesystemUtil</a></code> as a <code>char*</code> or <code>bsl::string</code> type is passed unchanged to the underlying system file APIs. Because the file names and patterns are passed unchanged, <code><a class="el" href="structbdls_1_1FilesystemUtil.html">bdls::FilesystemUtil</a></code> methods will work correctly on Posix with any encoding, but will <em>interoperate</em> only with processes that use the same encoding as the current process.  </li>
<li>
For compatibility with most modern Posix installs, and consistency with this component's Windows API, best practice is to encode all file names and patterns in UTF-8.  </li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="file_truncation_caveats"></a> <a class="anchor" id="description.file_truncation_caveats"></a> <a class="anchor" id="3.6"></a> </dd></dl>
<dl class="user"><dt><b>File Truncation Caveats: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>In order to provide consistent behavior across both Posix and Windows platforms, when the <code>open</code> method is called, file truncation is allowed only if the client requests an <code>openPolicy</code> containing the word <code>CREATE</code> and/or an <code>ioPolicy</code> containing the word <code>WRITE</code>. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="usage"></a> <a class="anchor" id="description.usage"></a> <a class="anchor" id="3.7"></a> </dd></dl>
<dl class="user"><dt><b>Usage: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This section illustrates intended use of this component. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="example_1~3A_general_usage"></a> <a class="anchor" id="usage.example_1~3A_general_usage"></a> <a class="anchor" id="description.usage.example_1~3A_general_usage"></a> <a class="anchor" id="example_1"></a> <a class="anchor" id="usage.example_1"></a> <a class="anchor" id="description.usage.example_1"></a> <a class="anchor" id="3.7.1"></a> </dd></dl>
<dl class="user"><dt><b>Example 1: General Usage: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>In this example, we start with a (relative) native path to a directory containing log files: <br/>
<br/>
<div class="fragment"><pre class="fragment"><span class="preprocessor">  #ifdef BSLS_PLATFORM_OS_WINDOWS</span>
<span class="preprocessor"></span>    <a class="code" href="classbsl_1_1basic__string.html">bsl::string</a> logPath = <span class="stringliteral">&quot;temp.1\\logs&quot;</span>;
<span class="preprocessor">  #else</span>
<span class="preprocessor"></span>    <a class="code" href="classbsl_1_1basic__string.html">bsl::string</a> logPath = <span class="stringliteral">&quot;temp.1/logs&quot;</span>;
<span class="preprocessor">  #endif</span>
</pre></div><br/>
<br/>
 Suppose that we want to separate files into "old" and "new" subdirectories on the basis of modification time. We will provide paths representing these locations, and create the directories if they do not exist: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbsl_1_1basic__string.html">bsl::string</a> oldPath(logPath), newPath(logPath);
  <a class="code" href="structbdls_1_1PathUtil.html#a7701bb16aec4cc526e657848447b6b83">bdls::PathUtil::appendRaw</a>(&amp;oldPath, <span class="stringliteral">&quot;old&quot;</span>);
  <a class="code" href="structbdls_1_1PathUtil.html#a7701bb16aec4cc526e657848447b6b83">bdls::PathUtil::appendRaw</a>(&amp;newPath, <span class="stringliteral">&quot;new&quot;</span>);
  <span class="keywordtype">int</span> rc = <a class="code" href="structbdls_1_1FilesystemUtil.html#acee8e6117d6907d4fd6f2725e098f9ae">bdls::FilesystemUtil::createDirectories</a>(oldPath, <span class="keyword">true</span>);
  assert(0 == rc);
  rc = <a class="code" href="structbdls_1_1FilesystemUtil.html#acee8e6117d6907d4fd6f2725e098f9ae">bdls::FilesystemUtil::createDirectories</a>(newPath, <span class="keyword">true</span>);
  assert(0 == rc);
</pre></div><br/>
<br/>
 We know that all of our log files match the pattern "*.log", so let's search for all such files in the log directory: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="structbdls_1_1PathUtil.html#a7701bb16aec4cc526e657848447b6b83">bdls::PathUtil::appendRaw</a>(&amp;logPath, <span class="stringliteral">&quot;*.log&quot;</span>);
  <a class="code" href="classbsl_1_1vector.html">bsl::vector&lt;bsl::string&gt;</a> logFiles;
  <a class="code" href="structbdls_1_1FilesystemUtil.html#aeaff1fd7c247091e669bfdb6f0654c4f">bdls::FilesystemUtil::findMatchingPaths</a>(&amp;logFiles, logPath.<a class="code" href="group__bslstl__string.html#gacef38ff51dcfc556fa13dda42a2665df">c_str</a>());
</pre></div><br/>
<br/>
 Now for each of these files, we will get the modification time. Files that are older than 2 days will be moved to "old", and the rest will be moved to "new": <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a> modTime;
  <a class="code" href="classbsl_1_1basic__string.html">bsl::string</a>   fileName;
  <span class="keywordflow">for</span> (<a class="code" href="group__bslstl__vector.html#ga24d7c145ce94bf2f3ae8068569c143b8">bsl::vector&lt;bsl::string&gt;::iterator</a> it = logFiles.<a class="code" href="group__bslstl__vector.html#ga5b7f9c7b9b0be302ee1b7533b9764ef1">begin</a>();
                                                it != logFiles.<a class="code" href="group__bslstl__vector.html#ga7eb9edf13eb71d39489477702fa09671">end</a>(); ++it) {
    assert(0 ==
               <a class="code" href="structbdls_1_1FilesystemUtil.html#a92ecfdd7a6fbecaabb7a4ff218058b9b">bdls::FilesystemUtil::getLastModificationTime</a>(&amp;modTime, *it));
    assert(0 == <a class="code" href="structbdls_1_1PathUtil.html#af8da856284a4b5a3f2604cd9f37c949f">bdls::PathUtil::getLeaf</a>(&amp;fileName, *it));
    <a class="code" href="classbsl_1_1basic__string.html">bsl::string</a> *whichDirectory =
                2 &lt; (<a class="code" href="structbdlt_1_1CurrentTime.html#a42d082242c48b7445d21cabbaec1b50b">bdlt::CurrentTime::utc</a>() - modTime).totalDays()
                ? &amp;oldPath
                : &amp;newPath;
    <a class="code" href="structbdls_1_1PathUtil.html#a7701bb16aec4cc526e657848447b6b83">bdls::PathUtil::appendRaw</a>(whichDirectory, fileName.<a class="code" href="group__bslstl__string.html#gacef38ff51dcfc556fa13dda42a2665df">c_str</a>());
    assert(0 == <a class="code" href="structbdls_1_1FilesystemUtil.html#a67adb857280699a27c26153b9146e702">bdls::FilesystemUtil::move</a>(it-&gt;c_str(),
                                         whichDirectory-&gt;<a class="code" href="group__bslstl__string.html#gacef38ff51dcfc556fa13dda42a2665df">c_str</a>()));
    <a class="code" href="structbdls_1_1PathUtil.html#ae80db28aaead0f4b571b6ed4e82d5c26">bdls::PathUtil::popLeaf</a>(whichDirectory);
  }
</pre></div><br/>
<br/>
 </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="example_2~3A_using_bdls~3A~3Afilesystemutil~3A~3Avisitpaths"></a> <a class="anchor" id="usage.example_2~3A_using_bdls~3A~3Afilesystemutil~3A~3Avisitpaths"></a> <a class="anchor" id="description.usage.example_2~3A_using_bdls~3A~3Afilesystemutil~3A~3Avisitpaths"></a> <a class="anchor" id="example_2"></a> <a class="anchor" id="usage.example_2"></a> <a class="anchor" id="description.usage.example_2"></a> <a class="anchor" id="3.7.2"></a> </dd></dl>
<dl class="user"><dt><b>Example 2: Using bdls::FilesystemUtil::visitPaths: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><code><a class="el" href="structbdls_1_1FilesystemUtil.html#ac2624b29e9562de9b813e432d35ab1cc">bdls::FilesystemUtil::visitPaths</a></code> enables clients to define a function object to operate on file paths that match a specified pattern. In this example, we create a function that can be used to filter out files that have a last modified time within a particular time frame. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>First we define our filtering function: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">void</span> getFilesWithinTimeframe(<a class="code" href="classbsl_1_1vector.html">bsl::vector&lt;bsl::string&gt;</a> *vector,
                               <span class="keyword">const</span> <span class="keywordtype">char</span>               *item,
                               <span class="keyword">const</span> <a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a>&amp;     start,
                               <span class="keyword">const</span> <a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a>&amp;     end)
  {
      <a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a> datetime;
      <span class="keywordtype">int</span> ret = <a class="code" href="structbdls_1_1FilesystemUtil.html#a92ecfdd7a6fbecaabb7a4ff218058b9b">bdls::FilesystemUtil::getLastModificationTime</a>(&amp;datetime,
                                                              item);

      <span class="keywordflow">if</span> (ret) {
          <span class="keywordflow">return</span>;                                                   <span class="comment">// RETURN</span>
      }

      <span class="keywordflow">if</span> (datetime &lt; start || datetime &gt; end) {
          <span class="keywordflow">return</span>;                                                   <span class="comment">// RETURN</span>
      }

      vector-&gt;<a class="code" href="group__bslstl__vector.html#gaa1d6a35af66d87307ee9a48be96644a5">push_back</a>(item);
  }
</pre></div><br/>
<br/>
 Then, with the help of <code><a class="el" href="structbdls_1_1FilesystemUtil.html#ac2624b29e9562de9b813e432d35ab1cc">bdls::FilesystemUtil::visitPaths</a></code> and <code><a class="el" href="structbdlf_1_1BindUtil.html#abed946d413bfd0d0abbe7f87b3ed16e4">bdlf::BindUtil::bind</a></code>, we create a function for finding all file paths that match a specified pattern and have a last modified time within a specified start and end time (both specified as a <code><a class="el" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a></code>): <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">void</span> findMatchingFilesInTimeframe(<a class="code" href="classbsl_1_1vector.html">bsl::vector&lt;bsl::string&gt;</a> *result,
                                    <span class="keyword">const</span> <span class="keywordtype">char</span>               *pattern,
                                    <span class="keyword">const</span> <a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a>&amp;     start,
                                    <span class="keyword">const</span> <a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a>&amp;     end)
  {
      result-&gt;<a class="code" href="group__bslstl__vector.html#gae9fa4fec3242df3b8c6a70118726304d">clear</a>();
      <a class="code" href="structbdls_1_1FilesystemUtil.html#ac2624b29e9562de9b813e432d35ab1cc">bdls::FilesystemUtil::visitPaths</a>(
                               pattern,
                               <a class="code" href="structbdlf_1_1BindUtil.html#abed946d413bfd0d0abbe7f87b3ed16e4">bdlf::BindUtil::bind</a>(&amp;getFilesWithinTimeframe,
                                                    result,
                                                    <a class="code" href="namespacebdlf_1_1PlaceHolders.html#a15d6194465744f5f4a1c9f98ca44ebca">bdlf::PlaceHolders::_1</a>,
                                                    start,
                                                    end));
  }
</pre></div><br/>
<br/>
 </dd></dl>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Apr 1 2016 16:48:47 for BDE Release 3.0 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
