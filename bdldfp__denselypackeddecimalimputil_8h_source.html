<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<title>BDE 3.0</title>
<html>
<pre>
// bdldfp_denselypackeddecimalimputil.h                               -*-C++-*-
#ifndef INCLUDED_BDLDFP_DENSELYPACKEDDECIMALIMPUTIL
#define INCLUDED_BDLDFP_DENSELYPACKEDDECIMALIMPUTIL

#ifndef INCLUDED_BSLS_IDENT
#include &lt;bsls_ident.h&gt;
#endif
BSLS_IDENT(&quot;$Id$&quot;)

//@PURPOSE: Utilities for working with Densely Packed Decimal representation.
//
//@CLASSES:
//  bdldfp::DenselyPackedDecimalImpUtil: namespace for DPD functions.
//
//@SEE_ALSO: bdldfp_decimal, bdldfp_decimalplatform
//
//@DESCRIPTION: This component provides a namespace,
// &#39;bdldfp::DenselyPackedDecimalImpUtil&#39;, that supplies a suite of functions
// for manipulating a Densely Packed Decimal (DPD) representation of a decimal
// floating point value.
//
///Usage
///-----
// This section shows the intended use of this component.
//
///Example 1: Get the DPD representation of a 10 digit binary number
///- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
// Decimal floating point numbers are used to represent, in human-convenient
// form, approximations of real-number values.  The Densely Packed Decimal
// format is a storage format which represents the significant digits of a
// value in a compressed Binary-Coded Decimal (BCD) format.  Densely Packed
// Decimal significands consist of a seqence of declets, each declet encoding 3
// decimal digits, in 10 bits.  The encoding is not a 1:1 mapping with the
// binary values corresponding to the decimal value of any three digits.
//
// In the following example we used &#39;DenselyPackedDecimalImpUtil&#39; to encode an
// integer value.  Suppose we have a 0 to 3 digit value which we want to encode
// in declet form, for use in &#39;DenselyPackedDecimal&#39; operations.
//
// First, we represent our decimal digits as an integer:
//..
//  int value = 842;
//..
// Now, we encode the integer using the &#39;encodeDeclet&#39; function:
//..
//  int asDeclet = bdldfp::DenselyPackedDecimalImpUtil::encodeDeclet(value);
//..
// Finally, we can confirm that the declet representation converts back to the
// binary representation of our three digits:
//..
//  assert(
//       value == bdldfp::DenselyPackedDecimalImpUtil::decodeDeclet(asDeclet));
//..

#ifndef INCLUDED_BDLSCM_VERSION
#include &lt;bdlscm_version.h&gt;
#endif

#ifndef INCLUDED_BDLDFP_DECIMALPLATFORM
#include &lt;bdldfp_decimalplatform.h&gt;
#endif

#ifndef INCLUDED_BDLDFP_UINT128
#include &lt;bdldfp_uint128.h&gt;
#endif

namespace BloombergLP {
namespace bdldfp {

                        // =================================
                        // class DenselyPackedDecimalImpUtil
                        // =================================

struct DenselyPackedDecimalImpUtil {
    // This &#39;struct&#39; provides a namespace for functions that provide common DPD
    // formatted decimal floating point.

    // TYPES
    typedef unsigned           int StorageType32;
    typedef unsigned long long int StorageType64;
    typedef bdldfp::Uint128        StorageType128;

    // CLASS METHODS
    static unsigned encodeDeclet(unsigned digits);
        // Return an unsigned integer whose bits encode the value of the
        // specified &#39;digits&#39; in the Densely Packed Decimal (DPD) format.  The
        // behavior is undefined unless &#39;0 &lt;= digits &lt; 1000&#39;.  Note that the
        // result will be a bit pattern whose binary representation corresponds
        // to a value in the range &#39;[0, 1024]&#39;.  Also note that this function
        // encodes a *single* declet (not a complete DPD decimal floating point
        // representation), and returns an &#39;unsigned int&#39; as it is intended for
        // use with raw bit manipulation functions.

    static unsigned decodeDeclet(unsigned declet);
        // Return the (unsigned integer) value encoded in the specified
        // &#39;declet&#39;.  The behavior is undefined unless the binary value of
        // &#39;declet &lt; 1024&#39;, &#39;declet&#39; is encoded in Densely Packed Decimal
        // (DPD), and every unused bit in the densely packed state is set to 0.
        // Note that the result will be an integer in the range &#39;[0, 999]&#39;.
        // Also note that this function decodes a *single* declet (not a
        // complete DPD decimal floating point representation), and returns
        // &#39;unsigned int&#39; type values, as it is intended for use with raw bit
        // manipulation functions.

    static StorageType32 makeDecimalRaw32(int significand, int exponent);
        // Return a &#39;StorageType32&#39; object representing a decimal floating
        // point number consisting of the specified &#39;significand&#39; and
        // &#39;exponent&#39;, with the sign given by the &#39;significand&#39;.  If
        // &#39;significand&#39; is 0, the result is 0 but the quanta of the result is
        // unspecified.  The behavior is undefined unless
        // &#39;abs(significand) &lt;= 9,999,999&#39; and &#39;-101 &lt;= exponent &lt;= 90&#39;.

    static StorageType64 makeDecimalRaw64(unsigned long long int significand,
                                                             int exponent);
    static StorageType64 makeDecimalRaw64(         long long int significand,
                                                             int exponent);
    static StorageType64 makeDecimalRaw64(unsigned           int significand,
                                                             int exponent);
    static StorageType64 makeDecimalRaw64(                   int significand,
                                                             int exponent);
        // Create a &#39;StorageType64&#39; object representing a decimal floating
        // point number consisting of the specified &#39;significand&#39; and
        // &#39;exponent&#39;, with the sign given by the &#39;significand&#39;.  If
        // &#39;significand&#39; is 0, the result is 0 but the quanta of the result is
        // unspecified.  The behavior is undefined unless
        // &#39;abs(significand) &lt;= 9,999,999,999,999,999&#39; and
        // &#39;-398 &lt;= exponent &lt;= 369&#39;.

    static StorageType128 makeDecimalRaw128(unsigned long long int significand,
                                                               int exponent);
    static StorageType128 makeDecimalRaw128(         long long int significand,
                                                               int exponent);
    static StorageType128 makeDecimalRaw128(unsigned           int significand,
                                                               int exponent);
    static StorageType128 makeDecimalRaw128(                   int significand,
                                                               int exponent);
        // Create a &#39;StorageType128&#39; object representing a decimal floating
        // point number consisting of the specified &#39;significand&#39; and
        // &#39;exponent&#39;, with the sign given by the &#39;significand&#39;.  If
        // &#39;significand&#39; is 0, the result is 0 but the quanta of the result is
        // unspecified.  The behavior is undefined unless
        // &#39;-6176 &lt;= exponent &lt;= 6111&#39;.
};

}  // close package namespace
}  // close enterprise namespace

#endif

// ----------------------------------------------------------------------------
// Copyright 2014 Bloomberg Finance L.P.
//
// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
// ----------------------------- END-OF-FILE ----------------------------------
</pre>
</body>
</html>
