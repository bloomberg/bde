<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>BDE 2.23.1 OSS: bdlc_packedintarray Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <style>
      div.hanging {
        padding-left: 0.75in;
        text-indent: -0.50in;
      }
      div.unhanging {
        text-indent:     0in;
      }
      a.glossary {
        font-weight: bold;
        font-style: italic;
      }
    </style>
</head>
<!--
<body onload='searchBox.OnSelectItem(0);'>
-->
<body>

<table border=2 cellspacing=0 cellpadding=0 align=center>
<tr>
 <td valign=top align=center>
 <p align=center><b><i>Quick Links:</i></b></p>
 </td>
 <td valign=top align=center>
 <p align=center>
<a class="qindex" href="group__bdl.html" target="_blank">bdl</a> | <a class="qindex" href="group__bsl.html" target="_blank">bsl</a>
 </td>
 </tr>
 </table>

  </div>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="components.html"><span>Components</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<h1>Component bdlc_packedintarray<br/>
<small>
[<a class="el" href="group__bdlc.html">Package bdlc</a>]</small>
</h1>  </div>
</div>
<div class="contents">

<p>Provide an extensible, packed array of integral values.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebdlc.html">bdlc</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="user"><dt><b>Outline</b></dt><dd><ul>
<li>
<a href="#1">Purpose</a> </li>
<li>
<a href="#2">Classes</a> </li>
<li>
<a href="#3">Description</a> <ul>
<li>
<a href="#3.1">Usage</a> <ul>
<li>
<a href="#3.1.1">Example 1: <code>Temperature Map</code></a> </li>
</ul>
</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="purpose"></a> <a class="anchor" id="1"></a> </dd></dl>
<dl class="user"><dt><b>Purpose: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Provide an extensible, packed array of integral values. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="classes"></a> <a class="anchor" id="2"></a> </dd></dl>
<dl class="user"><dt><b>Classes: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><table class="doxtable">
<tr>
<td><a class="el" href="classbdlc_1_1PackedIntArray.html">bdlc::PackedIntArray</a> </td><td>packed array of integral values  </td></tr>
<tr>
<td><a class="el" href="classbdlc_1_1PackedIntArrayConstIterator.html">bdlc::PackedIntArrayConstIterator</a> </td><td>bidirectional <code>const_iterator</code>  </td></tr>
</table>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="description"></a> <a class="anchor" id="3"></a> </dd></dl>
<dl class="user"><dt><b>Description: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This component provides a space-efficient value-semantic array class template, <code><a class="el" href="classbdlc_1_1PackedIntArray.html">bdlc::PackedIntArray</a></code>, and an associated iterator, <code><a class="el" href="classbdlc_1_1PackedIntArrayConstIterator.html">bdlc::PackedIntArrayConstIterator</a></code>, that provides non-modifiable access to its elements. The interface of this class provides the user with functionality similar to a <code><a class="el" href="classbsl_1_1vector.html">bsl::vector</a>&lt;int&gt;</code>. The implementation is designed to reduce dynamic memory usage by storing its contents differently according to the magnitude of values placed within it. The user need not be concerned with the internal representation of the data. The array supports primitive operations (e.g., insertion, look-up, removal) as well as a complete set of value-semantic operations; however, direct reference to individual elements is not available. Users can access the value of individual elements by calling the indexing operator or via iterators. Note that iterators are <em>not</em> invalidated if an array object reallocates memory. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="usage"></a> <a class="anchor" id="description.usage"></a> <a class="anchor" id="3.1"></a> </dd></dl>
<dl class="user"><dt><b>Usage: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This section illustrates intended use of this component. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="example_1~3A_temperature_map"></a> <a class="anchor" id="usage.example_1~3A_temperature_map"></a> <a class="anchor" id="description.usage.example_1~3A_temperature_map"></a> <a class="anchor" id="example_1"></a> <a class="anchor" id="usage.example_1"></a> <a class="anchor" id="description.usage.example_1"></a> <a class="anchor" id="3.1.1"></a> </dd></dl>
<dl class="user"><dt><b>Example 1: Temperature Map: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>There exist many applications in which the range of <code>int</code> data that a container will hold is not known at design time. This means in order to build a robust component one must default to <code><a class="el" href="classbsl_1_1vector.html">bsl::vector</a>&lt;int&gt;</code>, which for many applications is excessive in its usage of space. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Suppose we are creating a map of temperatures for every city in the United States for every day. This represents a large body of data, most of which is easily representable in a <code>signed char</code>, and in only rare situations is a <code>short</code> required. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>To be able to represent all possible values for all areas and times, including extremes like Death Valley, a traditional implementation would require use of a <code>vector&lt;short&gt;</code> for each day for each area. This is excessive for all but the most extreme values, and therefore wasteful for this map as a whole. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>We can use <code><a class="el" href="classbdlc_1_1PackedIntArray.html">bdlc::PackedIntArray</a></code> to efficiently store this data. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>First, we declare and define a <code>my_Date</code> class. This class is very similar to <code><a class="el" href="classbdlt_1_1Date.html">bdlt::Date</a></code>, and therefore is elided for the sake of compactness. <br/>
<br/>
<div class="fragment"><pre class="fragment">                              <span class="comment">// =======</span>
                              <span class="comment">// my_Date</span>
                              <span class="comment">// =======</span>
  <span class="keyword">class </span>my_Date {
      <span class="comment">// A (value-semantic) attribute class that provides a very simple date.</span>
      <span class="keywordtype">signed</span> <span class="keywordtype">char</span> d_day;    <span class="comment">// the day</span>
      <span class="keywordtype">signed</span> <span class="keywordtype">char</span> d_month;  <span class="comment">// the month</span>
      <span class="keywordtype">int</span>         d_year;   <span class="comment">// the year</span>

      <span class="comment">// FRIENDS</span>
      <span class="keyword">friend</span> <span class="keywordtype">bool</span> <a class="code" href="namespacebdlb.html#ad07f3843b29d0d2bdc6cad3e1fa4a009">operator&lt;</a>(<span class="keyword">const</span> my_Date&amp;, <span class="keyword">const</span> my_Date&amp;);

    <span class="keyword">public</span>:
      <span class="comment">// CREATORS</span>
      <span class="keyword">explicit</span> my_Date(<span class="keywordtype">int</span>         year  = 1,
                       <span class="keywordtype">signed</span> <span class="keywordtype">char</span> month = 1,
                       <span class="keywordtype">signed</span> <span class="keywordtype">char</span> day   = 1);
          <span class="comment">// Create a &#39;my_Date&#39; object having the optionally specified &#39;day&#39;,</span>
          <span class="comment">// &#39;month&#39;, and &#39;year&#39;. Each, if unspecified, will default to 1.</span>
  };

  <span class="keywordtype">bool</span> <a class="code" href="namespacebdlb.html#ad07f3843b29d0d2bdc6cad3e1fa4a009">operator&lt;</a>(<span class="keyword">const</span> my_Date&amp; lhs, <span class="keyword">const</span> my_Date&amp; rhs);
      <span class="comment">// Return &#39;true&#39; if the specified &#39;lhs&#39; represents an earlier date than</span>
      <span class="comment">// the specified &#39;rhs&#39; object, and &#39;false&#39; otherwise.</span>

                          <span class="comment">// -------</span>
                          <span class="comment">// my_Date</span>
                          <span class="comment">// -------</span>
  <span class="comment">// CREATORS</span>
  <span class="keyword">inline</span>
  my_Date::my_Date(<span class="keywordtype">int</span> year, <span class="keywordtype">signed</span> <span class="keywordtype">char</span> month , <span class="keywordtype">signed</span> <span class="keywordtype">char</span> day)
  : d_day(day)
  , d_month(month)
  , d_year(year)
  {
  }

  <span class="keywordtype">bool</span> <a class="code" href="namespacebdlb.html#ad07f3843b29d0d2bdc6cad3e1fa4a009">operator&lt;</a>(<span class="keyword">const</span> my_Date&amp; lhs, <span class="keyword">const</span> my_Date&amp; rhs)
  {
      <span class="keywordflow">return</span> 10000 * lhs.d_year + 100 * lhs.d_month + lhs.d_day &lt;
             10000 * rhs.d_year + 100 * rhs.d_month + rhs.d_day;
  }
</pre></div><br/>
<br/>
 Then, we create our TemperatureMap, which is a map of dates to a map of zip codes to a <code>PackedIntArray</code> of temperatures. Each <code>PackedIntArray</code> has entries for each temperature from 12 A.M, to 11 P.M for each city in each zip code. Notice that we use a <code>PackedIntArray</code> to hold the data compactly. <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbsl_1_1map.html">bsl::map&lt;my_Date, bsl::map&lt;int, bdlc::PackedIntArray&lt;int&gt;</a> &gt; &gt;
                                                              temperatureMap;
</pre></div><br/>
<br/>
 Next, we add data to the map (provided by the National Weather Service) for a normal case, and the extreme. <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbdlc_1_1PackedIntArray.html">bdlc::PackedIntArray&lt;int&gt;</a>&amp; nyc
                         = temperatureMap[my_Date(2013, 9, 06)][10023];
  <a class="code" href="classbdlc_1_1PackedIntArray.html">bdlc::PackedIntArray&lt;int&gt;</a>&amp; dValley
                         = temperatureMap[my_Date(1913, 7, 10)][92328];

  <span class="keywordtype">int</span> nycTemperatures[24]  = {60,  58, 57,  56, 55,  54,  54,  55,
                              56,  59, 61,  64, 66,  67,  69,  69,
                              70,  70, 68,  67, 65,  63,  61,  60};

  <span class="keywordtype">int</span> deathValleyTemps[24] = {65,  55, 50, 47,  62,  75,  77,  89,
                              91,  92, 95, 110, 113, 121, 134, 126,
                              113, 99, 96, 84,  79,  81,  73,  69};
</pre></div><br/>
<br/>
 Then, since the size of the data set is known at design time, as well as extreme values for the areas, we can use the <code>reserveCapacity()</code> method to give the container hints about the data to come. <br/>
<br/>
<div class="fragment"><pre class="fragment">  nyc.<a class="code" href="classbdlc_1_1PackedIntArray.html#a6bf7d55bcac06723e88e43144d23b36c">reserveCapacity</a>(    24, 50, 108);
  dValley.<a class="code" href="classbdlc_1_1PackedIntArray.html#a6bf7d55bcac06723e88e43144d23b36c">reserveCapacity</a>(24, 45, 134);
</pre></div><br/>
<br/>
 Now, we add the data to the respective containers. <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keywordflow">for</span> (bsl::size_t i= 0; i &lt; 24; ++i) {
      nyc.<a class="code" href="classbdlc_1_1PackedIntArray.html#aab5d3873fb0db748990e04cbff99d944">append</a>(nycTemperatures[i]);
      dValley.<a class="code" href="classbdlc_1_1PackedIntArray.html#aab5d3873fb0db748990e04cbff99d944">append</a>(deathValleyTemps[i])
  }
</pre></div><br/>
<br/>
 Finally, notice that in order to represent these values in a <code>PackedIntArray</code>, it required <code>24 * sizeof(signed char)</code> bytes (24 on most systems) of dynamic memory for <code>nyc</code>, which represents the normal case for this data. A <code>vector&lt;short&gt;</code> would require <code>24 * sizeof(short)</code> bytes (48 on most systems) of dynamic memory to represent the same data. <br/>
<br/>
<div class="fragment"><pre class="fragment">  assert(static_cast&lt;int&gt;(<span class="keyword">sizeof</span>(<span class="keywordtype">signed</span> <span class="keywordtype">char</span>)) == nyc.<a class="code" href="classbdlc_1_1PackedIntArray.html#a7be44187ff8a8dedf447d354ab6353c2">bytesPerElement</a>());
  assert(                                   24 == nyc.<a class="code" href="classbdlc_1_1PackedIntArray.html#a1f6b44a57fd52b9c698d8947de5db05a">length</a>());
</pre></div><br/>
<br/>
 </dd></dl>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Jun 2 2015 13:40:19 for BDE Release 2.23.1 OSS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
