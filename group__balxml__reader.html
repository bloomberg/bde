<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>BDE 3.0: balxml_reader Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <style>
      div.hanging {
        padding-left: 0.75in;
        text-indent: -0.50in;
      }
      div.unhanging {
        text-indent:     0in;
      }
      a.glossary {
        font-weight: bold;
        font-style: italic;
      }
    </style>
</head>
<!--
<body onload='searchBox.OnSelectItem(0);'>
-->
<body>

<table border=2 cellspacing=0 cellpadding=0 align=center>
<tr>
 <td valign=top align=center>
 <p align=center><b><i>Quick Links:</i></b></p>
 </td>
 <td valign=top align=center>
 <p align=center>
<a class="qindex" href="group__bal.html" target="_blank">bal</a> | <a class="qindex" href="group__bbl.html" target="_blank">bbl</a> | <a class="qindex" href="group__bdl.html" target="_blank">bdl</a> | <a class="qindex" href="group__bsl.html" target="_blank">bsl</a> | <a class="qindex" href="group__btl.html" target="_blank">btl</a>
 </td>
 </tr>
 </table>

  </div>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="components.html"><span>Components</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<h1>Component balxml_reader<br/>
<small>
[<a class="el" href="group__balxml.html">Package balxml</a>]</small>
</h1>  </div>
</div>
<div class="contents">

<p>Provide common reader protocol for parsing XML documents.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebalxml.html">balxml</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="user"><dt><b>Outline</b></dt><dd><ul>
<li>
<a href="#1">Purpose</a> </li>
<li>
<a href="#2">Classes</a> </li>
<li>
<a href="#3">Description</a> <ul>
<li>
<a href="#3.1">Node Type</a> </li>
<li>
<a href="#3.2">Qualified and local names</a> </li>
<li>
<a href="#3.3">Base URI</a> </li>
<li>
<a href="#3.4">Encoding</a> </li>
<li>
<a href="#3.5">Thread Safety</a> </li>
<li>
<a href="#3.6">Usage</a> </li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="purpose"></a> <a class="anchor" id="1"></a> </dd></dl>
<dl class="user"><dt><b>Purpose: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Provide common reader protocol for parsing XML documents. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="classes"></a> <a class="anchor" id="2"></a> </dd></dl>
<dl class="user"><dt><b>Classes: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><table class="doxtable">
<tr>
<td><a class="el" href="classbalxml_1_1Reader.html">balxml::Reader</a> </td><td>protocol for fast, forward-only access to XML data stream  </td></tr>
</table>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__balxml__validatingreader.html" title="Provide a common reader protocol for parsing and validating XML.">Component balxml_validatingreader</a>, <a class="el" href="group__balxml__elementattribute.html" title="Provide the properties of an attribute in an XML element tag.">Component balxml_elementattribute</a>, <a class="el" href="classbalxml_1_1ErrorInfo.html">balxml::ErrorInfo</a>, <a class="el" href="group__balxml__prefixstack.html" title="Provide a unique integer ID for each XML namespace.">Component balxml_prefixstack</a>, <a class="el" href="group__balxml__namespaceregistry.html" title="Provide a unique integer ID for each XML namespace.">Component balxml_namespaceregistry</a> </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="description"></a> <a class="anchor" id="3"></a> </dd></dl>
<dl class="user"><dt><b>Description: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This component supplies an abstract class, <code><a class="el" href="classbalxml_1_1Reader.html">balxml::Reader</a></code> that defines an interface for accessing a forward-only, read-only stream of XML data. The <code><a class="el" href="classbalxml_1_1Reader.html">balxml::Reader</a></code> interface is somewhat similar to Microsoft XmlReader interface, which provides a simpler and more flexible programming model than the quasi-standard SAX/SAX2 model and a (potentially) more memory-efficient programming model than DOM. Access to the data is done in a cursor-like fashion, going forward on the document stream and stopping at each node along the way. A "node" is an XML syntactic construct such as the start of an element, the end of an element, element text, etc.. (See the <code><a class="el" href="classbalxml_1_1Reader.html#a96d821892acdd3b8565421be14c438f3">balxml::Reader::NodeType</a></code> enumeration for a complete list.) Note that, unlike the Microsoft interace, an element attribute is <em>not</em> considered a node in this interface, but is rather considered an attribute of a start-element node. In the documentation below the "current node" refers to the node on which the reader is currently positioned. The client code advances through all of the nodes in the XML document by calling the <code>advanceToNextNode</code> function repeatedly and processing each node in the order it appears in the xml document. </dd></dl>
<dl class="user"><dt><b></b></dt><dd><code><a class="el" href="classbalxml_1_1Reader.html">balxml::Reader</a></code> supplies accessors that query a node's attributes, such as the node's type, name, value, element attributes, etc.. Note that each call to <code>advanceToNextNode</code> invalidates strings and data structures returned when the <code><a class="el" href="classbalxml_1_1Reader.html">balxml::Reader</a></code> accessors were call for the prior node. E.g., the pointer returned from <code>nodeName</code> for one node will <em>not</em> be valid once the reader has advanced to the next node. The fact that this interface provides so little prior context gives the derived-class implementations the potential to be very efficient in their use of memory. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Any derived class must adhere to the class-level and function-level contract documented in this component. Note that an object of a derived class implementation must be reusable such that, after parsing one document, the reader can be closed and re-opened to parse another document. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="node_type"></a> <a class="anchor" id="description.node_type"></a> <a class="anchor" id="3.1"></a> </dd></dl>
<dl class="user"><dt><b>Node Type: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>An enumeration value that identifies a node as a specific XML construct, e.g., ELEMENT, END_ELEMENT, TEXT, CDATA, etc. (See the <code><a class="el" href="classbalxml_1_1Reader.html#a96d821892acdd3b8565421be14c438f3">balxml::Reader::NodeType</a></code> enumeration for a complete list.) </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="qualified_and_local_names"></a> <a class="anchor" id="description.qualified_and_local_names"></a> <a class="anchor" id="3.2"></a> </dd></dl>
<dl class="user"><dt><b>Qualified and local names: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>XML documents may contain some qualified names. These are names with a prefix (optional) and a local name, separated by a colon. (The colon is present only if the prefix is present.) The prefix is a (typically short) word that is associated with a namespace URI via a namespace declaration. The local name specifies an entity within the specified namespace or, if no prefix is given, within the default namespace. For each qualified name, the <code><a class="el" href="classbalxml_1_1Reader.html">balxml::Reader</a></code> interface provides access to the entire qualified name and separate access to the prefix, the local name, the namespace URI, and the namespace ID. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="base_uri"></a> <a class="anchor" id="description.base_uri"></a> <a class="anchor" id="3.3"></a> </dd></dl>
<dl class="user"><dt><b>Base URI: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Networked XML documents may comprise chunks of data aggregated using various W3C standard inclusion mechanisms and can contain nodes that come from different places. DTD entities are an example of this. The base URI tells you where a node comes from (see <a href="http://www.w3.org/TR/xmlbase/">http://www.w3.org/TR/xmlbase/</a>). The base URI of an element is: </dd></dl>
<dl class="user"><dt><b></b></dt><dd><ol>
<li>
The base URI specified by an xml:base attribute on the element, if one exists, otherwise  </li>
<li>
The base URI of the element's parent element within the document or external entity, if one exists, otherwise  </li>
<li>
The base URI of the document entity or external entity containing the element.  </li>
</ol>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd>If there is no base URI for a node being returned (for example, it was parsed from an in-memory string), then <code>nodeBaseUri</code> return an empty string. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="encoding"></a> <a class="anchor" id="description.encoding"></a> <a class="anchor" id="3.4"></a> </dd></dl>
<dl class="user"><dt><b>Encoding: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>A XML document or any external reference (such as expanding an entity in a DTD file or reading a schema file) will be encoded, for example, in "ASCII," "UTF-8," or "UTF-16". The document can also contain self-describing information as to which encoding was used when the document was created. Note that the encoding returned from the <code>documentEncoding</code> method can differ from the encoding of the strings returned from the <code><a class="el" href="classbalxml_1_1Reader.html">balxml::Reader</a></code> accessors; all strings returned by these accessors are UTF-8 regardless of the encoding used in the original document. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>If encoding information is not provided in the document, the <code><a class="el" href="classbalxml_1_1Reader.html#a4e2febd7c2f865970e5abad75a71fdf4">balxml::Reader::open</a></code> method allows clients to specify an encoding to use. The encoding passed to <code><a class="el" href="classbalxml_1_1Reader.html#a4e2febd7c2f865970e5abad75a71fdf4">balxml::Reader::open</a></code> will take effect only when there is no encoding information in the original document, i.e., the encoding information obtained from the original document trumps all. If there is no encoding provided within the document and the client has not provided one via the <code><a class="el" href="classbalxml_1_1Reader.html#a4e2febd7c2f865970e5abad75a71fdf4">balxml::Reader::open</a></code> method, then a derived-class implementation should set the encoding to UTF-8. (See the <code><a class="el" href="classbalxml_1_1Reader.html#a4e2febd7c2f865970e5abad75a71fdf4">balxml::Reader::open</a></code> method for more details.) </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="thread_safety"></a> <a class="anchor" id="description.thread_safety"></a> <a class="anchor" id="3.5"></a> </dd></dl>
<dl class="user"><dt><b>Thread Safety: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This component does not provide any functions that present a thread safety issue, since the <code><a class="el" href="classbalxml_1_1Reader.html">balxml::Reader</a></code> class is abstract and cannot be instantiated. There is no guarantee that any specific derived class will provide a thread-safe implementation. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="usage"></a> <a class="anchor" id="description.usage"></a> <a class="anchor" id="3.6"></a> </dd></dl>
<dl class="user"><dt><b>Usage: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>In this example, we will create a simple parser that prints out the contents of each node in an XML document. <br/>
<br/>
<div class="fragment"><pre class="fragment"><span class="preprocessor">  #include &lt;<a class="code" href="balxml__reader_8h.html" title="Provide common reader protocol for parsing XML documents.">balxml_reader.h</a>&gt;</span>
<span class="preprocessor">  #include &lt;<a class="code" href="balxml__errorinfo_8h.html" title="Provide common error information for XML components.">balxml_errorinfo.h</a>&gt;</span>
<span class="preprocessor">  #include &lt;iostream&gt;</span>
</pre></div><br/>
<br/>
 The <code>processNode</code> function prints the node's contents: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">void</span>  processNode(<a class="code" href="classbalxml_1_1Reader.html">balxml::Reader</a> *reader)
  {
      <a class="code" href="classbalxml_1_1Reader.html#a96d821892acdd3b8565421be14c438f3">balxml::Reader::NodeType</a> nodeType = reader-&gt;<a class="code" href="classbalxml_1_1Reader.html#a4b4d7656699f1c66fc052e753f2a19dc">nodeType</a>();
      <span class="keyword">const</span> <span class="keywordtype">char</span>  *name  = reader-&gt;<a class="code" href="classbalxml_1_1Reader.html#ae3854574e8ca51c846da858bc089e4a6">nodeName</a>();
      <span class="keyword">const</span> <span class="keywordtype">char</span>  *value = reader-&gt;<a class="code" href="classbalxml_1_1Reader.html#af446508cd5cc4caf9202c20297802a9d">nodeValue</a>();

      <span class="keywordflow">if</span> (!name)    name  = <span class="stringliteral">&quot;&quot;</span>;
      <span class="keywordflow">if</span> (!value)   value = <span class="stringliteral">&quot;&quot;</span>;

      bsl::cout &lt;&lt; <span class="stringliteral">&quot;Node: type=&quot;</span>
                &lt;&lt; nodeType
                &lt;&lt; <span class="stringliteral">&quot;(&quot;</span>
                &lt;&lt; <a class="code" href="classbalxml_1_1Reader.html#a62b917e5b4aecd944e1d6c129af8937a">balxml::Reader::nodeTypeAsString</a>(nodeType)
                &lt;&lt; <span class="stringliteral">&quot;) name=&quot;</span> &lt;&lt; name
                &lt;&lt; <span class="stringliteral">&quot; value=&quot;</span> &lt;&lt; value
                &lt;&lt; bsl::endl;
</pre></div><br/>
<br/>
 If the node has attributes, then iterate through them: <br/>
<br/>
<div class="fragment"><pre class="fragment">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; reader-&gt;<a class="code" href="classbalxml_1_1Reader.html#afd4b002d0859bc45b28e8a140640ba65">numAttributes</a>(); ++i) {
          ElementAttribute attr;
          reader-&gt;<a class="code" href="classbalxml_1_1Reader.html#a95fec9fda7e752a1b44d0ef90673c5a7">lookupAttribute</a>(&amp;attr, i);

          name  = attr.name();
          value = attr.value();

          <span class="keywordflow">if</span> (!name)    name  = <span class="stringliteral">&quot;&quot;</span>;
          <span class="keywordflow">if</span> (!value)   value = <span class="stringliteral">&quot;&quot;</span>;

          bsl::cout &lt;&lt; <span class="stringliteral">&quot;Attribute: name=&quot;</span> &lt;&lt; name
                    &lt;&lt; <span class="stringliteral">&quot; value=&quot;</span> &lt;&lt; value
                    &lt;&lt; bsl::endl;
      }
  }
</pre></div><br/>
<br/>
 The main parser function must construct a namespace registry and a prefix stack before opening the data stream: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">int</span> parse(<a class="code" href="classbalxml_1_1Reader.html">balxml::Reader</a> *reader, <span class="keyword">const</span> <span class="keywordtype">char</span>* xmlData)
  {
      <a class="code" href="classbalxml_1_1NamespaceRegistry.html">balxml::NamespaceRegistry</a> namespaces;
      <a class="code" href="classbalxml_1_1PrefixStack.html">balxml::PrefixStack</a> prefixes(&amp;namespaces);
      reader-&gt;<a class="code" href="classbalxml_1_1Reader.html#a17099694cfbee74686c799fc3a68883b">setPrefixStack</a>(&amp;prefixes);
      reader-&gt;<a class="code" href="classbalxml_1_1Reader.html#a4e2febd7c2f865970e5abad75a71fdf4">open</a>(xmlData, bsl::strlen(xmlData));
</pre></div><br/>
<br/>
 Then it simply traverses each node and calls <code>processNode</code>: <br/>
<br/>
<div class="fragment"><pre class="fragment">      <span class="keywordtype">int</span> rc;
      <span class="keywordflow">while</span> (! (rc = reader-&gt;<a class="code" href="classbalxml_1_1Reader.html#a277ab8dd9f06507b115b96e39002faf7">advanceToNextNode</a>()) {
          processNode(reader);
      }
</pre></div><br/>
<br/>
 If an error occurred, display the error: <br/>
<br/>
<div class="fragment"><pre class="fragment">      <span class="keywordflow">if</span> (rc &lt; 0) {
          bsl::cout &lt;&lt; reader-&gt;<a class="code" href="classbalxml_1_1Reader.html#abcc1bf177fe83320f7a8801838708967">errorInfo</a>();
          <span class="keywordflow">return</span> -rc;
      }

      <span class="keywordflow">return</span> 0;
  }
</pre></div><br/>
<br/>
 </dd></dl>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Apr 1 2016 16:48:32 for BDE Release 3.0 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
