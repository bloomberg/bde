<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>BDE 3.0: bdlat_choicefunctions Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <style>
      div.hanging {
        padding-left: 0.75in;
        text-indent: -0.50in;
      }
      div.unhanging {
        text-indent:     0in;
      }
      a.glossary {
        font-weight: bold;
        font-style: italic;
      }
    </style>
</head>
<!--
<body onload='searchBox.OnSelectItem(0);'>
-->
<body>

<table border=2 cellspacing=0 cellpadding=0 align=center>
<tr>
 <td valign=top align=center>
 <p align=center><b><i>Quick Links:</i></b></p>
 </td>
 <td valign=top align=center>
 <p align=center>
<a class="qindex" href="group__bal.html" target="_blank">bal</a> | <a class="qindex" href="group__bbl.html" target="_blank">bbl</a> | <a class="qindex" href="group__bdl.html" target="_blank">bdl</a> | <a class="qindex" href="group__bsl.html" target="_blank">bsl</a> | <a class="qindex" href="group__btl.html" target="_blank">btl</a>
 </td>
 </tr>
 </table>

  </div>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="components.html"><span>Components</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<h1>Component bdlat_choicefunctions<br/>
<small>
[<a class="el" href="group__bdlat.html">Package bdlat</a>]</small>
</h1>  </div>
</div>
<div class="contents">

<p>Provide a namespace defining choice functions.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebdlat__ChoiceFunctions.html">bdlat_ChoiceFunctions</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="user"><dt><b>Outline</b></dt><dd><ul>
<li>
<a href="#1">Purpose</a> </li>
<li>
<a href="#2">Classes</a> </li>
<li>
<a href="#3">Description</a> <ul>
<li>
<a href="#3.1">Usage</a> </li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="purpose"></a> <a class="anchor" id="1"></a> </dd></dl>
<dl class="user"><dt><b>Purpose: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Provide a namespace defining choice functions. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="classes"></a> <a class="anchor" id="2"></a> </dd></dl>
<dl class="user"><dt><b>Classes: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><table class="doxtable">
<tr>
<td><a class="el" href="namespacebdlat__ChoiceFunctions.html">bdlat_ChoiceFunctions</a> </td><td>namespace for calling choice functions  </td></tr>
</table>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__bdlat__selectioninfo.html" title="Provide a container for selection information.">Component bdlat_selectioninfo</a> </dd></dl>
<dl class="user"><dt><b></b></dt><dd>TBD: update this documentation to reflect the new overloaded functions </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="description"></a> <a class="anchor" id="3"></a> </dd></dl>
<dl class="user"><dt><b>Description: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The <code><a class="el" href="namespacebdlat__ChoiceFunctions.html">bdlat_ChoiceFunctions</a></code> <code>namespace</code> provided in this component defines parameterized functions that expose "choice" behavior for "choice" types. See the package-level documentation for a full description of "choice" types. The functions in this namespace allow users to: <br/>
<br/>
<div class="fragment"><pre class="fragment">  o make a selection <span class="keyword">using</span> either a selection <span class="keywordtype">id</span> or a selection name
    (<span class="stringliteral">&#39;makeSelection&#39;</span>).
  o manipulate the current selection <span class="keyword">using</span> a parameterized manipulator
    (<span class="stringliteral">&#39;manipulateSelection&#39;</span>).
  o access the current selection <span class="keyword">using</span> a parameterized accessor
    (<span class="stringliteral">&#39;accessSelection&#39;</span>).
  o obtain the <span class="keywordtype">id</span> <span class="keywordflow">for</span> the current selection (<span class="stringliteral">&#39;selectionId&#39;</span>).
</pre></div><br/>
<br/>
 Also, the meta-function <code>IsChoice</code> contains a compile-time constant <code>VALUE</code> that is non-zero if the parameterized <code>TYPE</code> exposes "choice" behavior through the <code><a class="el" href="namespacebdlat__ChoiceFunctions.html">bdlat_ChoiceFunctions</a></code> <code>namespace</code>. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>This component specializes all of these functions for types that have the <code><a class="el" href="structbdlat__TypeTraitBasicChoice.html">bdlat_TypeTraitBasicChoice</a></code> trait. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Types that do not have the <code><a class="el" href="structbdlat__TypeTraitBasicChoice.html">bdlat_TypeTraitBasicChoice</a></code> trait can be plugged into the <code>bdlat</code> framework. This is done by overloading the <code>bdlat_choice*</code> functions inside the namespace of the plugged in type. For example, suppose there is a type called <code>mine::MyChoice</code>. In order to plug this type into the <code>bdlat</code> framework as a "Choice", the following functions must be declared and implemented in the <code>mine</code> namespace: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="comment">// MANIPULATORS</span>
  <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#aaadb9291f97777a5a710b687e1a27445">bdlat_choiceMakeSelection</a>(MyChoice *<span class="keywordtype">object</span>, <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#ab8461ed36360e692ad84955eee029a87">selectionId</a>);
      <span class="comment">// Set the value of the specified &#39;object&#39; to be the default for</span>
      <span class="comment">// the selection indicated by the specified &#39;selectionId&#39;.  Return</span>
      <span class="comment">// 0 on success, and non-zero value otherwise (i.e., the selection</span>
      <span class="comment">// is not found).</span>

  <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#aaadb9291f97777a5a710b687e1a27445">bdlat_choiceMakeSelection</a>(MyChoice  *<span class="keywordtype">object</span>,
                                <span class="keyword">const</span> <span class="keywordtype">char</span> *selectionName,
                                <span class="keywordtype">int</span>         selectionNameLength);
      <span class="comment">// Set the value of the specified &#39;object&#39; to be the default for</span>
      <span class="comment">// the selection indicated by the specified &#39;selectionName&#39; of the</span>
      <span class="comment">// specified &#39;selectionNameLength&#39;.  Return 0 on success, and</span>
      <span class="comment">// non-zero value otherwise (i.e., the selection is not found).</span>

  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> MANIPULATOR&gt;
  <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#a33088b6a97212d2c121bf40341cb9748">bdlat_choiceManipulateSelection</a>(MyChoice *<span class="keywordtype">object</span>,
                                      MANIPULATOR&amp; manipulator);
      <span class="comment">// Invoke the specified &#39;manipulator&#39; on the address of the</span>
      <span class="comment">// (modifiable) selection of the specified &#39;object&#39;, supplying</span>
      <span class="comment">// &#39;manipulator&#39; with the corresponding selection information</span>
      <span class="comment">// structure.  Return -1 if the selection is undefined, and the</span>
      <span class="comment">// value returned from the invocation of &#39;manipulator&#39; otherwise.</span>

  <span class="comment">// ACCESSORS</span>
  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ACCESSOR&gt;
  <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#a89d4f8c58ed0ff3751a86ce5055c6fcb">bdlat_choiceAccessSelection</a>(<span class="keyword">const</span> MyChoice&amp; <span class="keywordtype">object</span>,
                                  ACCESSOR&amp; accessor);
      <span class="comment">// Invoke the specified &#39;accessor&#39; on the (non-modifiable)</span>
      <span class="comment">// selection of the specified &#39;object&#39;, supplying &#39;accessor&#39; with</span>
      <span class="comment">// the corresponding selection information structure.  Return -1 if</span>
      <span class="comment">// the selection is undefined, and the value returned from the</span>
      <span class="comment">// invocation of &#39;accessor&#39; otherwise.</span>

  <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#a283a187b5e5045ab89532a4966d370bc">bdlat_choiceSelectionId</a>(<span class="keyword">const</span> MyChoice&amp; <span class="keywordtype">object</span>);
      <span class="comment">// Return the id of the current selection if the selection is</span>
      <span class="comment">// defined, and 0 otherwise.</span>
</pre></div><br/>
<br/>
 Also, the <code>IsChoice</code> meta-function must be specialized for the <code>mine::MyChoice</code> type in the <code><a class="el" href="namespacebdlat__ChoiceFunctions.html">bdlat_ChoiceFunctions</a></code> namespace. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="usage"></a> <a class="anchor" id="description.usage"></a> <a class="anchor" id="3.1"></a> </dd></dl>
<dl class="user"><dt><b>Usage: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The following snippets of code illustrate the usage of this component. Suppose you had a <code>union</code> embedded inside a <code>struct</code>. The <code>struct</code> also contains a <code>d_selectionId</code> member that specifies which member of the <code>union</code> is selected. The default constructor of the <code>struct</code> makes the selection undefined: <br/>
<br/>
<div class="fragment"><pre class="fragment"><span class="preprocessor">  #include &lt;<a class="code" href="bdlat__choicefunctions_8h.html" title="Provide a namespace defining choice functions.">bdlat_choicefunctions.h</a>&gt;</span>
<span class="preprocessor">  #include &lt;<a class="code" href="bdlat__selectioninfo_8h.html" title="Provide a container for selection information.">bdlat_selectioninfo.h</a>&gt;</span>
<span class="preprocessor">  #include &lt;<a class="code" href="bdlat__formattingmode_8h.html" title="Provide formatting mode constants.">bdlat_formattingmode.h</a>&gt;</span>
<span class="preprocessor">  #include &lt;<a class="code" href="bdlb__string_8h.html" title="Provide utility functions on C-style and STL strings.">bdlb_string.h</a>&gt;</span>
<span class="preprocessor">  #include &lt;<a class="code" href="bsls__assert_8h.html" title="Provide build-specific, runtime-configurable assertion macros.">bsls_assert.h</a>&gt;</span>

  <span class="keyword">namespace </span>BloombergLP {

  <span class="keyword">namespace </span>mine {

  <span class="keyword">struct </span>MyChoice {
      <span class="comment">// This struct represents a choice between a &#39;char&#39; value, an &#39;int&#39;</span>
      <span class="comment">// value, and a &#39;float&#39; value.</span>

      <span class="comment">// CONSTANTS</span>
      <span class="keyword">enum</span> {
          UNDEFINED_SELECTION_ID = -1,
          CHAR_SELECTION_ID      = 0,
          INT_SELECTION_ID       = 1,
          FLOAT_SELECTION_ID     = 2
      };

      <span class="comment">// DATA MEMBERS</span>
      <span class="keyword">union </span>{
          <span class="keywordtype">char</span>  d_charValue;
          <span class="keywordtype">int</span>   d_intValue;
          <span class="keywordtype">float</span> d_floatValue;
      };
      <span class="keywordtype">int</span> d_selectionId;

      <span class="comment">// CREATORS</span>
      MyChoice()
      : d_selectionId(UNDEFINED_SELECTION_ID)
      {
      }
  };
</pre></div><br/>
<br/>
 We can now make <code>MyChoice</code> expose "choice" behavior by implementing <code><a class="el" href="namespacebdlat__ChoiceFunctions.html">bdlat_ChoiceFunctions</a></code> for <code>MyChoice</code>. First, we should forward declare all the functions that we will implement inside the <code>mine</code> namespace: <br/>
<br/>
<div class="fragment"><pre class="fragment">      <span class="comment">// MANIPULATORS</span>
      <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#aaadb9291f97777a5a710b687e1a27445">bdlat_choiceMakeSelection</a>(MyChoice *<span class="keywordtype">object</span>, <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#ab8461ed36360e692ad84955eee029a87">selectionId</a>);
          <span class="comment">// Set the value of the specified &#39;object&#39; to be the default for</span>
          <span class="comment">// the selection indicated by the specified &#39;selectionId&#39;.  Return</span>
          <span class="comment">// 0 on success, and non-zero value otherwise (i.e., the selection</span>
          <span class="comment">// is not found).</span>

      <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#aaadb9291f97777a5a710b687e1a27445">bdlat_choiceMakeSelection</a>(MyChoice   *<span class="keywordtype">object</span>,
                                    <span class="keyword">const</span> <span class="keywordtype">char</span> *selectionName,
                                    <span class="keywordtype">int</span>         selectionNameLength);
          <span class="comment">// Set the value of the specified &#39;object&#39; to be the default for</span>
          <span class="comment">// the selection indicated by the specified &#39;selectionName&#39; of the</span>
          <span class="comment">// specified &#39;selectionNameLength&#39;.  Return 0 on success, and</span>
          <span class="comment">// non-zero value otherwise (i.e., the selection is not found).</span>

      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> MANIPULATOR&gt;
      <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#a33088b6a97212d2c121bf40341cb9748">bdlat_choiceManipulateSelection</a>(MyChoice     *<span class="keywordtype">object</span>,
                                          MANIPULATOR&amp;  manipulator);
          <span class="comment">// Invoke the specified &#39;manipulator&#39; on the address of the</span>
          <span class="comment">// (modifiable) selection of the specified &#39;object&#39;, supplying</span>
          <span class="comment">// &#39;manipulator&#39; with the corresponding selection information</span>
          <span class="comment">// structure.  Return -1 if the selection is undefined, and the</span>
          <span class="comment">// value returned from the invocation of &#39;manipulator&#39; otherwise.</span>

      <span class="comment">// ACCESSORS</span>
      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ACCESSOR&gt;
      <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#a89d4f8c58ed0ff3751a86ce5055c6fcb">bdlat_choiceAccessSelection</a>(<span class="keyword">const</span> MyChoice&amp; <span class="keywordtype">object</span>,
                                      ACCESSOR&amp;       accessor);
          <span class="comment">// Invoke the specified &#39;accessor&#39; on the (non-modifiable)</span>
          <span class="comment">// selection of the specified &#39;object&#39;, supplying &#39;accessor&#39; with</span>
          <span class="comment">// the corresponding selection information structure.  Return -1 if</span>
          <span class="comment">// the selection is undefined, and the value returned from the</span>
          <span class="comment">// invocation of &#39;accessor&#39; otherwise.</span>

      <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#a283a187b5e5045ab89532a4966d370bc">bdlat_choiceSelectionId</a>(<span class="keyword">const</span> MyChoice&amp; <span class="keywordtype">object</span>);
          <span class="comment">// Return the id of the current selection if the selection is</span>
          <span class="comment">// defined, and 0 otherwise.</span>

  }  <span class="comment">// close namespace mine</span>
</pre></div><br/>
<br/>
 Next, we provide the definitions for each of these functions: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="comment">// MANIPULATORS</span>

  <span class="keyword">inline</span>
  <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#aaadb9291f97777a5a710b687e1a27445">mine::bdlat_choiceMakeSelection</a>(MyChoice *<span class="keywordtype">object</span>,
                                      <span class="keywordtype">int</span>        <a class="code" href="namespacebdlat__ChoiceFunctions.html#ab8461ed36360e692ad84955eee029a87">selectionId</a>)
  {
      <span class="keyword">enum</span> { SUCCESS = 0, NOT_FOUND = -1 };

      <span class="keywordflow">switch</span> (selectionId) {
        <span class="keywordflow">case</span> MyChoice::CHAR_SELECTION_ID: {
          <span class="keywordtype">object</span>-&gt;d_selectionId = selectionId;
          <span class="keywordtype">object</span>-&gt;d_charValue   = 0;

          <span class="keywordflow">return</span> SUCCESS;
        }
        <span class="keywordflow">case</span> MyChoice::INT_SELECTION_ID: {
          <span class="keywordtype">object</span>-&gt;d_selectionId = selectionId;
          <span class="keywordtype">object</span>-&gt;d_intValue    = 0;

          <span class="keywordflow">return</span> SUCCESS;
        }
        <span class="keywordflow">case</span> MyChoice::FLOAT_SELECTION_ID: {
          <span class="keywordtype">object</span>-&gt;d_selectionId = selectionId;
          <span class="keywordtype">object</span>-&gt;d_floatValue  = 0;

          <span class="keywordflow">return</span> SUCCESS;
        }
        <span class="keywordflow">case</span> MyChoice::UNDEFINED_SELECTION_ID: {
          <span class="keywordtype">object</span>-&gt;d_selectionId = selectionId;

          <span class="keywordflow">return</span> SUCCESS;
        }
        <span class="keywordflow">default</span>: {
          <span class="keywordflow">return</span> NOT_FOUND;
        }
      }
  }

  <span class="keyword">inline</span>
  <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#aaadb9291f97777a5a710b687e1a27445">mine::bdlat_choiceMakeSelection</a>(MyChoice   *<span class="keywordtype">object</span>,
                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *selectionName,
                                      <span class="keywordtype">int</span>         selectionNameLength)
  {
    <span class="keyword">enum</span> { NOT_FOUND = -1 };

    <span class="keywordflow">if</span> (<a class="code" href="structbdlb_1_1String.html#a5704f0439bf8cecf4d71d33338d69466">bdlb::String::areEqualCaseless</a>(<span class="stringliteral">&quot;charValue&quot;</span>,
                                      selectionName,
                                      selectionNameLength)) {
      <span class="keywordflow">return</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#aaadb9291f97777a5a710b687e1a27445">bdlat_choiceMakeSelection</a>(<span class="keywordtype">object</span>, MyChoice::CHAR_SELECTION_ID);
    }

    <span class="keywordflow">if</span> (<a class="code" href="structbdlb_1_1String.html#a5704f0439bf8cecf4d71d33338d69466">bdlb::String::areEqualCaseless</a>(<span class="stringliteral">&quot;intValue&quot;</span>,
                                      selectionName,
                                      selectionNameLength)) {
      <span class="keywordflow">return</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#aaadb9291f97777a5a710b687e1a27445">bdlat_choiceMakeSelection</a>(<span class="keywordtype">object</span>, MyChoice::INT_SELECTION_ID);
    }

    <span class="keywordflow">if</span> (<a class="code" href="structbdlb_1_1String.html#a5704f0439bf8cecf4d71d33338d69466">bdlb::String::areEqualCaseless</a>(<span class="stringliteral">&quot;floatValue&quot;</span>,
                                      selectionName,
                                      selectionNameLength)) {
      <span class="keywordflow">return</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#aaadb9291f97777a5a710b687e1a27445">bdlat_choiceMakeSelection</a>(<span class="keywordtype">object</span>, MyChoice::FLOAT_SELECTION_ID);
    }

    <span class="keywordflow">return</span> NOT_FOUND;
  }
</pre></div><br/>
<br/>
 For the <code>manipulateSelection</code> and <code>accessSelection</code> functions, we need to create a temporary <code><a class="el" href="structbdlat__SelectionInfo.html" title="container for selection information">bdlat_SelectionInfo</a></code> object and pass it along when invoking the manipulator or accessor. See the <code>bdlat_selectioninfo</code> component-level documentation for more information. The implementation of the remaining functions are as follows: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> MANIPULATOR&gt;
  <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#a33088b6a97212d2c121bf40341cb9748">mine::bdlat_choiceManipulateSelection</a>(MyChoice    *<span class="keywordtype">object</span>,
                                            MANIPULATOR&amp;  manipulator)
  {
    <span class="keywordflow">switch</span> (object-&gt;d_selectionId) {
      <span class="keywordflow">case</span> MyChoice::CHAR_SELECTION_ID: {
        <a class="code" href="structbdlat__SelectionInfo.html" title="container for selection information">bdlat_SelectionInfo</a> info;

        info.<a class="code" href="structbdlat__SelectionInfo.html#ab46500227cbeaa79411412bd27c109ea">annotation</a>()     = <span class="stringliteral">&quot;Char Selection&quot;</span>;
        info.<a class="code" href="structbdlat__SelectionInfo.html#a862ea9869fe0693ec7a121d973fe9506">formattingMode</a>() = bdlat_FormattingMode::DEFAULT;
        info.<a class="code" href="structbdlat__SelectionInfo.html#aced2af566cfe116bb37d050d35bf639e">id</a>()             = MyChoice::CHAR_SELECTION_ID;
        info.<a class="code" href="structbdlat__SelectionInfo.html#af4ec33613da99fd4886ffdf2db706616">name</a>()           = <span class="stringliteral">&quot;charValue&quot;</span>;
        info.<a class="code" href="structbdlat__SelectionInfo.html#ac73199f09acf938d0dd0e7e0ebb4c297">nameLength</a>()     = 9;

        <span class="keywordflow">return</span> manipulator(&amp;object-&gt;d_charValue, info);
      }
      <span class="keywordflow">case</span> MyChoice::INT_SELECTION_ID: {
        <a class="code" href="structbdlat__SelectionInfo.html" title="container for selection information">bdlat_SelectionInfo</a> info;

        info.<a class="code" href="structbdlat__SelectionInfo.html#ab46500227cbeaa79411412bd27c109ea">annotation</a>()     = <span class="stringliteral">&quot;Int Selection&quot;</span>;
        info.<a class="code" href="structbdlat__SelectionInfo.html#a862ea9869fe0693ec7a121d973fe9506">formattingMode</a>() = bdlat_FormattingMode::DEFAULT;
        info.<a class="code" href="structbdlat__SelectionInfo.html#aced2af566cfe116bb37d050d35bf639e">id</a>()             = MyChoice::INT_SELECTION_ID;
        info.<a class="code" href="structbdlat__SelectionInfo.html#af4ec33613da99fd4886ffdf2db706616">name</a>()           = <span class="stringliteral">&quot;intValue&quot;</span>;
        info.<a class="code" href="structbdlat__SelectionInfo.html#ac73199f09acf938d0dd0e7e0ebb4c297">nameLength</a>()     = 8;

        <span class="keywordflow">return</span> manipulator(&amp;object-&gt;d_intValue, info);
      }
      <span class="keywordflow">case</span> MyChoice::FLOAT_SELECTION_ID: {
        <a class="code" href="structbdlat__SelectionInfo.html" title="container for selection information">bdlat_SelectionInfo</a> info;

        info.<a class="code" href="structbdlat__SelectionInfo.html#ab46500227cbeaa79411412bd27c109ea">annotation</a>()     = <span class="stringliteral">&quot;Float Selection&quot;</span>;
        info.<a class="code" href="structbdlat__SelectionInfo.html#a862ea9869fe0693ec7a121d973fe9506">formattingMode</a>() = bdlat_FormattingMode::DEFAULT;
        info.<a class="code" href="structbdlat__SelectionInfo.html#aced2af566cfe116bb37d050d35bf639e">id</a>()             = MyChoice::FLOAT_SELECTION_ID;
        info.<a class="code" href="structbdlat__SelectionInfo.html#af4ec33613da99fd4886ffdf2db706616">name</a>()           = <span class="stringliteral">&quot;floatValue&quot;</span>;
        info.<a class="code" href="structbdlat__SelectionInfo.html#ac73199f09acf938d0dd0e7e0ebb4c297">nameLength</a>()     = 10;

        <span class="keywordflow">return</span> manipulator(&amp;object-&gt;d_floatValue, info);
      }
      <span class="keywordflow">default</span>:
        <a class="code" href="bsls__assert_8h.html#a52b2a865ec62420b3681e39fa5cab9c0">BSLS_ASSERT_SAFE</a>(!<span class="stringliteral">&quot;Invalid selection!&quot;</span>);
    }
    <span class="keywordflow">return</span> 0;
  }

  <span class="comment">// ACCESSORS</span>

  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ACCESSOR&gt;
  <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#a89d4f8c58ed0ff3751a86ce5055c6fcb">mine::bdlat_choiceAccessSelection</a>(<span class="keyword">const</span> MyChoice&amp; <span class="keywordtype">object</span>,
                                        ACCESSOR&amp;        accessor)
  {
      <span class="keywordflow">switch</span> (<span class="keywordtype">object</span>.d_selectionId) {
        <span class="keywordflow">case</span> MyChoice::CHAR_SELECTION_ID: {
          <a class="code" href="structbdlat__SelectionInfo.html" title="container for selection information">bdlat_SelectionInfo</a> info;

          info.<a class="code" href="structbdlat__SelectionInfo.html#ab46500227cbeaa79411412bd27c109ea">annotation</a>()     = <span class="stringliteral">&quot;Char Selection&quot;</span>;
          info.<a class="code" href="structbdlat__SelectionInfo.html#a862ea9869fe0693ec7a121d973fe9506">formattingMode</a>() = bdlat_FormattingMode::DEFAULT;
          info.<a class="code" href="structbdlat__SelectionInfo.html#aced2af566cfe116bb37d050d35bf639e">id</a>()             = MyChoice::CHAR_SELECTION_ID;
          info.<a class="code" href="structbdlat__SelectionInfo.html#af4ec33613da99fd4886ffdf2db706616">name</a>()           = <span class="stringliteral">&quot;charValue&quot;</span>;
          info.<a class="code" href="structbdlat__SelectionInfo.html#ac73199f09acf938d0dd0e7e0ebb4c297">nameLength</a>()     = 9;

          <span class="keywordflow">return</span> accessor(<span class="keywordtype">object</span>.d_charValue, info);
        }
        <span class="keywordflow">case</span> MyChoice::INT_SELECTION_ID: {
          <a class="code" href="structbdlat__SelectionInfo.html" title="container for selection information">bdlat_SelectionInfo</a> info;

          info.<a class="code" href="structbdlat__SelectionInfo.html#ab46500227cbeaa79411412bd27c109ea">annotation</a>()     = <span class="stringliteral">&quot;Int Selection&quot;</span>;
          info.<a class="code" href="structbdlat__SelectionInfo.html#a862ea9869fe0693ec7a121d973fe9506">formattingMode</a>() = bdlat_FormattingMode::DEFAULT;
          info.<a class="code" href="structbdlat__SelectionInfo.html#aced2af566cfe116bb37d050d35bf639e">id</a>()             = MyChoice::INT_SELECTION_ID;
          info.<a class="code" href="structbdlat__SelectionInfo.html#af4ec33613da99fd4886ffdf2db706616">name</a>()           = <span class="stringliteral">&quot;intValue&quot;</span>;
          info.<a class="code" href="structbdlat__SelectionInfo.html#ac73199f09acf938d0dd0e7e0ebb4c297">nameLength</a>()     = 8;

          <span class="keywordflow">return</span> accessor(<span class="keywordtype">object</span>.d_intValue, info);
        }
        <span class="keywordflow">case</span> MyChoice::FLOAT_SELECTION_ID: {
          <a class="code" href="structbdlat__SelectionInfo.html" title="container for selection information">bdlat_SelectionInfo</a> info;

          info.<a class="code" href="structbdlat__SelectionInfo.html#ab46500227cbeaa79411412bd27c109ea">annotation</a>()     = <span class="stringliteral">&quot;Float Selection&quot;</span>;
          info.<a class="code" href="structbdlat__SelectionInfo.html#a862ea9869fe0693ec7a121d973fe9506">formattingMode</a>() = bdlat_FormattingMode::DEFAULT;
          info.<a class="code" href="structbdlat__SelectionInfo.html#aced2af566cfe116bb37d050d35bf639e">id</a>()             = MyChoice::FLOAT_SELECTION_ID;
          info.<a class="code" href="structbdlat__SelectionInfo.html#af4ec33613da99fd4886ffdf2db706616">name</a>()           = <span class="stringliteral">&quot;floatValue&quot;</span>;
          info.<a class="code" href="structbdlat__SelectionInfo.html#ac73199f09acf938d0dd0e7e0ebb4c297">nameLength</a>()     = 10;

          <span class="keywordflow">return</span> accessor(<span class="keywordtype">object</span>.d_floatValue, info);
        }
        <span class="keywordflow">default</span>:
          <a class="code" href="bsls__assert_8h.html#a52b2a865ec62420b3681e39fa5cab9c0">BSLS_ASSERT_SAFE</a>(!<span class="stringliteral">&quot;Invalid selection!&quot;</span>);
      }
    <span class="keywordflow">return</span> 0;
  }

  <span class="keyword">inline</span>
  <span class="keywordtype">int</span> <a class="code" href="namespacebdlat__ChoiceFunctions.html#a283a187b5e5045ab89532a4966d370bc">mine::bdlat_choiceSelectionId</a>(<span class="keyword">const</span> MyChoice&amp; <span class="keywordtype">object</span>)
  {
      <span class="keywordflow">return</span> <span class="keywordtype">object</span>.d_selectionId;
  }
</pre></div><br/>
<br/>
 Finally, we need to specialize the <code>IsChoice</code> meta-function in the <code><a class="el" href="namespacebdlat__ChoiceFunctions.html">bdlat_ChoiceFunctions</a></code> namespace for the <code>mine::MyChoice</code> type. This makes the <code>bdlat</code> infrastructure recognize <code>mine::MyChoice</code> as a choice abstraction: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keyword">namespace </span>bdlat_ChoiceFunctions {

      <span class="keyword">template</span> &lt;&gt;
      <span class="keyword">struct </span>IsChoice&lt;mine::MyChoice&gt; {
          <span class="keyword">enum</span> { <a class="code" href="structbdlat__ChoiceFunctions_1_1IsChoice.html#afd41e7d2c1dd1fb88eb748bac860f20dae575b25f6f989d2679bbc4482d88532e">VALUE</a> = 1 };
      };

  } <span class="comment">// close namespace &#39;bdlat_ChoiceFunctions&#39;</span>
  } <span class="comment">// close namespace &#39;BloombergLP&#39;</span>
</pre></div><br/>
<br/>
 The <code>bdlat</code> infrastructure (and any component that uses this infrastructure) will now recognize <code>mine::MyChoice</code> as a "choice" type. For example, suppose we have the following XML data: <br/>
<br/>
<div class="fragment"><pre class="fragment">  &lt;?xml version=<span class="stringliteral">&#39;1.0&#39;</span> encoding=<span class="stringliteral">&#39;UTF-8&#39;</span> ?&gt;
  &lt;MyChoice&gt;
      &lt;intValue&gt;321&lt;/intValue&gt;
  &lt;/MyChoice&gt;
</pre></div><br/>
<br/>
 Using the <code>balxml_decoder</code> component, we can load this XML data into a <code>mine::MyChoice</code> object: <br/>
<br/>
<div class="fragment"><pre class="fragment"><span class="preprocessor">  #include &lt;<a class="code" href="balxml__decoder_8h.html" title="Provide a generic translation from XML into C++ objects.">balxml_decoder.h</a>&gt;</span>

  <span class="keywordtype">void</span> decodeMySequenceFromXML(bsl::istream&amp; inputData)
  {
      <span class="keyword">using namespace </span>BloombergLP;

      MyChoice object;

      assert(MyChoice::UNDEFINED_SELECTION_ID == <span class="keywordtype">object</span>.d_selectionId);

      <a class="code" href="classbalxml_1_1DecoderOptions.html">balxml::DecoderOptions</a> options;
      <a class="code" href="classbalxml_1_1MiniReader.html">balxml::MiniReader</a>     reader;
      <a class="code" href="classbalxml_1_1ErrorInfo.html">balxml::ErrorInfo</a>      errInfo;

      <a class="code" href="classbalxml_1_1Decoder.html">balxml::Decoder</a> decoder(&amp;options, &amp;reader, &amp;errInfo);
      <span class="keywordtype">int</span> result = decoder.decode(inputData, &amp;<span class="keywordtype">object</span>);

      assert(0                          == result);
      assert(MyChoice::INT_SELECTION_ID == <span class="keywordtype">object</span>.d_selectionId);
      assert(321                        == <span class="keywordtype">object</span>.d_intValue);
  }
</pre></div><br/>
<br/>
 Note that the <code>bdlat</code> framework can be used for functionality other than encoding/decoding into XML. When <code>mine::MyChoice</code> is plugged into the framework, then it will be automatically usable within the framework. For example, the following snippets of code will print out the selection value of a choice object: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keyword">struct </span>PrintSelection {
      <span class="comment">// Print each visited object to the bound &#39;d_stream_p&#39; object.</span>

      <span class="comment">// DATA MEMBERS</span>
      bsl::ostream *d_stream_p;

      <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TYPE, <span class="keyword">typename</span> INFO&gt;
      <span class="keywordtype">int</span> operator()(<span class="keyword">const</span> TYPE&amp; <span class="keywordtype">object</span>, <span class="keyword">const</span> INFO&amp; info)
      {
        (*d_stream_p) &lt;&lt; info.name() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; <span class="keywordtype">object</span> &lt;&lt; bsl::endl;
        <span class="keywordflow">return</span> 0;
      }
  };

  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TYPE&gt;
  <span class="keywordtype">void</span> printChoiceSelection(bsl::ostream&amp; stream, <span class="keyword">const</span> TYPE&amp; <span class="keywordtype">object</span>)
  {
      <span class="keyword">using namespace </span>BloombergLP;

      PrintSelection accessor;
      accessor.d_stream_p = &amp;stream;

      <a class="code" href="namespacebdlat__ChoiceFunctions.html#a89d4f8c58ed0ff3751a86ce5055c6fcb">bdlat_choiceAccessSelection</a>(<span class="keywordtype">object</span>, accessor);
  }
</pre></div><br/>
<br/>
 Now we have a generic function that takes an output stream and a choice object, and prints out the choice selection with its name and value. We can use this generic function as follows: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">void</span> printMyChoice(bsl::ostream&amp; stream)
  {
      <span class="keyword">using namespace </span>BloombergLP;

      mine::MyChoice object;

      <span class="keywordtype">object</span>.d_selectionId = mine::MyChoice::INT_SELECTION_ID;
      <span class="keywordtype">object</span>.d_intValue    = 321;

      printChoiceSelection(stream, <span class="keywordtype">object</span>);
  }
</pre></div><br/>
<br/>
 The function above will print the following to provided stream: <br/>
<br/>
<div class="fragment"><pre class="fragment">  intValue: 321
</pre></div><br/>
<br/>
 </dd></dl>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Thu Oct 15 2015 14:33:36 for BDE Release 3.0 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
