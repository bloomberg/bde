<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>BDE 3.0: balst_stacktrace Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <style>
      div.hanging {
        padding-left: 0.75in;
        text-indent: -0.50in;
      }
      div.unhanging {
        text-indent:     0in;
      }
      a.glossary {
        font-weight: bold;
        font-style: italic;
      }
    </style>
</head>
<!--
<body onload='searchBox.OnSelectItem(0);'>
-->
<body>

<table border=2 cellspacing=0 cellpadding=0 align=center>
<tr>
 <td valign=top align=center>
 <p align=center><b><i>Quick Links:</i></b></p>
 </td>
 <td valign=top align=center>
 <p align=center>
<a class="qindex" href="group__bal.html" target="_blank">bal</a> | <a class="qindex" href="group__bbl.html" target="_blank">bbl</a> | <a class="qindex" href="group__bdl.html" target="_blank">bdl</a> | <a class="qindex" href="group__bsl.html" target="_blank">bsl</a> | <a class="qindex" href="group__btl.html" target="_blank">btl</a>
 </td>
 </tr>
 </table>

  </div>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="components.html"><span>Components</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<h1>Component balst_stacktrace<br/>
<small>
[<a class="el" href="group__balst.html">Package balst</a>]</small>
</h1>  </div>
</div>
<div class="contents">

<p>Provide a description of a function-call stack.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebalst.html">balst</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="user"><dt><b>Outline</b></dt><dd><ul>
<li>
<a href="#1">Purpose</a> </li>
<li>
<a href="#2">Classes</a> </li>
<li>
<a href="#3">Description</a> <ul>
<li>
<a href="#3.1">Usage</a> <ul>
<li>
<a href="#3.1.1">Example 1: Configuring a Stack-Trace Value</a> </li>
</ul>
</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="purpose"></a> <a class="anchor" id="1"></a> </dd></dl>
<dl class="user"><dt><b>Purpose: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Provide a description of a function-call stack. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="classes"></a> <a class="anchor" id="2"></a> </dd></dl>
<dl class="user"><dt><b>Classes: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><table class="doxtable">
<tr>
<td><a class="el" href="classbalst_1_1StackTrace.html">balst::StackTrace</a> </td><td>a description of a function-call stack  </td></tr>
</table>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__balst__stacktraceframe.html" title="Provide an attribute class describing an execution stack frame.">Component balst_stacktraceframe</a>, <a class="el" href="group__balst__stacktraceutil.html" title="Provide low-level utilities for obtaining &amp; printing a stack-trace.">Component balst_stacktraceutil</a>, <a class="el" href="group__balst__stacktraceprintutil.html" title="Provide a single function to perform and print a stack trace.">Component balst_stacktraceprintutil</a>, <a class="el" href="group__bdlma__heapbypassallocator.html" title="Support memory allocation directly from virtual memory.">Component bdlma_heapbypassallocator</a> </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="description"></a> <a class="anchor" id="3"></a> </dd></dl>
<dl class="user"><dt><b>Description: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This component provides a (value-semantic) container class, <code><a class="el" href="classbalst_1_1StackTrace.html">balst::StackTrace</a></code>, that is used to describe a function-call stack. A stack-trace object contains a sequence of <code><a class="el" href="classbalst_1_1StackTraceFrame.html">balst::StackTraceFrame</a></code> objects. By default, a <code><a class="el" href="classbalst_1_1StackTrace.html">balst::StackTrace</a></code> object is supplied memory by an owned <code><a class="el" href="classbdlma_1_1HeapBypassAllocator.html">bdlma::HeapBypassAllocator</a></code> object, though the client may specify another allocator at construction to be used in its place. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="usage"></a> <a class="anchor" id="description.usage"></a> <a class="anchor" id="3.1"></a> </dd></dl>
<dl class="user"><dt><b>Usage: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>In this section we show the intended usage of this component. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="example_1~3A_configuring_a_stack-trace_value"></a> <a class="anchor" id="usage.example_1~3A_configuring_a_stack-trace_value"></a> <a class="anchor" id="description.usage.example_1~3A_configuring_a_stack-trace_value"></a> <a class="anchor" id="example_1"></a> <a class="anchor" id="usage.example_1"></a> <a class="anchor" id="description.usage.example_1"></a> <a class="anchor" id="3.1.1"></a> </dd></dl>
<dl class="user"><dt><b>Example 1: Configuring a Stack-Trace Value: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>In this example we demonstrate how to create a <code><a class="el" href="classbalst_1_1StackTrace.html">balst::StackTrace</a></code> object, and then to both modify and access its value. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>First, we set up a test allocator as default allocator. A <code><a class="el" href="classbalst_1_1StackTrace.html">balst::StackTrace</a></code> object, by default, gets all its memory from an owned <code><a class="el" href="classbdlma_1_1HeapBypassAllocator.html">bdlma::HeapBypassAllocator</a></code> object. To demonstrate this default behavior we start by setting the default allocator to a test allocator so we can verify later that it was unused: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbslma_1_1TestAllocator.html">bslma::TestAllocator</a>         da;
  <a class="code" href="classbslma_1_1DefaultAllocatorGuard.html">bslma::DefaultAllocatorGuard</a> guard(&amp;da);
</pre></div><br/>
<br/>
 Then, we create a stack-trace object. Note that when we don't specify an allocator, the default allocator is not used -- rather, a heap-bypass allocator owned by the stack-trace object is used. The heap-bypass allocator is recommended because this component is often used to obtain debug information in situations where an error has occurred, and the possibility of heap corruption can't be ruled out. The heap-bypass allocator obtains its memory directly from virtual memory rather than going through the heap, avoiding potential complications due to heap corruption. <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbalst_1_1StackTrace.html">balst::StackTrace</a> stackTrace;
  assert(0 == stackTrace.<a class="code" href="classbalst_1_1StackTrace.html#a80c7ae5e281cc39bcec482d7f47fb974">length</a>());
</pre></div><br/>
<br/>
 Next, we <code>resize</code> the stack-trace object to contain two default-constructed frames, and take references to each of the two new frames: <br/>
<br/>
<div class="fragment"><pre class="fragment">  stackTrace.<a class="code" href="classbalst_1_1StackTrace.html#aaefe032e74de1697417122cdb7d94874">resize</a>(2);
  assert(2 == stackTrace.<a class="code" href="classbalst_1_1StackTrace.html#a80c7ae5e281cc39bcec482d7f47fb974">length</a>());
  <a class="code" href="classbalst_1_1StackTraceFrame.html">balst::StackTraceFrame</a>&amp; frame0 = stackTrace[0];
  <a class="code" href="classbalst_1_1StackTraceFrame.html">balst::StackTraceFrame</a>&amp; frame1 = stackTrace[1];
</pre></div><br/>
<br/>
 Then, we set the values of the fields of the two new frames. <br/>
<br/>
<div class="fragment"><pre class="fragment">  frame0.setAddress((<span class="keywordtype">void</span> *) 0x12ab);
  frame0.setLibraryFileName(<span class="stringliteral">&quot;/a/b/c/balst_stacktrace.t.dbg_exc_mt&quot;</span>);
  frame0.setLineNumber(5);
  frame0.setOffsetFromSymbol(116);
  frame0.setSourceFileName(<span class="stringliteral">&quot;/a/b/c/sourceFile.cpp&quot;</span>);
  frame0.setMangledSymbolName(<span class="stringliteral">&quot;_woof_1a&quot;</span>);
  frame0.setSymbolName(<span class="stringliteral">&quot;woof&quot;</span>);

  frame1.<a class="code" href="classbalst_1_1StackTraceFrame.html#a58ec040f4395d097e1aedc466182e512">setAddress</a>((<span class="keywordtype">void</span> *) 0x34cd);
  frame1.<a class="code" href="classbalst_1_1StackTraceFrame.html#af5dff5c7b2121d570f417ba2f2dd321d">setLibraryFileName</a>(<span class="stringliteral">&quot;/lib/libd.a&quot;</span>);
  frame1.<a class="code" href="classbalst_1_1StackTraceFrame.html#a164d233dacf52d9cfd56a0f3d098040b">setLineNumber</a>(15);
  frame1.<a class="code" href="classbalst_1_1StackTraceFrame.html#a4e9dfab57a2c390b5c15821a061170f4">setOffsetFromSymbol</a>(228);
  frame1.<a class="code" href="classbalst_1_1StackTraceFrame.html#a10f4c8d846133518473be3ef16164ecc">setSourceFileName</a>(<span class="stringliteral">&quot;/a/b/c/secondSourceFile.cpp&quot;</span>);
  frame1.<a class="code" href="classbalst_1_1StackTraceFrame.html#a1ad9ef4637f1a9447160405c5973e3aa">setMangledSymbolName</a>(<span class="stringliteral">&quot;_arf_1a&quot;</span>);
  frame1.<a class="code" href="classbalst_1_1StackTraceFrame.html#a3747a77abe5997b0a85f6ba83bd377f3">setSymbolName</a>(<span class="stringliteral">&quot;arf&quot;</span>);
</pre></div><br/>
<br/>
 Next, we verify the frames have the values we expect: <br/>
<br/>
<div class="fragment"><pre class="fragment">  assert((<span class="keywordtype">void</span> *) 0x12ab               == frame0.address());
  assert(<span class="stringliteral">&quot;/a/b/c/balst_stacktrace.t.dbg_exc_mt&quot;</span>
                                       == frame0.libraryFileName());
  assert(  5                           == frame0.lineNumber());
  assert(116                           == frame0.offsetFromSymbol());
  assert(<span class="stringliteral">&quot;/a/b/c/sourceFile.cpp&quot;</span>       == frame0.sourceFileName());
  assert(<span class="stringliteral">&quot;_woof_1a&quot;</span>                    == frame0.mangledSymbolName());
  assert(<span class="stringliteral">&quot;woof&quot;</span>                        == frame0.symbolName());

  assert((<span class="keywordtype">void</span> *) 0x34cd               == frame1.<a class="code" href="classbalst_1_1StackTraceFrame.html#acc8c13bb4e888f7b5c42afd4f7129417">address</a>());
  assert(<span class="stringliteral">&quot;/lib/libd.a&quot;</span>                 == frame1.<a class="code" href="classbalst_1_1StackTraceFrame.html#ad7211813938f4686016a8051db9c5a72">libraryFileName</a>());
  assert( 15                           == frame1.<a class="code" href="classbalst_1_1StackTraceFrame.html#a19d85a79c2c3a814384517ef823ea57c">lineNumber</a>());
  assert(228                           == frame1.<a class="code" href="classbalst_1_1StackTraceFrame.html#aab997e209f289ce378d13c92e529f16c">offsetFromSymbol</a>());
  assert(<span class="stringliteral">&quot;/a/b/c/secondSourceFile.cpp&quot;</span> == frame1.<a class="code" href="classbalst_1_1StackTraceFrame.html#a9bce665eab9b1c3f4ae692a8ddfb3a1a">sourceFileName</a>());
  assert(<span class="stringliteral">&quot;_arf_1a&quot;</span>                     == frame1.<a class="code" href="classbalst_1_1StackTraceFrame.html#ab023aab693e470c9c903f17a37dfb05f">mangledSymbolName</a>());
  assert(<span class="stringliteral">&quot;arf&quot;</span>                         == frame1.<a class="code" href="classbalst_1_1StackTraceFrame.html#ab2dcc44f1cefcc9eaee53504b72ff8f5">symbolName</a>());
</pre></div><br/>
<br/>
 Next, we output the stack-trace object: <br/>
<br/>
<div class="fragment"><pre class="fragment">  stackTrace.<a class="code" href="classbalst_1_1StackTrace.html#ada12ccaf21b1810767ada207abccae86">print</a>(cout, 1, 2);
</pre></div><br/>
<br/>
 Finally, we observe the default allocator was never used. <br/>
<br/>
<div class="fragment"><pre class="fragment">  assert(0 == da.<a class="code" href="classbslma_1_1TestAllocator.html#a464a6bc3f5125e8b0d303efbd339afec">numAllocations</a>());
</pre></div><br/>
<br/>
 The above usage produces the following output: <br/>
<br/>
<div class="fragment"><pre class="fragment">  [
    [
      address = 0x12ab
      library file name = <span class="stringliteral">&quot;/a/b/c/balst_stacktrace.t.dbg_exc_mt&quot;</span>
      line number = 5
      mangled symbol name = <span class="stringliteral">&quot;_woof_1a&quot;</span>
      offset from symbol = 116
      source file name = <span class="stringliteral">&quot;/a/b/c/sourceFile.cpp&quot;</span>
      symbol name = <span class="stringliteral">&quot;woof&quot;</span>
    ]
    [
      address = 0x34cd
      library file name = <span class="stringliteral">&quot;/lib/libd.a&quot;</span>
      line number = 15
      mangled symbol name = <span class="stringliteral">&quot;_arf_1a&quot;</span>
      offset from symbol = 228
      source file name = <span class="stringliteral">&quot;/a/b/c/secondSourceFile.cpp&quot;</span>
      symbol name = <span class="stringliteral">&quot;arf&quot;</span>
    ]
  ]
</pre></div><br/>
<br/>
 </dd></dl>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Apr 1 2016 16:48:29 for BDE Release 3.0 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
