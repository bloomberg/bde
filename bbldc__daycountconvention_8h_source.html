<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<title>BDE 3.0</title>
<html>
<pre>
// bbldc_daycountconvention.h                                         -*-C++-*-
#ifndef INCLUDED_BBLDC_DAYCOUNTCONVENTION
#define INCLUDED_BBLDC_DAYCOUNTCONVENTION

#ifndef INCLUDED_BSLS_IDENT
#include &lt;bsls_ident.h&gt;
#endif
BSLS_IDENT(&quot;$Id: $&quot;)

//@PURPOSE: Provide an enumeration of &#39;bbldc&#39; day-count conventions.
//
//@CLASSES:
//  bbldc::DayCountConvention: namespace for day-count convention enumeration
//
//@DESCRIPTION: This component provides a namespace,
// &#39;bbldc::DayCountConvention&#39;, for the &#39;enum&#39; type
// &#39;bbldc::DayCountConvention::Enum&#39;, that enumerates the list of day-count
// conventions supported by the &#39;bbldc&#39; package.
//
///Enumerators
///-----------
//..
//  Name                         Description
//  ---------------------------  ----------------------------------------------
//  e_ACTUAL_360                 Convention is Actual/360.
//  e_ACTUAL_365_FIXED           Convention is Actual/365 (fixed).
//  e_ISDA_ACTUAL_ACTUAL         Convention is ISDA Actual/Actual.
//  e_ISMA_30_360                Convention is ISMA 30/360.
//  e_PSA_30_360_EOM             Convention is PSA 30/360 end-of-month.
//  e_SIA_30_360_EOM             Convention is SIA 30/360 end-of-month.
//  e_SIA_30_360_NEOM            Convention is SIA 30/360 no-end-of-month.
//  e_PERIOD_ICMA_ACTUAL_ACTUAL  Convention is period-based ICMA Actual/Actual.
//  e_CALENDAR_BUS_252           Convention is calendar-based BUS-252.
//..
//
///Usage
///-----
// This section illustrates intended use of this component.
//
///Example 1: Basic Syntax
///- - - - - - - - - - - -
// The following snippets of code provide a simple illustration of using
// &#39;bbldc::DayCountConvention&#39;.
//
// First, we create a variable &#39;convention&#39; of type
// &#39;bbldc::DayCountConvention::Enum&#39; and initialize it to the value
// &#39;bbldc::DayCountConvention::e_ISMA_30_360&#39;:
//..
//  bbldc::DayCountConvention::Enum convention =
//                                    bbldc::DayCountConvention::e_ISMA_30_360;
//..
// Now, we store the address of its ASCII representation in a pointer variable,
// &#39;asciiValue&#39;, of type &#39;const char *&#39;:
//..
//  const char *asciiValue = bbldc::DayCountConvention::toAscii(convention);
//  assert(0 == bsl::strcmp(asciiValue, &quot;ISMA_30_360&quot;));
//..
// Finally, we print &#39;convention&#39; to &#39;bsl::cout&#39;;
//..
//  bsl::cout &lt;&lt; convention &lt;&lt; bsl::endl;
//..
// This statement produces the following output on &#39;stdout&#39;:
//..
//  ISMA_30_360
//..

#ifndef INCLUDED_BBLSCM_VERSION
#include &lt;bblscm_version.h&gt;
#endif

#ifndef INCLUDED_BSL_IOSFWD
#include &lt;bsl_iosfwd.h&gt;
#endif

namespace BloombergLP {
namespace bbldc {

                        // =========================
                        // struct DayCountConvention
                        // =========================

struct DayCountConvention {
    // This &#39;struct&#39; provides a namespace for enumerating the set of day-count
    // conventions supported within &#39;bbldc&#39;.  See &#39;Enum&#39; in the &#39;TYPES&#39;
    // sub-section for details.
    //
    // This &#39;struct&#39;:
    //: o supports a complete set of *enumeration* operations
    // For terminology see &#39;bsldoc_glossary&#39;.

    // TYPES
    enum Enum {
        // Enumerated &#39;bbldc&#39; day-count conventions.

        e_ACTUAL_360                =  0,
        e_ACTUAL_365_FIXED          =  1,
        // 2 is deprecated
        e_ISDA_ACTUAL_ACTUAL        =  3,
        // 4 is deprecated
        e_ISMA_30_360               =  5,
        e_PSA_30_360_EOM            =  6,
        e_SIA_30_360_EOM            =  7,
        e_SIA_30_360_NEOM           =  8,
        e_PERIOD_ICMA_ACTUAL_ACTUAL =  9,
        e_CALENDAR_BUS_252          = 10


    };


    // CLASS METHODS
    template &lt;class STREAM&gt;
    static STREAM&amp; bdexStreamIn(STREAM&amp;                   stream,
                                DayCountConvention::Enum&amp; variable,
                                int                       version);
        // Assign to the specified &#39;variable&#39; the value read from the specified
        // input &#39;stream&#39; using the specified &#39;version&#39; format, and return a
        // reference to &#39;stream&#39;.  If &#39;stream&#39; is initially invalid, this
        // operation has no effect.  If &#39;version&#39; is not supported, &#39;variable&#39;
        // is unaltered and &#39;stream&#39; is invalidated, but otherwise unmodified.
        // If &#39;version&#39; is supported but &#39;stream&#39; becomes invalid during this
        // operation, &#39;variable&#39; has an undefined, but valid, state.  Note that
        // no version is read from &#39;stream&#39;.  See the &#39;bslx&#39; package-level
        // documentation for more information on BDEX streaming of
        // value-semantic types and containers.

    template &lt;class STREAM&gt;
    static STREAM&amp; bdexStreamOut(STREAM&amp;                  stream,
                                 DayCountConvention::Enum value,
                                 int                      version);
        // Write the value of the specified &#39;value&#39;, using the specified
        // &#39;version&#39; format, to the specified output &#39;stream&#39;, and return a
        // reference to &#39;stream&#39;.  If &#39;stream&#39; is initially invalid, this
        // operation has no effect.  If &#39;version&#39; is not supported, &#39;stream&#39; is
        // invalidated, but otherwise unmodified.  Note that &#39;version&#39; is not
        // written to &#39;stream&#39;.  See the &#39;bslx&#39; package-level documentation for
        // more information on BDEX streaming of value-semantic types and
        // containers.

    static int maxSupportedBdexVersion(int versionSelector);
        // Return the maximum valid BDEX format version, as indicated by the
        // specified &#39;versionSelector&#39;, to be passed to the &#39;bdexStreamOut&#39;
        // method.  Note that it is highly recommended that &#39;versionSelector&#39;
        // be formatted as &quot;YYYYMMDD&quot;, a date representation.  Also note that
        // &#39;versionSelector&#39; should be a *compile*-time-chosen value that
        // selects a format version supported by both externalizer and
        // unexternalizer.  See the &#39;bslx&#39; package-level documentation for more
        // information on BDEX streaming of value-semantic types and
        // containers.

    static bsl::ostream&amp; print(bsl::ostream&amp;            stream,
                               DayCountConvention::Enum value,
                               int                      level          = 0,
                               int                      spacesPerLevel = 4);
        // Write the string representation of the specified enumeration &#39;value&#39;
        // to the specified output &#39;stream&#39;, and return a reference to
        // &#39;stream&#39;.  Optionally specify an initial indentation &#39;level&#39;, whose
        // absolute value is incremented recursively for nested objects.  If
        // &#39;level&#39; is specified, optionally specify &#39;spacesPerLevel&#39;, whose
        // absolute value indicates the number of spaces per indentation level
        // for this and all of its nested objects.  If &#39;level&#39; is negative,
        // suppress indentation of the first line.  If &#39;spacesPerLevel&#39; is
        // negative, format the entire output on one line, suppressing all but
        // the initial indentation (as governed by &#39;level&#39;).  The behavior is
        // undefined unless &#39;value&#39; is in the range
        // &#39;[e_ACTUAL_360 .. e_CALENDAR_BUS_252]&#39;.  See &#39;toAscii&#39; for what
        // constitutes the string representation of a
        // &#39;bbldc::DayCountConvention::Enum&#39; value.

    static const char *toAscii(Enum convention);
        // Return the abbreviated character-string representation of the
        // enumerator corresponding to the specified &#39;convention&#39;.  This
        // representation matches the enumerator&#39;s name (e.g., &#39;e_ACTUAL_360&#39;)
        // with the &quot;e_&quot; prefix elided.  For example:
        //..
        //  bsl::cout &lt;&lt; bbldc::DayCountConvention::toAscii(
        //                            bbldc::DayCountConvention::e_ACTUAL_360);
        //..
        // prints the following on standard output:
        //..
        //  ACTUAL_360
        //..
        // Note that specifying a &#39;convention&#39; that does not match any of the
        // enumerators will result in an unspecified string representation
        // being returned that is distinct from the values returned for any
        // valid enumerator.

};

// FREE OPERATORS
bsl::ostream&amp; operator&lt;&lt;(bsl::ostream&amp;            stream,
                         DayCountConvention::Enum value);
    // Write the string representation of the specified enumeration &#39;value&#39; to
    // the specified output &#39;stream&#39; in a single-line format, and return a
    // reference to &#39;stream&#39;.  See &#39;toAscii&#39; for what constitutes the string
    // representation of a &#39;bbldc::DayCountConvention::Enum&#39; value.  Note that
    // this method has the same behavior as
    //..
    //  bbldc::DayCountConvention::print(stream, value, 0, -1);
    //..

// FREE FUNCTIONS
template &lt;class STREAM&gt;
STREAM&amp; bdexStreamIn(STREAM&amp;                   stream,
                     DayCountConvention::Enum&amp; variable,
                     int                       version);
    // Load into the specified &#39;variable&#39; the &#39;DayCountConvention::Enum&#39; value
    // read from the specified input &#39;stream&#39; using the specified &#39;version&#39;
    // format, and return a reference to &#39;stream&#39;.  If &#39;stream&#39; is initially
    // invalid, this operation has no effect.  If &#39;version&#39; is not supported by
    // &#39;DayCountConvention&#39;, &#39;variable&#39; is unaltered and &#39;stream&#39; is
    // invalidated, but otherwise unmodified.  If &#39;version&#39; is supported by
    // &#39;DayCountConvention&#39; but &#39;stream&#39; becomes invalid during this operation,
    // &#39;variable&#39; has an undefined, but valid, state.  The behavior is
    // undefined unless &#39;STREAM&#39; is BDEX-compliant.  Note that no version is
    // read from &#39;stream&#39;.  See the &#39;bslx&#39; package-level documentation for more
    // information on BDEX streaming of value-semantic types and containers.

template &lt;class STREAM&gt;
STREAM&amp; bdexStreamOut(STREAM&amp;                         stream,
                      const DayCountConvention::Enum&amp; value,
                      int                             version);
    // Write the specified &#39;value&#39;, using the specified &#39;version&#39; format, to
    // the specified output &#39;stream&#39;, and return a reference to &#39;stream&#39;.  If
    // &#39;stream&#39; is initially invalid, this operation has no effect.  If
    // &#39;version&#39; is not supported by &#39;DayCountConvention&#39;, &#39;stream&#39; is
    // invalidated, but otherwise unmodified.  The behavior is undefined unless
    // &#39;STREAM&#39; is BDEX-compliant.  Note that &#39;version&#39; is not written to
    // &#39;stream&#39;.  See the &#39;bslx&#39; package-level documentation for more
    // information on BDEX streaming of value-semantic types and containers.

int maxSupportedBdexVersion(const DayCountConvention::Enum *,
                            int                             versionSelector);
    // Return the maximum valid BDEX format version, as indicated by the
    // specified &#39;versionSelector&#39;, to be passed to the &#39;bdexStreamOut&#39; method
    // while streaming an object of the type &#39;DayCountConvention::Enum&#39;.  Note
    // that it is highly recommended that &#39;versionSelector&#39; be formatted as
    // &quot;YYYYMMDD&quot;, a date representation.  Also note that &#39;versionSelector&#39;
    // should be a *compile*-time-chosen value that selects a format version
    // supported by both externalizer and unexternalizer.  See the &#39;bslx&#39;
    // package-level documentation for more information on BDEX streaming of
    // value-semantic types and containers.

// ============================================================================
//                             INLINE DEFINITIONS
// ============================================================================

                        // -------------------------
                        // struct DayCountConvention
                        // -------------------------

// CLASS METHODS
template &lt;class STREAM&gt;
STREAM&amp; DayCountConvention::bdexStreamIn(STREAM&amp;                   stream,
                                         DayCountConvention::Enum&amp; variable,
                                         int                       version)
{
    if (stream) {
        switch (version) { // switch on the schema version
          case 1: {
            char newValue;
            stream.getInt8(newValue);
            if (   stream
                &amp;&amp; e_ACTUAL_360       &lt;= newValue
                &amp;&amp; e_CALENDAR_BUS_252 &gt;= newValue) {
                variable = static_cast&lt;DayCountConvention::Enum&gt;(newValue);
            }
            else {
                stream.invalidate();
            }
          } break;
          default: {
            stream.invalidate();  // unrecognized version number
          }
        }
    }
    return stream;
}

template &lt;class STREAM&gt;
STREAM&amp; DayCountConvention::bdexStreamOut(STREAM&amp;                  stream,
                                          DayCountConvention::Enum value,
                                          int                      version)
{
    if (stream) {
        switch (version) { // switch on the schema version
          case 1: {
            stream.putInt8(static_cast&lt;char&gt;(value));
          } break;
          default: {
            stream.invalidate();  // unrecognized version number
          }
        }
    }
    return stream;
}

inline
int DayCountConvention::maxSupportedBdexVersion(int /* versionSelector */)
{
    return 1;
}


}  // close package namespace

// FREE OPERATORS
inline
bsl::ostream&amp; bbldc::operator&lt;&lt;(bsl::ostream&amp;                   stream,
                                bbldc::DayCountConvention::Enum value)
{
    return bbldc::DayCountConvention::print(stream, value, 0, -1);
}

// FREE FUNCTIONS
template &lt;class STREAM&gt;
STREAM&amp; bbldc::bdexStreamIn(STREAM&amp;                          stream,
                            bbldc::DayCountConvention::Enum&amp; variable,
                            int                              version)
{
    return bbldc::DayCountConvention::bdexStreamIn(stream, variable, version);
}

template &lt;class STREAM&gt;
STREAM&amp; bbldc::bdexStreamOut(STREAM&amp;                                stream,
                             const bbldc::DayCountConvention::Enum&amp; value,
                             int                                    version)
{
    return bbldc::DayCountConvention::bdexStreamOut(stream, value, version);
}

inline
int bbldc::maxSupportedBdexVersion(
                        const bbldc::DayCountConvention::Enum *,
                        int                                    versionSelector)
{
    return bbldc::DayCountConvention::maxSupportedBdexVersion(versionSelector);
}

}  // close enterprise namespace

#endif

// ----------------------------------------------------------------------------
// Copyright 2015 Bloomberg Finance L.P.
//
// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
// ----------------------------- END-OF-FILE ----------------------------------
</pre>
</body>
</html>
