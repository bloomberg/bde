<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>BDE 3.0: bdldfp_decimalimputil Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <style>
      div.hanging {
        padding-left: 0.75in;
        text-indent: -0.50in;
      }
      div.unhanging {
        text-indent:     0in;
      }
      a.glossary {
        font-weight: bold;
        font-style: italic;
      }
    </style>
</head>
<!--
<body onload='searchBox.OnSelectItem(0);'>
-->
<body>

<table border=2 cellspacing=0 cellpadding=0 align=center>
<tr>
 <td valign=top align=center>
 <p align=center><b><i>Quick Links:</i></b></p>
 </td>
 <td valign=top align=center>
 <p align=center>
<a class="qindex" href="group__bal.html" target="_blank">bal</a> | <a class="qindex" href="group__bbl.html" target="_blank">bbl</a> | <a class="qindex" href="group__bdl.html" target="_blank">bdl</a> | <a class="qindex" href="group__bsl.html" target="_blank">bsl</a> | <a class="qindex" href="group__btl.html" target="_blank">btl</a>
 </td>
 </tr>
 </table>

  </div>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="components.html"><span>Components</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<h1>Component bdldfp_decimalimputil<br/>
<small>
[<a class="el" href="group__bdldfp.html">Package bdldfp</a>]</small>
</h1>  </div>
</div>
<div class="contents">

<p>Provide a unified low-level interface for decimal floating point.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebdldfp.html">bdldfp</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="user"><dt><b>Outline</b></dt><dd><ul>
<li>
<a href="#1">Purpose</a> </li>
<li>
<a href="#2">Classes</a> </li>
<li>
<a href="#3">Description</a> <ul>
<li>
<a href="#3.1">Usage</a> <ul>
<li>
<a href="#3.1.1">Example 1: Constructing a Representation of a Value in Decimal</a> </li>
<li>
<a href="#3.1.2">Example 2: Adding Two Decimal Floating Point Values</a> </li>
</ul>
</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="purpose"></a> <a class="anchor" id="1"></a> </dd></dl>
<dl class="user"><dt><b>Purpose: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Provide a unified low-level interface for decimal floating point. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="classes"></a> <a class="anchor" id="2"></a> </dd></dl>
<dl class="user"><dt><b>Classes: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><table class="doxtable">
<tr>
<td><a class="el" href="classbdldfp_1_1DecimalImpUtil.html">bdldfp::DecimalImpUtil</a> </td><td>Unified low-level decimal floating point functions.  </td></tr>
</table>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__bdldfp__decimalimputil__inteldfp.html" title="Provide utility to implement decimal floats on the Intel library.">Component bdldfp_decimalimputil_inteldfp</a>, <a class="el" href="group__bdldfp__decimalimputil__decnumber.html" title="Provide utility implementing decimal FP on the decNumber library.">Component bdldfp_decimalimputil_decnumber</a> </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="description"></a> <a class="anchor" id="3"></a> </dd></dl>
<dl class="user"><dt><b>Description: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This component provides a namespace, <code><a class="el" href="classbdldfp_1_1DecimalImpUtil.html">bdldfp::DecimalImpUtil</a></code>, containing primitive utilities used in the implementation of a decimal floating point type (e.g., see <code>bdldfp_decimal</code>). </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="usage"></a> <a class="anchor" id="description.usage"></a> <a class="anchor" id="3.1"></a> </dd></dl>
<dl class="user"><dt><b>Usage: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This section shows the intended use of this component. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="example_1~3A_constructing_a_representation_of_a_value_in_decimal"></a> <a class="anchor" id="usage.example_1~3A_constructing_a_representation_of_a_value_in_decimal"></a> <a class="anchor" id="description.usage.example_1~3A_constructing_a_representation_of_a_value_in_decimal"></a> <a class="anchor" id="example_1"></a> <a class="anchor" id="usage.example_1"></a> <a class="anchor" id="description.usage.example_1"></a> <a class="anchor" id="3.1.1"></a> </dd></dl>
<dl class="user"><dt><b>Example 1: Constructing a Representation of a Value in Decimal: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>A common requirement for decimal floating point types is to be able to create a value from independent "coefficient" and "exponent" values, where the resulting decimal has the value <code>coefficient * 10 ^ exponent</code>. In the following example we use such a <code>coffecicient</code> and <code>exponent</code> to create <code>Decimal32</code>, <code>Decimal64</code>, and <code>Decimal128</code> values. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>First we define values representing the <code>coefficient</code> and <code>exponent</code> (note the result should be the value 42.5): <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">int</span> coefficient = 425; <span class="comment">// Yet another name for significand</span>
  <span class="keywordtype">int</span> exponent    =  -1;
</pre></div><br/>
<br/>
 Then we call <code>makeDecimal32</code>, <code>makeDecimal64</code>, and <code>makeDecimal128</code> to construct a <code>Decimal32</code>, <code>Decimal64</code>, and <code>Decimal128</code> respectively. <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#ae96dfac46f9c40dc5a8f4203c6cf71fa">bdldfp::DecimalImpUtil::ValueType32</a>  d32 =
            <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#a364c49bbd15238547de75fd4a3c1edfc">bdldfp::DecimalImpUtil::makeDecimalRaw32</a>( coefficient, exponent);
  <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#a48f434ac05252ee1e162dfb251cd4074">bdldfp::DecimalImpUtil::ValueType64</a>  d64 =
            <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#aa193924280195f295713b0b7b28aff2c">bdldfp::DecimalImpUtil::makeDecimalRaw64</a>( coefficient, exponent);
  <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#a6de4b246eeeb612445ad684a14f238da">bdldfp::DecimalImpUtil::ValueType128</a> d128 =
            <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#a142b0f3e260fbb5e1821ffa392f2e150">bdldfp::DecimalImpUtil::makeDecimalRaw128</a>(coefficient, exponent);

  ASSERT(<a class="code" href="classbdldfp_1_1DecimalImpUtil.html#a478f258dc49780832c9cb3657cbd7796">bdldfp::DecimalImpUtil::equal</a>(
                    <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#a98dbf73b03dec085eb13b64e25b44bb0">bdldfp::DecimalImpUtil::binaryToDecimal32</a>( 42.5), d32));
  ASSERT(<a class="code" href="classbdldfp_1_1DecimalImpUtil.html#a478f258dc49780832c9cb3657cbd7796">bdldfp::DecimalImpUtil::equal</a>(
                    <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#a8af5590cc42d9adc008c4e973655b41d">bdldfp::DecimalImpUtil::binaryToDecimal64</a>( 42.5), d64));
  ASSERT(<a class="code" href="classbdldfp_1_1DecimalImpUtil.html#a478f258dc49780832c9cb3657cbd7796">bdldfp::DecimalImpUtil::equal</a>(
                    <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#ac0881cb60a0ba0734f692d2163e68aff">bdldfp::DecimalImpUtil::binaryToDecimal128</a>(42.5), d128));
</pre></div><br/>
<br/>
 </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="example_2~3A_adding_two_decimal_floating_point_values"></a> <a class="anchor" id="usage.example_2~3A_adding_two_decimal_floating_point_values"></a> <a class="anchor" id="description.usage.example_2~3A_adding_two_decimal_floating_point_values"></a> <a class="anchor" id="example_2"></a> <a class="anchor" id="usage.example_2"></a> <a class="anchor" id="description.usage.example_2"></a> <a class="anchor" id="3.1.2"></a> </dd></dl>
<dl class="user"><dt><b>Example 2: Adding Two Decimal Floating Point Values: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Decimal floating point values are frequently used in arithmetic computations where the precise representation of decimal values is of paramount importance (for example, financial calculations, as currency is typically denominated in base-10 decimal values). In the following example we demonstrate computing the sum of a sequence of security prices, where each price is held in a <code>DecimalImpUtil::ValueType64</code> value. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>First, we we define the signature of a function that computes the sum of an array of security prices, and returns that sum as a decimal floating point value: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#a48f434ac05252ee1e162dfb251cd4074">bdldfp::DecimalImpUtil::ValueType64</a>
  totalSecurities(<a class="code" href="classbdldfp_1_1DecimalImpUtil.html#a48f434ac05252ee1e162dfb251cd4074">bdldfp::DecimalImpUtil::ValueType64</a> *prices,
                  <span class="keywordtype">int</span>                                  numPrices)
 Return a Decimal Floating Point number representing the arithmetic
 total of the values specified by <span class="stringliteral">&#39;prices&#39;</span> and <span class="stringliteral">&#39;numPrices&#39;</span>.
  {
</pre></div><br/>
<br/>
 Then, we create a local variable to hold the intermediate sum, and set it to 0: <br/>
<br/>
<div class="fragment"><pre class="fragment">      <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#a48f434ac05252ee1e162dfb251cd4074">bdldfp::DecimalImpUtil::ValueType64</a> total;
      total = <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#ad227f0fabcbdfe659934390a6cbcf2f0">bdldfp::DecimalImpUtil::int32ToDecimal64</a>(0);
</pre></div><br/>
<br/>
 Next, we loop over the array of <code>prices</code> and add each price to the intermediate <code>total</code>: <br/>
<br/>
<div class="fragment"><pre class="fragment">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numPrices; ++i) {
          total = <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#ac883e1e579a52eb4b5b59e58076a63d5">bdldfp::DecimalImpUtil::add</a>(total, prices[i]);
      }
</pre></div><br/>
<br/>
 Now, we return the computed total value of the securities: <br/>
<br/>
<div class="fragment"><pre class="fragment">      <span class="keywordflow">return</span> total;
  }
</pre></div><br/>
<br/>
 Notice that <code>add</code> is called as a function, and is not an operator overload for <code>+</code>; this is because the <code><a class="el" href="classbdldfp_1_1DecimalImpUtil.html">bdldfp::DecimalImpUtil</a></code> utility is intended to be used in the implementation of operator overloads on a more full fledged type. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Finally, we call the function with some sample data, and check the result: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#a48f434ac05252ee1e162dfb251cd4074">bdldfp::DecimalImpUtil::ValueType64</a> data[16];

  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 16; ++i) {
      data[i] = <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#ad227f0fabcbdfe659934390a6cbcf2f0">bdldfp::DecimalImpUtil::int32ToDecimal64</a>(i + 1);
  }

  <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#a48f434ac05252ee1e162dfb251cd4074">bdldfp::DecimalImpUtil::ValueType64</a> result;
  result = totalSecurities(data, 16);

  <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#a48f434ac05252ee1e162dfb251cd4074">bdldfp::DecimalImpUtil::ValueType64</a> expected;

  expected = <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#ad227f0fabcbdfe659934390a6cbcf2f0">bdldfp::DecimalImpUtil::int32ToDecimal64</a>(16);

 Totals of values from 1 to <span class="charliteral">&#39;x&#39;</span> are <span class="stringliteral">&#39;(x * x + x) / 2&#39;</span>:

  expected = <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#ac883e1e579a52eb4b5b59e58076a63d5">bdldfp::DecimalImpUtil::add</a>(
               <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#a095ee9f5c49db13460e953207ef12bf4">bdldfp::DecimalImpUtil::multiply</a>(expected, expected),
               expected);
  expected = <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#a14a4a7052bf1b25105264aa89dc4148e">bdldfp::DecimalImpUtil::divide</a>(
                       expected,
                       <a class="code" href="classbdldfp_1_1DecimalImpUtil.html#ad227f0fabcbdfe659934390a6cbcf2f0">bdldfp::DecimalImpUtil::int32ToDecimal64</a>(2));

  assert(<a class="code" href="classbdldfp_1_1DecimalImpUtil.html#a478f258dc49780832c9cb3657cbd7796">bdldfp::DecimalImpUtil::equal</a>(expected, result));
</pre></div><br/>
<br/>
 Notice that arithmetic is unwieldy and hard to visualize. This is by design, as the DecimalImpUtil and subordinate components are not intended for public consumption, or direct use in decimal arithmetic. </dd></dl>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Apr 1 2016 16:48:43 for BDE Release 3.0 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
