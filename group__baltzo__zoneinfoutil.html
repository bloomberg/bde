<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>BDE 3.0: baltzo_zoneinfoutil Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <style>
      div.hanging {
        padding-left: 0.75in;
        text-indent: -0.50in;
      }
      div.unhanging {
        text-indent:     0in;
      }
      a.glossary {
        font-weight: bold;
        font-style: italic;
      }
    </style>
</head>
<!--
<body onload='searchBox.OnSelectItem(0);'>
-->
<body>

<table border=2 cellspacing=0 cellpadding=0 align=center>
<tr>
 <td valign=top align=center>
 <p align=center><b><i>Quick Links:</i></b></p>
 </td>
 <td valign=top align=center>
 <p align=center>
<a class="qindex" href="group__bal.html" target="_blank">bal</a> | <a class="qindex" href="group__bbl.html" target="_blank">bbl</a> | <a class="qindex" href="group__bdl.html" target="_blank">bdl</a> | <a class="qindex" href="group__bsl.html" target="_blank">bsl</a> | <a class="qindex" href="group__btl.html" target="_blank">btl</a>
 </td>
 </tr>
 </table>

  </div>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="components.html"><span>Components</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<h1>Component baltzo_zoneinfoutil<br/>
<small>
[<a class="el" href="group__baltzo.html">Package baltzo</a>]</small>
</h1>  </div>
</div>
<div class="contents">

<p>Provide utility operations on <code><a class="el" href="classbaltzo_1_1Zoneinfo.html">baltzo::Zoneinfo</a></code> objects.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebaltzo.html">baltzo</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="user"><dt><b>Outline</b></dt><dd><ul>
<li>
<a href="#1">Purpose</a> </li>
<li>
<a href="#2">Classes</a> </li>
<li>
<a href="#3">Description</a> <ul>
<li>
<a href="#3.1">Determining Relevant Transitions with <code>loadRelevantTransitions</code></a> </li>
<li>
<a href="#3.2">Well-Formed Time Zone Information</a> <ul>
<li>
<a href="#3.2.1">Overlapping Transitions</a> </li>
</ul>
</li>
<li>
<a href="#3.3">Usage</a> <ul>
<li>
<a href="#3.3.1">Prologue: Initializing a <code>baltzo::Zoneinfo</code> Object</a> </li>
<li>
<a href="#3.3.2">Example 1: Converting from a UTC Time to a Local Time</a> </li>
<li>
<a href="#3.3.3">Example 2: Determining the Type of a Local Time</a> </li>
</ul>
</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="purpose"></a> <a class="anchor" id="1"></a> </dd></dl>
<dl class="user"><dt><b>Purpose: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Provide utility operations on <code><a class="el" href="classbaltzo_1_1Zoneinfo.html">baltzo::Zoneinfo</a></code> objects. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="classes"></a> <a class="anchor" id="2"></a> </dd></dl>
<dl class="user"><dt><b>Classes: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><table class="doxtable">
<tr>
<td><a class="el" href="structbaltzo_1_1ZoneinfoUtil.html">baltzo::ZoneinfoUtil</a> </td><td>utility for operations on a <code><a class="el" href="classbaltzo_1_1Zoneinfo.html">baltzo::Zoneinfo</a></code> object  </td></tr>
</table>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__baltzo__zoneinfo.html" title="Provide a value type to represent a time zone.">Component baltzo_zoneinfo</a>, <a class="el" href="group__baltzo__localtimevalidity.html" title="Enumerate the set of local time validity codes.">Component baltzo_localtimevalidity</a> </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="description"></a> <a class="anchor" id="3"></a> </dd></dl>
<dl class="user"><dt><b>Description: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This component provides a suite of pure functions that operate on objects of type <code><a class="el" href="classbaltzo_1_1Zoneinfo.html">baltzo::Zoneinfo</a></code>. A <code><a class="el" href="classbaltzo_1_1Zoneinfo.html">baltzo::Zoneinfo</a></code> is a value semantic-type providing information about a time zone, mirroring the information found in the Zoneinfo Database, a public-domain distribution of time zone data (see <code>baltzo_zoneinfo</code> for more information). The primary functions provided by <code><a class="el" href="structbaltzo_1_1ZoneinfoUtil.html">baltzo::ZoneinfoUtil</a></code> are <code>convertUtcToLocalTime</code> and <code>loadRelevantTransitions</code>: <code>convertUtcToLocalTime</code> converts a UTC time into its corresponding local time in the time zone described by the supplied <code><a class="el" href="classbaltzo_1_1Zoneinfo.html">baltzo::Zoneinfo</a></code> object; <code>loadRelevantTransitions</code> returns the transition, from the supplied <code><a class="el" href="classbaltzo_1_1Zoneinfo.html">baltzo::Zoneinfo</a></code> object's list of transitions that describes the attributes of local time in effect at supplied local time; returning two possible transitions in instances where the supplied local time is either invalid or ambiguous (see <code>baltzo_localtimevalidity</code>). Note that the time supplied as input to <code>convertUtcToLocalTime</code> is a <em>UTC</em> time, whereas the time supplied as input to <code>loadRelevantTransitions</code> is a <em>local</em> time. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="determining_relevant_transitions_with_loadrelevanttransitions"></a> <a class="anchor" id="description.determining_relevant_transitions_with_loadrelevanttransitions"></a> <a class="anchor" id="3.1"></a> </dd></dl>
<dl class="user"><dt><b>Determining Relevant Transitions with loadRelevantTransitions: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The function <code>loadRelevantTransitions</code> is used to find the transition in a <code><a class="el" href="classbaltzo_1_1Zoneinfo.html">baltzo::Zoneinfo</a></code> object that describes the properties of a client supplied local time value. In instances where the client supplied local time is either ambiguous or invalid <code>loadRelevantTransitions</code> returns an alternative transition that refers to a second set of properties that could be used to describe the supplied local time. To understand why multiple transitions might be needed, consider the impact of daylight-saving time transitions on local time in New York: <br/>
<br/>
<div class="fragment"><pre class="fragment"> Figure 1: Mapping between UTC <a class="code" href="namespacebdet.html#aac65e816e68f5285b127a9071544c5c1">Time</a> and New York Local <a class="code" href="namespacebdet.html#aac65e816e68f5285b127a9071544c5c1">Time</a>

    EST - Eastern Standard <a class="code" href="namespacebdet.html#aac65e816e68f5285b127a9071544c5c1">Time</a> (UTC-5:00)
    EDT - Eastern Daylight <a class="code" href="namespacebdet.html#aac65e816e68f5285b127a9071544c5c1">Time</a> (UTC-4:00)

                                        ,-invalid times    ,- ambiguous times
                                    T2 /  T3           T4 /   T5
                                    @-----O            @------O

               T1      EST          T2                 T4        EST
 New York <a class="code" href="namespacebdet.html#aac65e816e68f5285b127a9071544c5c1">Time</a> @--------------------O                  @------------------&gt;
                                    |     T3    EDT    |      T5
                                    |     @------------|------O
                                   /   __/            /    __/
                                 /  __/              /  __/
                                /__/                /__/
      UTC <a class="code" href="namespacebdet.html#aac65e816e68f5285b127a9071544c5c1">Time</a> +---------------+-------------------+----------------------&gt;
               |               |                   |
               Transition 1    Transition 2        Transition 3
               (to EST)        (to EDT)            (to EST)
</pre></div><br/>
<br/>
 In New York, clocks are set forward an hour in the spring, creating the discontinuity between T2 and T3 in the diagram. A New York local time value in the range [T2, T3) is considered invalid, because a correctly set clock in New York would never display that value. Similarly, clocks are set back an hour in the fall, creating the discontinuity between T4 and T5 in the diagram. A New York local time value in the range [T4, T5) is considered ambiguous, as local times in that range occur twice. For either invalid or ambiguous times, <code>loadRelevantTransitions</code> will return two distinct iterators referring to the adjacent transitions holding the two descriptions that might be applied to that local time. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>For example, consider the returned validity and transitions for the following New York local times: <br/>
<br/>
<div class="fragment"><pre class="fragment">  New York Local <a class="code" href="namespacebdet.html#aac65e816e68f5285b127a9071544c5c1">Time</a>  Validity     1st Transition      2nd Transition
  -------------------  -----------  ------------------  ------------------
  Jan  1, 2010 2:30am  *_UNIQUE     Nov  1, 2009 (EST)  Nov  1, 2009 (EST)
  Mar 14, 2010 2:30am  *_INVALID    Nov  1, 2009 (EST)  Mar 14, 2010 (EDT)
  Nov  7, 2010 1:30am  *_AMBIGUOUS  Mar 14, 2010 (EDT)  Nov  7, 2010 (EST)
</pre></div><br/>
<br/>
 </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="well-formed_time_zone_information"></a> <a class="anchor" id="description.well-formed_time_zone_information"></a> <a class="anchor" id="3.2"></a> </dd></dl>
<dl class="user"><dt><b>Well-Formed Time Zone Information: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The primary operations provided by this component require the supplied Zoneinfo value meet certain constraints that are not enforced by the <code><a class="el" href="classbaltzo_1_1Zoneinfo.html">baltzo::Zoneinfo</a></code> type itself. A Zoneinfo meeting these constraints is considered <em>well-formed</em>, and <code><a class="el" href="structbaltzo_1_1ZoneinfoUtil.html#a1522e06b36f80fb400330328c607613f">baltzo::ZoneinfoUtil::isWellFormed</a></code> will return <code>true</code> for such a value. Specifically, a <code><a class="el" href="classbaltzo_1_1Zoneinfo.html">baltzo::Zoneinfo</a></code> object is considered well-formed only if <em>all</em> of the following are true: </dd></dl>
<dl class="user"><dt><b></b></dt><dd><ol>
<li>
The Zoneinfo provides at least one transition.  </li>
<li>
The first transition in the Zoneinfo is at the first representable <code><a class="el" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a></code> value, "Jan 01, 0001 00:00" -- i.e., <code>bdlt::Datetime(1, 1, 1)</code>.  </li>
<li>
There is no transition in the ordered sequence of transitions described by the Zoneinfo where local clock time is adjusted (either forwards or backwards) introducing a period of invalid or ambiguous local times, where that range of invalid or ambiguous local times overlaps with the range of invalid or ambiguous local times introduced by subsequent transition.  </li>
</ol>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd>Note that <code><a class="el" href="structbaltzo_1_1ZoneinfoUtil.html#a1522e06b36f80fb400330328c607613f">baltzo::ZoneinfoUtil::isWellFormed</a></code> has linear complexity with respect to the number of transitions that the Zoneinfo value defines. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="overlapping_transitions"></a> <a class="anchor" id="well-formed_time_zone_information.overlapping_transitions"></a> <a class="anchor" id="description.well-formed_time_zone_information.overlapping_transitions"></a> <a class="anchor" id="3.2.1"></a> </dd></dl>
<dl class="user"><dt><b>Overlapping Transitions: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>In order to better understand the 3rd constraint (above) on a well-formed Zoneinfo object, first, notice that Figure 1 above (showing local time in New York) illustrates a well-formed sequence of transitions. Both Transition 2 (to EDT) and Transition 3 (to EST) introduce a range of ambiguous or invalid times (ambiguous when clocks are adjusted backwards, invalid when clocks are adjusted forward), but those two ranges of ambiguous and invalid local times do not overlap. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>However, a Zoneinfo object is not well-formed if two transitions occur so close together that the respective ranges of invalid or ambiguous times that those transitions introduce, overlap with one and other, as illustrated in Figure 2. <br/>
<br/>
<div class="fragment"><pre class="fragment">  Figure 2:  Overlapping Transitions

  Standard <a class="code" href="namespacebdet.html#aac65e816e68f5285b127a9071544c5c1">Time</a> (STD):        UTC+00:00
  Daylight-Saving Time (DST): UTC+01:00

  Transition 1 (to DST): At 00:00 UTC (00:00 local)
  Transition 2 (to STD): At 00:30 UTC (01:30 local)

                                   (00:30)    STD
                    STD   (00:00)    @--------------------------
    Local Time @------------O        |           DST
                            |        | (01:00) @------O (01:30)
                            |        |      __/     _/
                             \        \  __/     __/
                              \      __\/     __/
                               \ ___/   \ __/
      UTC Time +---------------+---------+----------------------------
                          Transition 1   Transition 2
                           (01:00 UTC)   (01:30 UTC)
</pre></div><br/>
<br/>
 Notice that between [ 00:30 .. 01:00 ] local time, the range of invalid times introduced by Transition 1, overlaps with the range of ambiguous times introduced by Transition 2. The above time zone would therefore <em>not</em> be well-formed. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="usage"></a> <a class="anchor" id="description.usage"></a> <a class="anchor" id="3.3"></a> </dd></dl>
<dl class="user"><dt><b>Usage: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>The following examples demonstrate how to use a <code>ZoneinfoUtil</code> to perform common operations on time values using a Zoneinfo description of a time zone. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="prologue~3A_initializing_a_baltzo~3A~3Azoneinfo_object"></a> <a class="anchor" id="usage.prologue~3A_initializing_a_baltzo~3A~3Azoneinfo_object"></a> <a class="anchor" id="description.usage.prologue~3A_initializing_a_baltzo~3A~3Azoneinfo_object"></a> <a class="anchor" id="prologue"></a> <a class="anchor" id="usage.prologue"></a> <a class="anchor" id="description.usage.prologue"></a> <a class="anchor" id="3.3.1"></a> </dd></dl>
<dl class="user"><dt><b>Prologue: Initializing a baltzo::Zoneinfo Object: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>We start by creating a Zoneinfo time zone description for New York, which we will use in subsequent examples. Note that, in practice, clients should obtain time zone information from a data source (see <code>baltzo_zoneinfocache</code>). </dd></dl>
<dl class="user"><dt><b></b></dt><dd>First we create a Zoneinfo object for New York, and populate <code>newYork</code> with the correct time zone identifier: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbaltzo_1_1Zoneinfo.html">baltzo::Zoneinfo</a> newYork;
  newYork.<a class="code" href="classbaltzo_1_1Zoneinfo.html#a176a8296b42238b18b016237f2020c31">setIdentifier</a>(<span class="stringliteral">&quot;America/New_York&quot;</span>);
</pre></div><br/>
<br/>
 Next we create two local-time descriptors, one for standard time and one for daylight-saving time: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbaltzo_1_1LocalTimeDescriptor.html">baltzo::LocalTimeDescriptor</a> est(-18000, <span class="keyword">false</span>, <span class="stringliteral">&quot;EST&quot;</span>);
  <a class="code" href="classbaltzo_1_1LocalTimeDescriptor.html">baltzo::LocalTimeDescriptor</a> edt(-14400, <span class="keyword">true</span>,  <span class="stringliteral">&quot;EDT&quot;</span>);
</pre></div><br/>
<br/>
 Then we set the initial descriptor for <code>newYork</code> to Eastern Standard Time. Note that such an initial transition is required for a <code><a class="el" href="classbaltzo_1_1Zoneinfo.html">baltzo::Zoneinfo</a></code> object to be considered Well-Formed (see <code>isWellFormed</code>): <br/>
<br/>
<div class="fragment"><pre class="fragment">  newYork.<a class="code" href="classbaltzo_1_1Zoneinfo.html#a88adb8085067b19e1eca4298ffd1ef4d">addTransition</a>(<a class="code" href="structbdlt_1_1EpochUtil.html#ad2deb9a4b28c2ea9a6f72de238f7298b">bdlt::EpochUtil::convertToTimeT64</a>(
                                                    <a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a>(1, 1, 1)),
                        est);
</pre></div><br/>
<br/>
 Next we create a series of transitions between these local-time descriptors for the years 2007-2011. Note that the United States transitions to daylight saving time on the second Sunday in March, at 2am local time (07:00 UTC), and transitions back to standard time on the first Sunday in November at 2am local time (06:00 UTC), resulting in an even number of transitions: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a> TRANSITION_TIMES[] = {
      <a class="code" href="namespacebdet.html#a7cc67ae2240c06a6a70bf001c5a858b5">bdlt::Datetime</a>(2007,  3, 11, 7),
      <a class="code" href="namespacebdet.html#a7cc67ae2240c06a6a70bf001c5a858b5">bdlt::Datetime</a>(2007, 11,  4, 6),
      <a class="code" href="namespacebdet.html#a7cc67ae2240c06a6a70bf001c5a858b5">bdlt::Datetime</a>(2008,  3,  9, 7),
      <a class="code" href="namespacebdet.html#a7cc67ae2240c06a6a70bf001c5a858b5">bdlt::Datetime</a>(2008, 11,  2, 6),
      <a class="code" href="namespacebdet.html#a7cc67ae2240c06a6a70bf001c5a858b5">bdlt::Datetime</a>(2009,  3,  8, 7),
      <a class="code" href="namespacebdet.html#a7cc67ae2240c06a6a70bf001c5a858b5">bdlt::Datetime</a>(2009, 11,  1, 6),
      <a class="code" href="namespacebdet.html#a7cc67ae2240c06a6a70bf001c5a858b5">bdlt::Datetime</a>(2010,  3, 14, 7),
      <a class="code" href="namespacebdet.html#a7cc67ae2240c06a6a70bf001c5a858b5">bdlt::Datetime</a>(2010, 11,  7, 6),
      <a class="code" href="namespacebdet.html#a7cc67ae2240c06a6a70bf001c5a858b5">bdlt::Datetime</a>(2011,  3, 13, 7),
      <a class="code" href="namespacebdet.html#a7cc67ae2240c06a6a70bf001c5a858b5">bdlt::Datetime</a>(2011, 11,  6, 6),
  };
  <span class="keyword">const</span> <span class="keywordtype">int</span> NUM_TRANSITION_TIMES =
                          <span class="keyword">sizeof</span> TRANSITION_TIMES / <span class="keyword">sizeof</span> *TRANSITION_TIMES;
  assert(0 == NUM_TRANSITION_TIMES % 2);

  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; NUM_TRANSITION_TIMES; i += 2) {
      newYork.<a class="code" href="classbaltzo_1_1Zoneinfo.html#a88adb8085067b19e1eca4298ffd1ef4d">addTransition</a>(<a class="code" href="structbdlt_1_1EpochUtil.html#ad2deb9a4b28c2ea9a6f72de238f7298b">bdlt::EpochUtil::convertToTimeT64</a>(
                                                        TRANSITION_TIMES[i]),
                            edt);
      newYork.<a class="code" href="classbaltzo_1_1Zoneinfo.html#a88adb8085067b19e1eca4298ffd1ef4d">addTransition</a>(<a class="code" href="structbdlt_1_1EpochUtil.html#ad2deb9a4b28c2ea9a6f72de238f7298b">bdlt::EpochUtil::convertToTimeT64</a>(
                                                    TRANSITION_TIMES[i + 1]),
                            est);
  }
</pre></div><br/>
<br/>
 Finally we verify that the time zone information we've created is considered well-formed (as discussed above): <br/>
<br/>
<div class="fragment"><pre class="fragment">  assert(<span class="keyword">true</span> == <a class="code" href="structbaltzo_1_1ZoneinfoUtil.html#a1522e06b36f80fb400330328c607613f">baltzo::ZoneinfoUtil::isWellFormed</a>(newYork));
</pre></div><br/>
<br/>
 </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="example_1~3A_converting_from_a_utc_time_to_a_local_time"></a> <a class="anchor" id="usage.example_1~3A_converting_from_a_utc_time_to_a_local_time"></a> <a class="anchor" id="description.usage.example_1~3A_converting_from_a_utc_time_to_a_local_time"></a> <a class="anchor" id="example_1"></a> <a class="anchor" id="usage.example_1"></a> <a class="anchor" id="description.usage.example_1"></a> <a class="anchor" id="3.3.2"></a> </dd></dl>
<dl class="user"><dt><b>Example 1: Converting from a UTC Time to a Local Time: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>In this example we demonstrate how to convert a UTC time to the corresponding local time using the <code>convertUtcToLocalTime</code> class method. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>We start by creating a <code><a class="el" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a></code> representing the UTC time "Dec 12,
 2010 15:00": <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a> utcTime(2010, 12, 12, 15, 0, 0);
</pre></div><br/>
<br/>
 Now, we call <code>convertUtcToLocalTime</code> and supply as input both <code>utcTime</code> and the Zoneinfo description for <code>newYork</code> (which we initialized in the prologue above): <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbdlt_1_1DatetimeTz.html">bdlt::DatetimeTz</a>                          localNYTime;
  <a class="code" href="classbaltzo_1_1Zoneinfo.html#a8dea54525e5ac399cbdb3800fb40aa54">baltzo::Zoneinfo::TransitionConstIterator</a> iterator;
  <a class="code" href="structbaltzo_1_1ZoneinfoUtil.html#ad5ef5d9bc5686af9606c740a7a90f395">baltzo::ZoneinfoUtil::convertUtcToLocalTime</a>(&amp;localNYTime,
                                              &amp;iterator,
                                              utcTime,
                                              newYork);
</pre></div><br/>
<br/>
 Then we verify that <code>localNYTime</code> is "Dec 12, 2010 10:00+5:00", the time in New York corresponding to the UTC time "Dec 12, 2010 15:00". <br/>
<br/>
<div class="fragment"><pre class="fragment">  assert(utcTime                          == localNYTime.<a class="code" href="classbdlt_1_1DatetimeTz.html#ab899e49044125b091602d3007a70b535">utcDatetime</a>());
  assert(<a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a>(2010, 12, 12, 10) == localNYTime.<a class="code" href="classbdlt_1_1DatetimeTz.html#a54b9d6329ad4d98edf845a6c5cfe5321">localDatetime</a>());
  assert(-5 * 60                          == localNYTime.<a class="code" href="classbdlt_1_1DatetimeTz.html#ae8ef8eb16e1ce5ffba6354f9935c61b4">offset</a>());
</pre></div><br/>
<br/>
 Finally, we verify that the returned <code>iterator</code> refers to the local-time transition immediately before <code>utcTime</code>, and that that transition refers to a local-time descriptor characterizing standard-time in New York: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbaltzo_1_1Zoneinfo.html#a8dea54525e5ac399cbdb3800fb40aa54">baltzo::Zoneinfo::TransitionConstIterator</a> transitionIter     = iterator;
  <a class="code" href="classbaltzo_1_1Zoneinfo.html#a8dea54525e5ac399cbdb3800fb40aa54">baltzo::Zoneinfo::TransitionConstIterator</a> nextTransitionIter = ++iterator;

  <span class="keyword">const</span> <a class="code" href="structbdlt_1_1EpochUtil.html#aba3efca2d258e16871da8623f5922e86">bdlt::EpochUtil::TimeT64</a> utcTimeT =
                                   bdlt::EpochUtil::converToTimeT64(utcTime);
  assert(utcTimeT &gt;= transitionIter-&gt;transition());
  assert(utcTimeT &lt;  nextTransitionIter-&gt;transition());

  assert(<span class="keyword">false</span>        == transitionIter-&gt;descriptor().dstInEffectFlag());
  assert(-5 * 60 * 60 == transitionIter-&gt;descriptor().utcOffsetInSeconds());
  assert(<span class="stringliteral">&quot;EST&quot;</span>        == transitionIter-&gt;descriptor().description());
</pre></div><br/>
<br/>
 </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="example_2~3A_determining_the_type_of_a_local_time"></a> <a class="anchor" id="usage.example_2~3A_determining_the_type_of_a_local_time"></a> <a class="anchor" id="description.usage.example_2~3A_determining_the_type_of_a_local_time"></a> <a class="anchor" id="example_2"></a> <a class="anchor" id="usage.example_2"></a> <a class="anchor" id="description.usage.example_2"></a> <a class="anchor" id="3.3.3"></a> </dd></dl>
<dl class="user"><dt><b>Example 2: Determining the Type of a Local Time: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>In this next example we use <code>loadRelevantTransitions</code> to determine the local-time descriptor (see <code>baltzo_localtimedescriptor</code>) that applies to a local time value, represented using a <code><a class="el" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a></code> object. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>We start by defining a <code><a class="el" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a></code> object for "Jan 1, 2011 12:00" in New York: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a> nyLocalTime(2011, 1, 1, 12);
</pre></div><br/>
<br/>
 Then, we call <code>loadRelevantTransitions</code>, and supply, as input, both <code>nyLocalTime</code> and the Zoneinfo description for <code>newYork</code> (which we initialized in the prologue above): <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="structbaltzo_1_1LocalTimeValidity.html#ac70d940922ccf1141ad56f60327200c2">baltzo::LocalTimeValidity::Enum</a>           validity;
  <a class="code" href="classbaltzo_1_1Zoneinfo.html#a8dea54525e5ac399cbdb3800fb40aa54">baltzo::Zoneinfo::TransitionConstIterator</a> firstTransition;
  <a class="code" href="classbaltzo_1_1Zoneinfo.html#a8dea54525e5ac399cbdb3800fb40aa54">baltzo::Zoneinfo::TransitionConstIterator</a> secondTransition;
  <a class="code" href="structbaltzo_1_1ZoneinfoUtil.html#a83b1d60c40fb606934c97b90becffdb0">baltzo::ZoneinfoUtil::loadRelevantTransitions</a>(&amp;firstTransition,
                                                &amp;secondTransition,
                                                &amp;validity,
                                                nyLocalTime,
                                                newYork);
</pre></div><br/>
<br/>
 "Jan 1, 2011 12:00" in New York, is not near a daylight-saving time transition, so it uniquely describes a valid time (in New York) which falls during Eastern Standard Time, and whose local time offset from UTC is -5:00. Because "Jan 1, 2011 12:00" is both a valid and unique local time, the returned validity will be <code><a class="el" href="structbaltzo_1_1LocalTimeValidity.html#ac70d940922ccf1141ad56f60327200c2a90d2831403f41dd4631a2603d6550935" title="Local time is valid and unique.">baltzo::LocalTimeValidity::e_VALID_UNIQUE</a></code> and the two returned transition iterators will be equal: <br/>
<br/>
<div class="fragment"><pre class="fragment">  assert(<a class="code" href="structbaltzo_1_1LocalTimeValidity.html#ac70d940922ccf1141ad56f60327200c2a90d2831403f41dd4631a2603d6550935" title="Local time is valid and unique.">baltzo::LocalTimeValidity::e_VALID_UNIQUE</a> == validity);
  assert(firstTransition == secondTransition);

  assert(<span class="keyword">false</span>    == firstTransition-&gt;descriptor().dstInEffectFlag());
  assert(-5*60*60 == firstTransition-&gt;descriptor().utcOffsetInSeconds());
  assert(<span class="stringliteral">&quot;EST&quot;</span>    == firstTransition-&gt;descriptor().description());
</pre></div><br/>
<br/>
 Next, we create a second <code><a class="el" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a></code> object to represent "Nov 7, 2010
 1:30" in New York. Note that the clock time "Nov 7, 2010 1:30" occurred twice in New York, as clocks were set back by an hour an instant before the local clock would have reached "Nov 7, 2010 02:00 EDT", and it is therefore ambiguous which of those two values that local time is meant to refer. <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="classbdlt_1_1Datetime.html">bdlt::Datetime</a> ambiguousLocalTime(2010, 11, 7, 1, 30);
</pre></div><br/>
<br/>
 Now, we call <code>loadRelevantTransitions</code>, this time supplying <code>ambiguousLocalTime</code>: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="structbaltzo_1_1ZoneinfoUtil.html#a83b1d60c40fb606934c97b90becffdb0">baltzo::ZoneinfoUtil::loadRelevantTransitions</a>(&amp;firstTransition,
                                                &amp;secondTransition,
                                                &amp;validity,
                                                ambiguousLocalTime,
                                                newYork);
</pre></div><br/>
<br/>
 Finally we observe that the local time was ambiguous and that the returned transitions are distinct: <br/>
<br/>
<div class="fragment"><pre class="fragment">  assert(<a class="code" href="structbaltzo_1_1LocalTimeValidity.html#ac70d940922ccf1141ad56f60327200c2a1da4195553eb90bbb8c34b6f5f02db46" title="Local time is valid, but ambiguous.">baltzo::LocalTimeValidity::e_VALID_AMBIGUOUS</a> == validity);
  assert(firstTransition != secondTransition);
</pre></div><br/>
<br/>
 Because <code>ambiguousLocalTime</code> may refer to either the standard or the daylight-saving time value "Nov 7, 2010 01:30", the returned validity will be <code>e_VALID_AMBIGUOUS</code>, and the <code>first</code> and <code>second</code> iterators will differ. <code>first</code> will refer to a description of the local time before the transition (daylight-saving time) and <code>second</code> will refer to a description of local time after the transition (standard-time): <br/>
<br/>
<div class="fragment"><pre class="fragment">  assert(<span class="keyword">true</span>      == firstTransition-&gt;descriptor().dstInEffectFlag());
  assert(-4*60*60  == firstTransition-&gt;descriptor().utcOffsetInSeconds());
  assert(<span class="stringliteral">&quot;EDT&quot;</span>     == firstTransition-&gt;descriptor().description());

  assert(<span class="keyword">false</span>     == secondTransition-&gt;descriptor().dstInEffectFlag());
  assert(-5*60*60  == secondTransition-&gt;descriptor().utcOffsetInSeconds());
  assert(<span class="stringliteral">&quot;EST&quot;</span>     == secondTransition-&gt;descriptor().description());
</pre></div><br/>
<br/>
 Note that the two transitions returned are adjacent: <br/>
<br/>
<div class="fragment"><pre class="fragment">  ++firstTransition;
  assert(firstTransition == secondTransition);
</pre></div><br/>
<br/>
 </dd></dl>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Apr 1 2016 16:48:31 for BDE Release 3.0 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
