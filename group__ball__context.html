<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>BDE 3.0: ball_context Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <style>
      div.hanging {
        padding-left: 0.75in;
        text-indent: -0.50in;
      }
      div.unhanging {
        text-indent:     0in;
      }
      a.glossary {
        font-weight: bold;
        font-style: italic;
      }
    </style>
</head>
<!--
<body onload='searchBox.OnSelectItem(0);'>
-->
<body>

<table border=2 cellspacing=0 cellpadding=0 align=center>
<tr>
 <td valign=top align=center>
 <p align=center><b><i>Quick Links:</i></b></p>
 </td>
 <td valign=top align=center>
 <p align=center>
<a class="qindex" href="group__bal.html" target="_blank">bal</a> | <a class="qindex" href="group__bbl.html" target="_blank">bbl</a> | <a class="qindex" href="group__bdl.html" target="_blank">bdl</a> | <a class="qindex" href="group__bsl.html" target="_blank">bsl</a> | <a class="qindex" href="group__btl.html" target="_blank">btl</a>
 </td>
 </tr>
 </table>

  </div>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="components.html"><span>Components</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<h1>Component ball_context<br/>
<small>
[<a class="el" href="group__ball.html">Package ball</a>]</small>
</h1>  </div>
</div>
<div class="contents">

<p>Provide a container for the context of a transmitted log record.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceball.html">ball</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="user"><dt><b>Outline</b></dt><dd><ul>
<li>
<a href="#1">Purpose</a> </li>
<li>
<a href="#2">Classes</a> </li>
<li>
<a href="#3">Description</a> <ul>
<li>
<a href="#3.1">Constraints</a> </li>
<li>
<a href="#3.2">Usage</a> </li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="purpose"></a> <a class="anchor" id="1"></a> </dd></dl>
<dl class="user"><dt><b>Purpose: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Provide a container for the context of a transmitted log record. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="classes"></a> <a class="anchor" id="2"></a> </dd></dl>
<dl class="user"><dt><b>Classes: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><table class="doxtable">
<tr>
<td><a class="el" href="classball_1_1Context.html">ball::Context</a> </td><td>context of a transmitted log record  </td></tr>
</table>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__ball__transmission.html" title="Enumerate the set of states for log record transmission.">Component ball_transmission</a>, <a class="el" href="group__ball__observer.html" title="Define a protocol for receiving and processing log records.">Component ball_observer</a>, <a class="el" href="group__ball__record.html" title="Provide a container for all fields of a log record.">Component ball_record</a> </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="description"></a> <a class="anchor" id="3"></a> </dd></dl>
<dl class="user"><dt><b>Description: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This component defines a container for aggregating a message's publication cause, as well as the record (or message) index and sequence length of messages delivered as part of a message sequence. Note that messages that are not part of a sequence (i.e., PASSTHROUGH) will have the index and sequence length fields set to 0 and 1, respectively. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>The context attributes held by <code><a class="el" href="classball_1_1Context.html">ball::Context</a></code> are detailed in the following table: <br/>
<br/>
<div class="fragment"><pre class="fragment">  Attribute          <a class="code" href="classBind__ImplSelector_1_1Type.html">Type</a>                      Description        Default
  -----------------  ------------------------  -----------------  -----------
  transmissionCause  <a class="code" href="structball_1_1Transmission.html#a0a918d700a10b34f454db48c83e6b884">ball::Transmission::Cause</a> cause of output    PASSTHROUGH
  recordIndex        <span class="keywordtype">int</span>                       index in sequence  0
  sequenceLength     <span class="keywordtype">int</span>                       # records in seq.  1
</pre></div><br/>
<br/>
 </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="constraints"></a> <a class="anchor" id="description.constraints"></a> <a class="anchor" id="3.1"></a> </dd></dl>
<dl class="user"><dt><b>Constraints: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This attribute class assumes that the following constraints on contained values hold: <br/>
<br/>
<div class="fragment"><pre class="fragment">    <span class="keywordflow">if</span> (<a class="code" href="structball_1_1Transmission.html#a0a918d700a10b34f454db48c83e6b884a90581f225b7057edac1d0476d64a31ce" title="single record emitted; caused locally">ball::Transmission::e_PASSTHROUGH</a> == transmissionCause()) {
        assert(0 == recordIndex());
        assert(1 == sequenceLength());
    }
    <span class="keywordflow">else</span> {
        assert(
         <a class="code" href="structball_1_1Transmission.html#a0a918d700a10b34f454db48c83e6b884abd21e687035775c8816768da3ca49444" title="all records emitted; caused locally">ball::Transmission::e_TRIGGER</a>            == transmissionCause()
      || <a class="code" href="structball_1_1Transmission.html#a0a918d700a10b34f454db48c83e6b884ada40b229ff7f3aeaf78e4017d5ab351d" title="all records emitted; caused remotely">ball::Transmission::e_TRIGGER_ALL</a>        == transmissionCause()
      || <a class="code" href="structball_1_1Transmission.html#a0a918d700a10b34f454db48c83e6b884a22f298592355f55f0c33a4110b7f106e" title="manually publish a single record">ball::Transmission::e_MANUAL_PUBLISH</a>     == transmissionCause()
      || <a class="code" href="structball_1_1Transmission.html#a0a918d700a10b34f454db48c83e6b884aed905ada4a699994372cbf84f33ebdb2" title="manually publish all records">ball::Transmission::e_MANUAL_PUBLISH_ALL</a> == transmissionCause());
        assert(0 &lt;= recordIndex());
        assert(1 &lt;= sequenceLength());
        assert(recordIndex() &lt; sequenceLength());
    }
</pre></div><br/>
<br/>
 A static <code>isValid</code> method is provided to verify that particular <code>transmissionCause</code>, <code>recordIndex</code>, and <code>sequenceLength</code> values are valid before they are used to create or (unilaterally) modify a context object. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="usage"></a> <a class="anchor" id="description.usage"></a> <a class="anchor" id="3.2"></a> </dd></dl>
<dl class="user"><dt><b>Usage: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>A <code><a class="el" href="classball_1_1Context.html">ball::Context</a></code> object holds sufficient information to determine the length of a message sequence and the index of a message within that sequence. In addition, <code><a class="el" href="classball_1_1Context.html">ball::Context</a></code> indicates the cause for the transmission of a message. The following example illustrates the essentials of working with these contextual attributes. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>This example illustrates the use of <code><a class="el" href="classball_1_1Context.html">ball::Context</a></code> by a hypothetical logging system. First we define a simple logger class named <code>my_Logger</code>: <br/>
<br/>
<div class="fragment"><pre class="fragment">    <span class="comment">// my_logger.h</span>

<span class="preprocessor">    #include &lt;string&gt;</span>
<span class="preprocessor">    #include &lt;vector&gt;</span>

    <span class="keyword">class </span>my_Logger {

        <a class="code" href="classbsl_1_1vector.html">bsl::vector&lt;bsl::string&gt;</a> archive;  <span class="comment">// log message archive</span>

        <span class="comment">// NOT IMPLEMENTED</span>
        my_Logger(<span class="keyword">const</span> my_Logger&amp;);
        my_Logger&amp; operator=(<span class="keyword">const</span> my_Logger&amp;);

        <span class="comment">// PRIVATE MANIPULATORS</span>
        <span class="keywordtype">void</span> publish(<span class="keyword">const</span> <a class="code" href="classbsl_1_1basic__string.html">bsl::string</a>&amp;  message,
                     <span class="keyword">const</span> <a class="code" href="classball_1_1Context.html">ball::Context</a>&amp; context);

      <span class="keyword">public</span>:
        <span class="comment">// TYPES</span>
        <span class="keyword">enum</span> Severity { ERROR = 0, WARN = 1, TRACE = 2 };

        <span class="comment">// CREATORS</span>
        my_Logger();
        ~my_Logger();

        <span class="comment">// MANIPULATORS</span>
        <span class="keywordtype">void</span> logMessage(<span class="keyword">const</span> <a class="code" href="classbsl_1_1basic__string.html">bsl::string</a>&amp; message, Severity severity);
    };
</pre></div><br/>
<br/>
 Clients of <code>my_Logger</code> log messages at one of three severity levels through the <code>logMessage</code> method. Messages logged with <code>TRACE</code> severity are simply archived by <code>my_Logger</code>. Messages logged with <code>WARN</code> severity are archived and also output to <code>stdout</code> (say, to a console terminal overseen by an operator) through the <code>publish</code> method. Messages logged with <code>ERROR</code> severity report serious conditions; these trigger a dump of the backlog of messages that <code>my_Logger</code> has archived to that point. The <code><a class="el" href="classball_1_1Context.html">ball::Context</a></code> argument passed to <code>publish</code> provides contextual information regarding the message it is being asked to publish. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>A complete implementation of this trivial logger follows: <br/>
<br/>
<div class="fragment"><pre class="fragment">    <span class="comment">// my_Logger.cpp</span>

    <span class="comment">// PRIVATE MANIPULATORS</span>
    <span class="keywordtype">void</span> my_Logger::publish(<span class="keyword">const</span> <a class="code" href="classbsl_1_1basic__string.html">bsl::string</a>&amp;  message,
                            <span class="keyword">const</span> <a class="code" href="classball_1_1Context.html">ball::Context</a>&amp; context)
    {
        <span class="keyword">using namespace </span>std;

        <span class="keywordflow">switch</span> (context.<a class="code" href="classball_1_1Context.html#a5fe37ac6c8ca606cf8251abd42097a06">transmissionCause</a>()) {
          <span class="keywordflow">case</span> <a class="code" href="structball_1_1Transmission.html#a0a918d700a10b34f454db48c83e6b884a90581f225b7057edac1d0476d64a31ce" title="single record emitted; caused locally">ball::Transmission::e_PASSTHROUGH</a>: {
            cout &lt;&lt; <span class="stringliteral">&quot;Single Pass-through Message: &quot;</span>;
          } <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> <a class="code" href="structball_1_1Transmission.html#a0a918d700a10b34f454db48c83e6b884ada40b229ff7f3aeaf78e4017d5ab351d" title="all records emitted; caused remotely">ball::Transmission::e_TRIGGER_ALL</a>: {
            cout &lt;&lt; <span class="stringliteral">&quot;Remotely &quot;</span>;               <span class="comment">// no &#39;break&#39;; concatenated</span>
                                               <span class="comment">// output</span>
          } <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> <a class="code" href="structball_1_1Transmission.html#a0a918d700a10b34f454db48c83e6b884abd21e687035775c8816768da3ca49444" title="all records emitted; caused locally">ball::Transmission::e_TRIGGER</a>: {
            cout &lt;&lt; <span class="stringliteral">&quot;Triggered Publication Sequence: Message &quot;</span>
                 &lt;&lt; context.<a class="code" href="classball_1_1Context.html#a1b400168b29c65ae8911e30e02bd7ee9">recordIndex</a>() + 1  <span class="comment">// Account for 0-based index.</span>
                 &lt;&lt; <span class="stringliteral">&quot; of &quot;</span> &lt;&lt; context.<a class="code" href="classball_1_1Context.html#adc2b4bb380bb9840cc2d61a1481c9d18">sequenceLength</a>() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;
          } <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> <a class="code" href="structball_1_1Transmission.html#a0a918d700a10b34f454db48c83e6b884a22f298592355f55f0c33a4110b7f106e" title="manually publish a single record">ball::Transmission::e_MANUAL_PUBLISH</a>: {
            cout &lt;&lt; <span class="stringliteral">&quot;Manually triggered Message: &quot;</span>;
          } <span class="keywordflow">break</span>;
          <span class="keywordflow">default</span>: {
            cout &lt;&lt; <span class="stringliteral">&quot;***ERROR*** Unsupported Message Cause: &quot;</span>;
            <span class="keywordflow">return</span>;
          } <span class="keywordflow">break</span>;
        }
        cout &lt;&lt; message &lt;&lt; endl;
    }

    <span class="comment">// CREATORS</span>
    my_Logger::my_Logger() { }
    my_Logger::~my_Logger() { }

    <span class="comment">// MANIPULATORS</span>
    <span class="keywordtype">void</span> my_Logger::logMessage(<span class="keyword">const</span> <a class="code" href="classbsl_1_1basic__string.html">bsl::string</a>&amp; message, Severity severity)
    {
        archive.<a class="code" href="group__bslstl__string.html#ga04c57c5865f3f86b1add2be7077c5eb1">append</a>(message);
        <span class="keywordflow">switch</span> (severity) {
          <span class="keywordflow">case</span> TRACE: {
            <span class="comment">// Do nothing beyond archiving the message.</span>
          } <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> WARN: {
            <a class="code" href="classball_1_1Context.html">ball::Context</a> context(<a class="code" href="structball_1_1Transmission.html#a0a918d700a10b34f454db48c83e6b884a90581f225b7057edac1d0476d64a31ce" title="single record emitted; caused locally">ball::Transmission::e_PASSTHROUGH</a>,
                                  0,
                                  1);
            publish(message, context);
          } <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> ERROR: {
            <span class="keywordtype">int</span> index  = 0;
            <span class="keywordtype">int</span> length = archive.length();
            <a class="code" href="classball_1_1Context.html">ball::Context</a> context(<a class="code" href="structball_1_1Transmission.html#a0a918d700a10b34f454db48c83e6b884abd21e687035775c8816768da3ca49444" title="all records emitted; caused locally">ball::Transmission::e_TRIGGER</a>,
                                 index, length);
            <span class="keywordflow">while</span> (length--) {
                publish(archive[length], context);
                context.<a class="code" href="classball_1_1Context.html#af28843ad923c1260088bacb194ba0d1f">setRecordIndexRaw</a>(++index);
            }
            archive.removeAll();  <span class="comment">// flush archive</span>
          } <span class="keywordflow">break</span>;
        }
    }
</pre></div><br/>
<br/>
 Note that <code><a class="el" href="structball_1_1Transmission.html#a0a918d700a10b34f454db48c83e6b884ada40b229ff7f3aeaf78e4017d5ab351d" title="all records emitted; caused remotely">ball::Transmission::e_TRIGGER_ALL</a></code> is not used by <code>my_Logger</code>, but is included in the switch statement for completeness. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Finally, we declare a <code>my_Logger</code> named <code>logger</code> and simulate the logging of several messages of varying severity: <br/>
<br/>
<div class="fragment"><pre class="fragment">      my_Logger   logger;
      <a class="code" href="classbsl_1_1basic__string.html">bsl::string</a> message;

      message = <span class="stringliteral">&quot;TRACE 1&quot;</span>;  logger.logMessage(message, my_Logger::TRACE);
      message = <span class="stringliteral">&quot;TRACE 2&quot;</span>;  logger.logMessage(message, my_Logger::TRACE);
      message = <span class="stringliteral">&quot;WARNING&quot;</span>;  logger.logMessage(message, my_Logger::WARN);
      message = <span class="stringliteral">&quot;TRACE 3&quot;</span>;  logger.logMessage(message, my_Logger::TRACE);
      message = <span class="stringliteral">&quot;TROUBLE!&quot;</span>; logger.logMessage(message, my_Logger::ERROR);
</pre></div><br/>
<br/>
 The following output is produced on <code>stdout</code>: <br/>
<br/>
<div class="fragment"><pre class="fragment">      Single Pass-through Message: WARNING
      Triggered Publication Sequence: Message 1 of 5: TROUBLE!
      Triggered Publication Sequence: Message 2 of 5: TRACE 3
      Triggered Publication Sequence: Message 3 of 5: WARNING
      Triggered Publication Sequence: Message 4 of 5: TRACE 2
      Triggered Publication Sequence: Message 5 of 5: TRACE 1
</pre></div><br/>
<br/>
 Note that the warning message (severity <code>WARN</code>) was emitted first since the trace messages (severity <code>TRACE</code>) were simply archived. When the error message (severity <code>ERROR</code>) was logged, it triggered a dump of the complete message archive (in reverse order). </dd></dl>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Apr 1 2016 16:48:24 for BDE Release 3.0 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
